This file is a merged representation of the entire codebase, combined into a single document by Repomix.

<file_summary>
This section contains a summary of this file.

<purpose>
This file contains a packed representation of the entire repository's contents.
It is designed to be easily consumable by AI systems for analysis, code review,
or other automated processes.
</purpose>

<file_format>
The content is organized as follows:
1. This summary section
2. Repository information
3. Directory structure
4. Repository files (if enabled)
5. Multiple file entries, each consisting of:
  - File path as an attribute
  - Full contents of the file
</file_format>

<usage_guidelines>
- This file should be treated as read-only. Any changes should be made to the
  original repository files, not this packed version.
- When processing this file, use the file path to distinguish
  between different files in the repository.
- Be aware that this file may contain sensitive information. Handle it with
  the same level of security as you would the original repository.
</usage_guidelines>

<notes>
- Some files may have been excluded based on .gitignore rules and Repomix's configuration
- Binary files are not included in this packed representation. Please refer to the Repository Structure section for a complete list of file paths, including binary files
- Files matching patterns in .gitignore are excluded
- Files matching default ignore patterns are excluded
- Files are sorted by Git change count (files with more changes are at the bottom)
</notes>

</file_summary>

<directory_structure>
.github/
  workflows/
    dependency-review.yml
    main.yml
  dependabot.yml
.husky/
  commit-msg
  pre-commit
  pre-push
docs/
  constants/
    pitch-deck-status.md
  utils/
    retry-utility.md
  api-docs.md
  code-standards.md
  codebase-summary.md
  project-overview-pdr.md
  system-architecture.md
public/
  images/
    .gitkeep
  svgs/
    .gitkeep
  favicon.ico
  vercel.svg
src/
  app/
    auth/
      login/
        page.tsx
    dashboard/
      pitch-deck/
        page.tsx
      pitch-decks/
        [uuid]/
          page.tsx
        upload/
          page.tsx
        page.tsx
      page.tsx
    layout.tsx
    page.tsx
  components/
    auth/
      auth-guard.tsx
      index.ts
    common/
      button.tsx
    layout/
      header.tsx
    pitch-deck/
      analysis-result.tsx
      category-card.tsx
      category-expansion.tsx
      category-grid.tsx
      category-scores.tsx
      competitive-analysis.tsx
      differentiator-list.tsx
      file-preview-card.tsx
      file-uploader.tsx
      gauge-chart.tsx
      improvement-card.tsx
      improvement-list.tsx
      index.ts
      market-opportunity.tsx
      positioning-map.tsx
      recommendation-card.tsx
      score-card.tsx
      stage-indicator.tsx
      strength-card.tsx
      strength-list.tsx
      upload-progress.tsx
    pitch-deck-management/
      delete-confirmation-dialog.tsx
      index.ts
      metadata-inputs.tsx
      pitch-deck-actions.tsx
      pitch-deck-card.tsx
      pitch-deck-detail-header.tsx
      pitch-deck-filter.tsx
      pitch-deck-info.tsx
      pitch-deck-list.tsx
      pitch-deck-pagination.tsx
      upload-form.tsx
      upload-progress-tracker.tsx
    ui/
      animated/
        fade-in.tsx
        index.ts
        scale-in.tsx
        slide-up.tsx
        stagger-children.tsx
      button.tsx
      dialog.tsx
      input.tsx
      select.tsx
      sonner.tsx
  config/
    env.ts
    fonts.ts
    site.ts
  constants/
    animation.ts
    api.ts
    defaults.ts
    file-types.ts
    image.ts
    index.ts
    indicators.ts
    pitch-deck-status.ts
    routes.ts
    score-bands.ts
    vc-framework.ts
  hooks/
    .gitkeep
    index.ts
    use-reduced-motion.ts
  lib/
    .gitkeep
  providers/
    auth-provider.tsx
    index.ts
    theme-provider.tsx
  services/
    api/
      auth.service.ts
      index.ts
      pitch-deck-management.service.ts
      pitch-deck.service.ts
    http/
      client.ts
      index.ts
    index.ts
  stores/
    index.ts
    pitch-deck-management.store.ts
    pitch-deck.store.ts
    user.store.ts
  styles/
    globals.css
  types/
    request/
      auth.ts
      index.ts
      pitch-deck.ts
    response/
      common.ts
      index.ts
      pitch-deck.ts
    index.ts
    user.ts
  utils/
    cn/
      cn.ts
      index.ts
    index.ts
    mock-analysis.ts
    retry.ts
    score-calculator.ts
.env.example
.gitignore
.prettierignore
.prettierrc
components.json
eslint.config.mjs
jest.config.js
jest.setup.js
next-env.d.ts
next.config.mjs
package.json
postcss.config.js
prettier.config.js
README.md
researcher-260203-pitch-deck-scoring.md
tailwind.config.js
tsconfig.json
</directory_structure>

<files>
This section contains the contents of the repository's files.

<file path="docs/constants/pitch-deck-status.md">
# Pitch Deck Status Constants

## Overview

The pitch deck status system (`src/constants/pitch-deck-status.ts`) provides a standardized way to track and display the lifecycle of uploaded pitch deck files. This system ensures consistency across the application and provides clear visual feedback to users.

## Status Values

The system uses four primary status values:

```typescript
export type PitchDeckStatus = 'uploading' | 'processing' | 'ready' | 'error';
```

### Status Descriptions

| Status       | Description                                      | Typical Duration       | User Action Required             |
| ------------ | ------------------------------------------------ | ---------------------- | -------------------------------- |
| `uploading`  | File is being uploaded to the server             | 1-60 seconds           | Wait for upload to complete      |
| `processing` | File is being analyzed by the VC framework       | 30 seconds - 5 minutes | Wait for analysis to complete    |
| `ready`      | File has been successfully uploaded and analyzed | Ongoing                | View results, download, or share |
| `error`      | Upload or processing failed                      | Ongoing                | Retry upload or contact support  |

## Status Configuration

### Color Scheme

Each status has an associated color scheme for consistent UI representation:

```typescript
export const PITCH_DECK_STATUS: Record<PitchDeckStatus, { label: string; color: string }> = {
  uploading: {
    label: 'Uploading',
    color: 'bg-blue-100 text-blue-700 dark:bg-blue-900 dark:text-blue-300'
  },
  processing: {
    label: 'Processing',
    color: 'bg-yellow-100 text-yellow-700 dark:bg-yellow-900 dark:text-yellow-300'
  },
  ready: {
    label: 'Ready',
    color: 'bg-green-100 text-green-700 dark:bg-green-900 dark:text-green-300'
  },
  error: {
    label: 'Error',
    color: 'bg-red-100 text-red-700 dark:bg-red-900 dark:text-red-300'
  }
};
```

### Visual Indicators

#### Status Badge

```tsx
import { getStatusColor, getStatusLabel } from '@/constants/pitch-deck-status';

function StatusBadge({ status }: { status: PitchDeckStatus }) {
  const colorClass = getStatusColor(status);
  const label = getStatusLabel(status);

  return (
    <span className={`${colorClass} px-2 py-1 rounded-full text-sm font-medium`}>{label}</span>
  );
}
```

#### Progress Ring

```tsx
import { PitchDeckStatus } from '@/constants/pitch-deck-status';

function StatusProgress({ status }: { status: PitchDeckStatus }) {
  const progress = {
    uploading: 50,
    processing: 75,
    ready: 100,
    error: 0
  }[status];

  return (
    <div className="relative w-16 h-16">
      <svg className="w-full h-full transform -rotate-90">
        <circle cx="32" cy="32" r="28" stroke="#e5e7eb" strokeWidth="4" fill="none" />
        <circle
          cx="32"
          cy="32"
          r="28"
          stroke="currentColor"
          strokeWidth="4"
          fill="none"
          strokeDasharray={2 * Math.PI * 28}
          strokeDashoffset={2 * Math.PI * 28 * (1 - progress / 100)}
          className={`
            ${status === 'uploading' ? 'text-blue-500' : ''}
            ${status === 'processing' ? 'text-yellow-500' : ''}
            ${status === 'ready' ? 'text-green-500' : ''}
            ${status === 'error' ? 'text-red-500' : ''}
          `}
        />
      </svg>
      <div className="absolute inset-0 flex items-center justify-center">
        <span className="text-sm font-medium">{progress}%</span>
      </div>
    </div>
  );
}
```

## Utility Functions

### `getStatusLabel`

```typescript
export const getStatusLabel = (status: PitchDeckStatus): string;
```

Returns the human-readable label for a status.

**Usage:**

```typescript
import { getStatusLabel } from '@/constants/pitch-deck-status';

const status = 'processing';
const label = getStatusLabel(status); // 'Processing'
```

### `getStatusColor`

```typescript
export const getStatusColor = (status: PitchDeckStatus): string;
```

Returns the Tailwind CSS color classes for a status.

**Usage:**

```typescript
import { getStatusColor } from '@/constants/pitch-deck-status';

const status = 'ready';
const colorClass = getStatusColor(status);
// 'bg-green-100 text-green-700 dark:bg-green-900 dark:text-green-300'
```

## UI Component Usage

### Status List Item

```tsx
import { PitchDeckListItem } from '@/types/response/pitch-deck';
import { StatusBadge } from '@/components/common/status-badge';

function PitchDeckItem({ deck }: { deck: PitchDeckListItem }) {
  return (
    <div className="p-4 border rounded-lg hover:bg-gray-50">
      <div className="flex items-center justify-between">
        <div>
          <h3 className="font-medium">{deck.title}</h3>
          <p className="text-sm text-gray-500">{deck.originalFileName}</p>
          <div className="flex items-center gap-2 mt-1">
            <StatusBadge status={deck.status} />
            <span className="text-sm text-gray-500">{deck.fileSize} bytes</span>
          </div>
        </div>
        <div className="text-right">
          <p className="text-sm text-gray-500">{new Date(deck.createdAt).toLocaleDateString()}</p>
          {deck.status === 'ready' && (
            <button className="mt-2 text-sm text-blue-600 hover:text-blue-800">
              View Analysis
            </button>
          )}
        </div>
      </div>
    </div>
  );
}
```

### Upload Progress

```tsx
import { PitchDeckStatus } from '@/constants/pitch-deck-status';

function UploadProgress({ status, progress }: { status: PitchDeckStatus; progress: number }) {
  return (
    <div className="p-6">
      <div className="flex items-center gap-4">
        <StatusProgress status={status} />
        <div className="flex-1">
          <h3 className="font-medium mb-1">{getStatusLabel(status)}</h3>
          <div className="w-full bg-gray-200 rounded-full h-2">
            <div
              className={`h-2 rounded-full ${status === 'error' ? 'bg-red-500' : 'bg-blue-500'}`}
              style={{ width: `${progress}%` }}
            />
          </div>
          <p className="text-sm text-gray-500 mt-1">
            {status === 'uploading' && 'Uploading your pitch deck...'}
            {status === 'processing' && 'Analyzing your pitch deck...'}
            {status === 'ready' && 'Analysis complete!'}
            {status === 'error' && 'Upload failed. Please try again.'}
          </p>
        </div>
      </div>
    </div>
  );
}
```

## State Management Integration

### Zustand Store Example

```tsx
import { create } from 'zustand';
import { PitchDeckStatus, getStatusLabel } from '@/constants/pitch-deck-status';

interface PitchDeckState {
  uploadStatus: PitchDeckStatus | null;
  uploadProgress: number;
  error: string | null;

  setUploadStatus: (status: PitchDeckStatus) => void;
  setUploadProgress: (progress: number) => void;
  setError: (error: string | null) => void;

  getStatusMessage: () => string;
}

export const usePitchDeckStore = create<PitchDeckState>((set, get) => ({
  uploadStatus: null,
  uploadProgress: 0,
  error: null,

  setUploadStatus: (status) => set({ uploadStatus: status }),
  setUploadProgress: (progress) => set({ uploadProgress: progress }),
  setError: (error) => set({ error }),

  getStatusMessage: () => {
    const { uploadStatus, error } = get();

    if (error) return `Error: ${error}`;
    if (!uploadStatus) return 'Ready to upload';

    const label = getStatusLabel(uploadStatus);
    return `${label}...`;
  }
}));
```

## API Integration

### Response Mapping

```typescript
// When receiving API response
const apiResponse: PitchDeckListItem = {
  id: '123',
  uuid: 'abc-def-ghi',
  title: 'Q3 2024 Investor Deck',
  description: 'Quarterly update for investors',
  originalFileName: 'q3-2024-investor-deck.pdf',
  mimeType: 'application/pdf',
  fileSize: 2048000,
  status: 'processing', // Maps directly to PitchDeckStatus
  chunkCount: 42,
  errorMessage: null,
  tags: ['q3', '2024', 'investor'],
  createdAt: '2026-02-03T12:00:00Z',
  updatedAt: '2026-02-03T12:00:00Z',
  lastAccessedAt: '2026-02-03T12:00:00Z'
};

// Display using status utilities
const statusColor = getStatusColor(apiResponse.status);
const statusLabel = getStatusLabel(apiResponse.status);
```

## Error Handling

### Error Status Display

```tsx
import { getStatusColor, getStatusLabel } from '@/constants/pitch-deck-status';

function ErrorState({ error, onRetry }: { error: string; onRetry: () => void }) {
  const status: PitchDeckStatus = 'error';

  return (
    <div className="p-6 text-center">
      <div className={`inline-flex items-center px-4 py-2 rounded-full ${getStatusColor(status)}`}>
        {getStatusLabel(status)}
      </div>
      <p className="mt-2 text-gray-600">{error}</p>
      <button
        onClick={onRetry}
        className="mt-4 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700"
      >
        Try Again
      </button>
    </div>
  );
}
```

## Testing

### Unit Tests for Status Utilities

```typescript
// __tests__/constants/pitch-deck-status.test.ts
import {
  PitchDeckStatus,
  PITCH_DECK_STATUS,
  getStatusLabel,
  getStatusColor
} from '@/constants/pitch-deck-status';

describe('PitchDeckStatus Constants', () => {
  test('should have all required status values', () => {
    expect(PITCH_DECK_STATUS).toEqual({
      uploading: expect.objectContaining({
        label: 'Uploading',
        color: expect.any(String)
      }),
      processing: expect.objectContaining({
        label: 'Processing',
        color: expect.any(String)
      }),
      ready: expect.objectContaining({
        label: 'Ready',
        color: expect.any(String)
      }),
      error: expect.objectContaining({
        label: 'Error',
        color: expect.any(String)
      })
    });
  });

  test('getStatusLabel should return correct label', () => {
    expect(getStatusLabel('uploading')).toBe('Uploading');
    expect(getStatusLabel('processing')).toBe('Processing');
    expect(getStatusLabel('ready')).toBe('Ready');
    expect(getStatusLabel('error')).toBe('Error');
  });

  test('getStatusColor should return color classes', () => {
    const uploadColor = getStatusColor('uploading');
    expect(uploadColor).toContain('bg-blue-100');
    expect(uploadColor).toContain('text-blue-700');

    const readyColor = getStatusColor('ready');
    expect(readyColor).toContain('bg-green-100');
    expect(readyColor).toContain('text-green-700');
  });
});
```

### Component Tests

```typescript
// __tests__/components/status-badge.test.tsx
import { render, screen } from '@testing-library/react';
import { StatusBadge } from '@/components/common/status-badge';
import { PitchDeckStatus } from '@/constants/pitch-deck-status';

describe('StatusBadge', () => {
  test('displays correct label for uploading status', () => {
    render(<StatusBadge status="uploading" />);
    expect(screen.getByText('Uploading')).toBeInTheDocument();
  });

  test('has correct color classes for uploading', () => {
    const { container } = render(<StatusBadge status="uploading" />);
    expect(container.firstChild).toHaveClass('bg-blue-100');
    expect(container.firstChild).toHaveClass('text-blue-700');
  });

  test('displays error status correctly', () => {
    render(<StatusBadge status="error" />);
    expect(screen.getByText('Error')).toBeInTheDocument();
    expect(container.firstChild).toHaveClass('bg-red-100');
    expect(container.firstChild).toHaveClass('text-red-700');
  });
});
```

## Internationalization Considerations

### Status Labels for i18n

```typescript
// i18n/en.ts
export const en = {
  pitchDeck: {
    status: {
      uploading: 'Uploading',
      processing: 'Processing',
      ready: 'Ready',
      error: 'Error'
    }
  }
};

// i18n/vi.ts
export const vi = {
  pitchDeck: {
    status: {
      uploading: 'Đang tải lên',
      processing: 'Đang xử lý',
      ready: 'Sẵn sàng',
      error: 'Lỗi'
    }
  }
};
```

### Usage with i18n

```tsx
import { useTranslation } from 'next-i18next';
import { PitchDeckStatus } from '@/constants/pitch-deck-status';

function StatusBadge({ status }: { status: PitchDeckStatus }) {
  const { t } = useTranslation();

  const label = t(`pitchDeck.status.${status}`, {
    defaultValue: PITCH_DECK_STATUS[status].label
  });

  const colorClass = PITCH_DECK_STATUS[status].color;

  return (
    <span className={`${colorClass} px-2 py-1 rounded-full text-sm font-medium`}>{label}</span>
  );
}
```

## Best Practices

1. **Consistent Usage**: Always use the status constants and utilities instead of hardcoding values
2. **Visual Hierarchy**: Use color and size to indicate importance of status
3. **Accessibility**: Ensure color contrast meets WCAG guidelines
4. **State Persistence**: Store status in state management for real-time updates
5. **Error Recovery**: Provide clear pathways for users to recover from error states

---

_Last Updated: 2026-02-03_
_Version: 1.0.0_
</file>

<file path="docs/utils/retry-utility.md">
# Retry Utility Documentation

## Overview

The retry utility (`src/utils/retry.ts`) provides a robust mechanism for handling transient failures in API calls using exponential backoff with jitter. This ensures reliable operations during network interruptions, server overload, or temporary service unavailability.

## Core Features

### Exponential Backoff

- Delay increases exponentially with each retry attempt
- Formula: `baseDelay * 2^attempt`
- Prevents immediate retry storms that could overwhelm the server

### Jitter

- Random delay (0-1000ms) added to each retry
- Prevents synchronized retry attempts from multiple clients
- Reduces the risk of cascading failures

### Configurable Parameters

- `maxRetries`: Maximum number of retry attempts (default: 3)
- `baseDelay`: Initial delay in milliseconds (default: 1000ms)
- `maxDelay`: Maximum delay cap in milliseconds (default: 30000ms)

## Usage Examples

### Basic Usage

```typescript
import { withRetry } from '@/utils/retry';

// Simple retry for an API call
try {
  const result = await withRetry(async () => {
    return await apiService.uploadPitchDeck(file);
  });

  console.log('Upload successful:', result);
} catch (error) {
  console.error('Upload failed after all retries:', error);
}
```

### Custom Retry Configuration

```typescript
import { withRetry, type RetryOptions } from '@/utils/retry';

const retryOptions: RetryOptions = {
  maxRetries: 5, // Retry up to 5 times
  baseDelay: 2000, // Start with 2 second delay
  maxDelay: 60000 // Cap at 60 seconds
};

try {
  const analysis = await withRetry(() => apiService.analyzePitchDeck({ uploadId }), retryOptions);

  console.log('Analysis completed:', analysis);
} catch (error) {
  console.error('Analysis failed after retries:', error);
}
```

### Service Layer Integration

```typescript
// src/services/api/pitch-deck.service.ts
import { withRetry } from '@/utils/retry';

export class PitchDeckService {
  async uploadPitchDeckWithRetry(
    request: UploadPitchDeckWithMetadataRequest,
    options?: RetryOptions
  ): Promise<UploadPitchDeckResponse> {
    return withRetry(() => this.uploadPitchDeck(request), options);
  }

  async analyzePitchDeckWithRetry(
    request: AnalyzePitchDeckRequest,
    options?: RetryOptions
  ): Promise<PitchDeckAnalysisResponse> {
    return withRetry(() => this.analyzePitchDeck(request), options);
  }
}
```

## Retry Strategy Guidelines

### When to Use Retry

1. **File Uploads**

   - Network interruptions during large file uploads
   - Temporary server timeouts during processing

2. **Analysis Requests**

   - Server busy scenarios (503 Service Unavailable)
   - Temporary processing queue delays

3. **API Calls**
   - Network timeouts (504 Gateway Timeout)
   - Temporary server overload (502 Bad Gateway)

### When NOT to Use Retry

1. **Client-Side Errors**

   ```typescript
   // Don't retry validation errors
   if (error.response?.status === 400) {
     throw new Error('Invalid request parameters');
   }
   ```

2. **Authentication Issues**

   ```typescript
   // Don't retry auth failures
   if (error.response?.status === 401) {
     throw new Error('Authentication required');
   }
   ```

3. **Permission Denied**

   ```typescript
   // Don't retry permission errors
   if (error.response?.status === 403) {
     throw new Error('Access denied');
   }
   ```

4. **Resource Not Found**
   ```typescript
   // Don't retry for 404 errors
   if (error.response?.status === 404) {
     throw new Error('Resource not found');
   }
   ```

## Error Handling Patterns

### Basic Error Handling

```typescript
try {
  const result = await withRetry(() => apiService.call());
  return result;
} catch (error) {
  // Handle final failure after all retries
  console.error('Operation failed:', error);
  throw error; // Re-throw for UI to handle
}
```

### Type-Specific Error Handling

```typescript
async function uploadWithRetry(file: File) {
  try {
    const result = await withRetry(() => pitchDeckService.uploadPitchDeck({ file }), {
      maxRetries: 3
    });

    return result;
  } catch (error) {
    if (error.response?.status === 413) {
      throw new Error('File size exceeds limit');
    }

    if (error.response?.status === 415) {
      throw new Error('Unsupported file format');
    }

    throw new Error('Upload failed. Please try again.');
  }
}
```

### User Feedback During Retries

```typescript
let retryCount = 0;

async function uploadWithProgress(file: File) {
  try {
    const result = await withRetry(() => pitchDeckService.uploadPitchDeck({ file }), {
      maxRetries: 5,
      onRetry: (error, attempt) => {
        retryCount = attempt;
        console.log(`Retry attempt ${attempt}: ${error.message}`);
        // Update UI to show retry status
      }
    });

    return result;
  } catch (error) {
    // Show final error message to user
    throw new Error(`Upload failed after ${retryCount} retries: ${error.message}`);
  }
}
```

## Configuration Options

### Default Configuration

```typescript
const DEFAULT_RETRY_OPTIONS: Required<RetryOptions> = {
  maxRetries: 3,
  baseDelay: 1000,
  maxDelay: 30000
};
```

### Operation-Specific Configurations

```typescript
// Conservative retry for critical operations
const criticalOperationRetry = {
  maxRetries: 3,
  baseDelay: 1000,
  maxDelay: 10000
};

// Aggressive retry for non-critical operations
const nonCriticalRetry = {
  maxRetries: 5,
  baseDelay: 500,
  maxDelay: 30000
};

// Long-polling retry for analysis
const analysisRetry = {
  maxRetries: 10,
  baseDelay: 2000,
  maxDelay: 120000 // 2 minutes max
};
```

## Testing

### Unit Tests

```typescript
// __tests__/utils/retry.test.ts
import { withRetry } from '@/utils/retry';

describe('withRetry', () => {
  it('should succeed on first attempt', async () => {
    const mockFn = vi.fn().mockResolvedValue('success');
    const result = await withRetry(mockFn);

    expect(result).toBe('success');
    expect(mockFn).toHaveBeenCalledTimes(1);
  });

  it('should retry on failure and succeed', async () => {
    const mockFn = vi.fn().mockRejectedValueOnce(new Error('fail')).mockResolvedValue('success');

    const result = await withRetry(mockFn, { maxRetries: 2 });

    expect(result).toBe('success');
    expect(mockFn).toHaveBeenCalledTimes(2);
  });

  it('should fail after max retries', async () => {
    const mockFn = vi.fn().mockRejectedValue(new Error('fail'));

    await expect(withRetry(mockFn, { maxRetries: 2 })).rejects.toThrow('fail');

    expect(mockFn).toHaveBeenCalledTimes(3); // 1 initial + 2 retries
  });

  it('should respect delay timing', async () => {
    const mockFn = vi.fn().mockRejectedValue(new Error('fail'));
    const startTime = Date.now();

    await expect(
      withRetry(mockFn, {
        maxRetries: 1,
        baseDelay: 1000
      })
    ).rejects.toThrow('fail');

    const endTime = Date.now();
    const duration = endTime - startTime;

    // Should be at least 1000ms delay
    expect(duration).toBeGreaterThanOrEqual(1000);
  });
});
```

### Integration Tests

```typescript
// __tests__/services/pitch-deck.service.test.ts
import { PitchDeckService } from '@/services/api';
import { withRetry } from '@/utils/retry';

describe('PitchDeckService with Retry', () => {
  let service: PitchDeckService;

  beforeEach(() => {
    service = new PitchDeckService();
  });

  it('should use retry for upload', async () => {
    const mockFile = new File(['test'], 'test.pdf');
    const mockUpload = vi.spyOn(service, 'uploadPitchDeck');

    // Simulate network failure then success
    mockUpload.mockRejectedValueOnce(new Error('Network error')).mockResolvedValueOnce({
      uploadId: '123',
      filename: 'test.pdf',
      fileSize: 1024,
      fileType: 'application/pdf',
      uploadedAt: '2026-02-03T12:00:00Z'
    });

    const result = await service.uploadPitchDeckWithRetry({ file: mockFile });

    expect(result.uploadId).toBe('123');
    expect(mockUpload).toHaveBeenCalledTimes(2);
  });
});
```

## Performance Considerations

1. **Retry Count**: Balance between reliability and performance

   - Too few: Misses recovery opportunities
   - Too many: Wastes resources and delays user feedback

2. **Delay Timing**: Respect server backpressure

   - Start with conservative delays
   - Cap maximum delays to prevent excessive waiting

3. **Cancel Support**: Consider adding cancellation for long retries

   ```typescript
   export const withRetry = async <T>(
     fn: () => Promise<T>,
     options: RetryOptions = {}
   ): Promise<T> => {
     const controller = new AbortController();

     // Set up timeout or cancellation logic
     const timeout = setTimeout(() => controller.abort(), 300000);

     try {
       // Retry logic with controller check
     } finally {
       clearTimeout(timeout);
     }
   };
   ```

## Migration from Manual Retry

### Before (Manual Retry)

```typescript
async function manualRetry(fn: () => Promise<any>, maxRetries = 3) {
  for (let i = 0; i <= maxRetries; i++) {
    try {
      return await fn();
    } catch (error) {
      if (i === maxRetries) throw error;
      await new Promise((resolve) => setTimeout(resolve, 1000 * Math.pow(2, i)));
    }
  }
}
```

### After (Using Utility)

```typescript
import { withRetry } from '@/utils/retry';

async function betterRetry(fn: () => Promise<any>) {
  return withRetry(fn, {
    maxRetries: 3,
    baseDelay: 1000,
    maxDelay: 30000
  });
}
```

## Best Practices

1. **Document Retry Strategy**: Clearly document which operations use retry and why
2. **Monitor Retry Events**: Log retry attempts for debugging and optimization
3. **User Communication**: Inform users when operations are retrying
4. **Circuit Breaking**: Consider circuit breakers for repeated failures
5. **Rate Limiting**: Respect API rate limits during retry attempts

---

_Last Updated: 2026-02-03_
_Version: 1.0.0_
</file>

<file path="docs/api-docs.md">
# API Documentation

## Pitch Deck Management API

### Overview

This document provides comprehensive API documentation for the Pitch Deck Management system, including request/response types, status constants, and utility functions.

### Base API URL

```typescript
// Base URL configured in src/services/http/client.ts
const API_BASE_URL = process.env.NEXT_PUBLIC_API_BASE_URL;
```

### Authentication

All API endpoints require JWT authentication. The HTTP client automatically attaches the Bearer token to requests:

```typescript
// Authorization header automatically added
Authorization: Bearer <jwt-token>
```

---

## 1. Pitch Deck Status Constants

### Status Values

The pitch deck system uses four main status values to track the lifecycle of uploaded files:

```typescript
export type PitchDeckStatus = 'uploading' | 'processing' | 'ready' | 'error';
```

### Status Configuration

```typescript
export const PITCH_DECK_STATUS: Record<PitchDeckStatus, { label: string; color: string }> = {
  uploading: {
    label: 'Uploading',
    color: 'bg-blue-100 text-blue-700 dark:bg-blue-900 dark:text-blue-300'
  },
  processing: {
    label: 'Processing',
    color: 'bg-yellow-100 text-yellow-700 dark:bg-yellow-900 dark:text-yellow-300'
  },
  ready: {
    label: 'Ready',
    color: 'bg-green-100 text-green-700 dark:bg-green-900 dark:text-green-300'
  },
  error: {
    label: 'Error',
    color: 'bg-red-100 text-red-700 dark:bg-red-900 dark:text-red-300'
  }
};
```

### Utility Functions

```typescript
// Get human-readable label for status
export const getStatusLabel = (status: PitchDeckStatus): string => PITCH_DECK_STATUS[status].label;

// Get Tailwind CSS color classes for status
export const getStatusColor = (status: PitchDeckStatus): string => PITCH_DECK_STATUS[status].color;
```

**Usage:**

```typescript
import { getStatusLabel, getStatusColor } from '@/constants/pitch-deck-status';

const status = 'processing';
const label = getStatusLabel(status); // 'Processing'
const colorClass = getStatusColor(status); // 'bg-yellow-100 text-yellow-700...'
```

---

## 2. API Request Types

### Upload Pitch Deck

#### Basic Upload

```typescript
export type UploadPitchDeckRequest = {
  file: File;
};
```

#### Upload with Metadata

```typescript
export type UploadPitchDeckWithMetadataRequest = {
  deck: File;
  title: string;
  description?: string;
  tags?: string[];
};
```

### Analyze Pitch Deck

```typescript
export type AnalyzePitchDeckRequest = {
  uploadId: string;
};
```

### List Pitch Decks

```typescript
export type ListPitchDecksQuery = {
  status?: 'uploading' | 'processing' | 'ready' | 'error';
  limit?: number;
  offset?: number;
};
```

---

## 3. API Response Types

### Upload Response

```typescript
export type UploadPitchDeckResponse = {
  uploadId: string;
  filename: string;
  fileSize: number;
  fileType: string;
  uploadedAt: string;
};
```

### Pitch Deck List Item

```typescript
export type PitchDeckListItem = {
  id: string;
  uuid: string;
  title: string;
  description: string | null;
  originalFileName: string;
  mimeType: string;
  fileSize: number;
  status: PitchDeckStatus;
  chunkCount: number;
  errorMessage: string | null;
  tags: string[] | null;
  createdAt: string;
  updatedAt: string;
  lastAccessedAt: string;
};
```

### List Pitch Decks Response

```typescript
export type ListPitchDecksResponse = PitchDeckListItem[];
```

### Pitch Deck Detail Response

```typescript
export type PitchDeckDetailResponse = PitchDeckListItem;
```

### Pitch Deck Analysis Response

#### VC Framework Types

```typescript
export type VCCategory =
  | 'teamAndFounders'
  | 'marketSize'
  | 'productSolution'
  | 'traction'
  | 'businessModel'
  | 'competition'
  | 'financials';

export type VCCategoryScore = {
  [K in VCCategory]: {
    score: number;
    weight: number;
    details?: string;
  };
};

export type StrengthItem = {
  id: string;
  title: string;
  description: string;
  evidence: EvidenceQuote[];
  impact: 'high' | 'medium' | 'low';
  category: VCCategory;
};

export type ImprovementItem = {
  id: string;
  title: string;
  description: string;
  recommendation: string;
  severity: 'high' | 'medium' | 'low';
  priority: number;
  category: VCCategory;
};

export type CompetitiveAnalysis = {
  positioning: CompetitivePosition[];
  differentiators: Differentiator[];
  marketOpportunity: {
    size: string;
    growth: string;
    trend: 'rising' | 'stable' | 'declining';
  };
};

export type PitchDeckAnalysisResponse = {
  uploadId: string;
  filename: string;
  overallScore: number;
  categoryScores: VCCategoryScore;
  strengths: StrengthItem[];
  improvements: ImprovementItem[];
  competitiveAnalysis?: CompetitiveAnalysis;
  analyzedAt: string;
};
```

---

## 4. Retry Utility

The retry utility provides exponential backoff with jitter to handle transient API failures.

### Retry Options

```typescript
export type RetryOptions = {
  maxRetries?: number;
  baseDelay?: number;
  maxDelay?: number;
};
```

### Default Configuration

```typescript
const DEFAULT_RETRY_OPTIONS: Required<RetryOptions> = {
  maxRetries: 3,
  baseDelay: 1000,
  maxDelay: 30000
};
```

### Usage

```typescript
import { withRetry } from '@/utils/retry';

// Basic usage
try {
  const result = await withRetry(async () => {
    return await apiService.uploadPitchDeck(file);
  });

  console.log('Upload successful:', result);
} catch (error) {
  console.error('Upload failed after retries:', error);
}

// Custom retry options
try {
  const result = await withRetry(() => apiService.analyzePitchDeck(uploadId), {
    maxRetries: 5,
    baseDelay: 2000,
    maxDelay: 60000
  });

  console.log('Analysis completed:', result);
} catch (error) {
  console.error('Analysis failed after retries:', error);
}
```

### Retry Logic

1. **Exponential Backoff**: Delay increases exponentially with each retry

   - Formula: `baseDelay * 2^attempt`

2. **Jitter**: Random delay (0-1000ms) added to prevent retry storms

   - Prevents multiple clients from retrying simultaneously

3. **Max Delay**: Capped at 30 seconds (configurable)

   - Prevents excessively long delays

4. **Error Handling**: Retries on all errors except the final attempt

### When to Use Retry

- **File uploads**: Handle network interruptions during large file uploads
- **Analysis requests**: Retry during processing when server is busy
- **API calls**: Handle temporary server or network issues
- **Long-running operations**: Retry operations that might timeout

### When NOT to Use Retry

- **Client-side validation errors**
- **Authentication failures (401)**
- **Permission errors (403)**
- **Invalid request errors (400)**
- **Resource not found (404)**

---

## 5. API Service Integration

### Service Layer Structure

```typescript
// src/services/api/pitch-deck.service.ts
export class PitchDeckService {
  async uploadPitchDeck(request: UploadPitchDeckRequest): Promise<UploadPitchDeckResponse>;
  async uploadPitchDeckWithMetadata(
    request: UploadPitchDeckWithMetadataRequest
  ): Promise<UploadPitchDeckResponse>;
  async analyzePitchDeck(request: AnalyzePitchDeckRequest): Promise<PitchDeckAnalysisResponse>;
  async listPitchDecks(query?: ListPitchDecksQuery): Promise<ListPitchDecksResponse>;
  async getPitchDeckDetail(id: string): Promise<PitchDeckDetailResponse>;
}
```

### Example Usage

```typescript
import { PitchDeckService } from '@/services/api';
import { withRetry } from '@/utils/retry';

const pitchDeckService = new PitchDeckService();

// Upload with retry
const uploadResult = await withRetry(() =>
  pitchDeckService.uploadPitchDeckWithMetadata({
    deck: file,
    title: 'My Pitch Deck',
    description: 'Annual presentation for investors',
    tags: ['annual', 'investor', '2024']
  })
);

// List pitch decks
const pitchDecks = await pitchDeckService.listPitchDecks({
  status: 'ready',
  limit: 10,
  offset: 0
});

// Analyze pitch deck
const analysis = await withRetry(() =>
  pitchDeckService.analyzePitchDeck({ uploadId: uploadResult.uploadId })
);
```

---

## 6. Error Handling

### Common Error Scenarios

1. **Upload Errors**

   - `413 Payload Too Large`: File exceeds size limit
   - `415 Unsupported Media Type`: Invalid file format
   - `Network Error`: Connection interrupted during upload

2. **Analysis Errors**

   - `409 Conflict`: File already being analyzed
   - `422 Unprocessable Entity`: Invalid file format for analysis
   - `503 Service Unavailable`: Analysis service busy

3. **Retriable Errors**
   - `502 Bad Gateway`
   - `503 Service Unavailable`
   - `504 Gateway Timeout`
   - `ECONNRESET` (Network error)

### Error Recovery Patterns

```typescript
// Upload with error handling and retry
try {
  const result = await withRetry(() => pitchDeckService.uploadPitchDeck(file), { maxRetries: 5 });
  return result;
} catch (error) {
  if (error.response?.status === 413) {
    throw new Error('File size exceeds limit');
  }
  if (error.response?.status === 415) {
    throw new Error('Unsupported file format');
  }
  throw new Error('Upload failed. Please try again.');
}
```

---

## 7. Best Practices

### 1. File Uploads

- Use `UploadPitchDeckWithMetadataRequest` for better organization
- Implement progress tracking for large files
- Validate file size and type before upload

### 2. Retry Strategy

- Use retry for transient failures only
- Set appropriate retry counts based on operation type
- Implement user feedback during retries

### 3. Status Handling

- Display status-appropriate UI (loading, error states)
- Use `getStatusLabel` and `getStatusColor` for consistent UI
- Handle error states gracefully with retry options

### 4. Performance

- Limit pagination results with `limit` parameter
- Use offset for pagination
- Cache frequently accessed pitch deck lists

---

## 8. Testing

### Unit Tests

```typescript
// Test retry utility
describe('withRetry', () => {
  it('should succeed on first attempt', async () => {
    const mockFn = vi.fn().mockResolvedValue('success');
    const result = await withRetry(mockFn);
    expect(result).toBe('success');
    expect(mockFn).toHaveBeenCalledTimes(1);
  });

  it('should retry on failure', async () => {
    const mockFn = vi.fn().mockRejectedValueOnce(new Error('fail')).mockResolvedValue('success');

    const result = await withRetry(mockFn, { maxRetries: 2 });
    expect(result).toBe('success');
    expect(mockFn).toHaveBeenCalledTimes(2);
  });
});
```

### Integration Tests

```typescript
// Test API service with mock server
describe('PitchDeckService', () => {
  it('should upload pitch deck', async () => {
    const service = new PitchDeckService();
    const mockFile = new File(['test'], 'test.pdf', { type: 'application/pdf' });

    const result = await service.uploadPitchDeck({ file: mockFile });

    expect(result).toHaveProperty('uploadId');
    expect(result).toHaveProperty('filename');
  });
});
```

---

## 9. Migration Guide

### Legacy Types

The legacy 4-category structure is deprecated but supported for transition:

```typescript
// Legacy types (deprecated)
export type CategoryScores = {
  narrative: number;
  design: number;
  business: number;
  market: number;
};
```

**Migration Path:**

1. Update UI to use new VC framework types
2. Replace `CategoryScores` with `VCCategoryScore`
3. Update analysis display to use `StrengthItem[]` and `ImprovementItem[]`
4. Add competitive analysis features when available

---

## 10. Version History

| Version | Date       | Changes                           |
| ------- | ---------- | --------------------------------- |
| 1.0.0   | 2026-02-03 | Initial API documentation         |
| 1.1.0   | 2026-02-03 | Added VC framework types          |
| 1.2.0   | 2026-02-03 | Added retry utility documentation |

---

_Last Updated: 2026-02-03_
_API Version: 1.2.0_
</file>

<file path="docs/code-standards.md">
# Code Standards

This document outlines the coding standards and best practices for the Next.js boilerplate project. These standards ensure code quality, consistency, and maintainability across the entire codebase.

## Table of Contents

1. [ESLint Configuration](#eslint-configuration)
2. [Prettier Formatting Standards](#prettier-formatting-standards)
3. [Import Organization Patterns](#import-organization-patterns)
4. [TypeScript Configuration](#typescript-configuration)
5. [Testing Standards](#testing-standards)
6. [Git Hooks (Husky, lint-staged)](#git-hooks-husky-lint-staged)
7. [General Coding Conventions](#general-coding-conventions)
8. [Component Patterns](#component-patterns)
9. [State Management Standards](#state-management-standards)
10. [API Layer Standards](#api-layer-standards)

---

## ESLint Configuration

### Core Setup

The project uses ESLint 9 with Next.js configuration:

```typescript
// eslint.config.mjs
export default [
  {
    ignores: [
      '**/node_modules/*',
      '**/out/*',
      '**/.next/*',
      '**/coverage',
      'src/styles/globals.css'
    ]
  },
  ...compat.extends(
    'next/core-web-vitals',
    'eslint:recommended',
    'plugin:react/recommended',
    'plugin:@typescript-eslint/recommended',
    'plugin:prettier/recommended',
    'plugin:storybook/recommended',
    'prettier'
  )
];
```

### Key ESLint Rules

#### TypeScript Rules

```typescript
// No unused variables (allow prefixing with _)
'@typescript-eslint/no-unused-vars': [
  2,
  {
    argsIgnorePattern: '^_'
  }
],

// Strict null checks enabled by default
'@typescript-eslint/no-explicit-any': 2,
'@typescript-eslint/explicit-function-return-type': 0,
'@typescript-eslint/explicit-module-boundary-types': 0,
```

#### React Rules

```typescript
// No prop types requirement (using TypeScript)
'react/prop-types': 0,

// No React import in scope (Next 13+ supports JSX without import)
'react/react-in-jsx-scope': 0,

// Require newline before return
'newline-before-return': 2,
```

#### Import Organization

```typescript
'import-helpers/order-imports': [
  2,
  {
    newlinesBetween: 'always',
    groups: [
      ['/^next/', 'module'],           // Next.js imports first
      '/^@/styles/',                  // Style imports
      '/^@/components/',              // Component imports
      ['parent', 'sibling', 'index']  // Relative imports last
    ],
    alphabetize: {
      order: 'asc',
      ignoreCase: true
    }
  }
],
```

#### Console Usage

```typescript
// Only allow warn and error
'no-console': [
  2,
  {
    allow: ['warn', 'error']
  }
]
```

---

## Prettier Formatting Standards

### Configuration

```json
{
  "semi": true,
  "trailingComma": "es5",
  "singleQuote": true,
  "printWidth": 100,
  "tabWidth": 2,
  "useTabs": false,
  "arrowParens": "avoid",
  "endOfLine": "lf"
}
```

### Key Formatting Rules

#### JavaScript/TSX

```typescript
// Use single quotes
const name = 'John';

// No trailing commas in single line objects
const obj = { name: 'John' };

// Always use semicolons
const x = 1;

// Arrow function parentheses when necessary
const func = (param) => param * 2;
const complexFunc = (a, b) => {
  return a + b;
};
```

#### JSX Formatting

```jsx
// Opening and closing tags on separate lines
<Component
  prop1={value1}
  prop2={value2}
>
  Content
</Component>

// Self-closing tags for void elements
<img src="path" />
<br />
```

---

## Import Organization Patterns

### Import Order

Imports must follow this exact order:

1. **Next.js imports**
2. **Third-party imports**
3. **Internal imports (styles first, then components, then utilities)**
4. **Relative imports**

### Example Pattern

```typescript
// 1. Next.js imports
import { Metadata } from 'next';
import Image from 'next/image';

// 2. Third-party imports
import { useStore } from 'zustand';
import axios from 'axios';
import { Button } from '@radix-ui/react-slot';

// 3. Internal imports
// Styles
import '@/styles/globals.css';

// Components
import { Header } from '@/components/layout/header';
import { UserCard } from '@/components/common/user-card';

// Utilities
import { cn } from '@/utils/cn';
import { formatDate } from '@/utils/date';

// 4. Relative imports
import { UserAvatar } from './user-avatar';
import { UserList } from './user-list';
```

### Import Naming

- Use named imports for specificity
- Avoid default imports when possible
- Use aliases for conflicting imports

```typescript
// Good
import { useState, useEffect } from 'react';
import { useUserStore } from '@/stores/user.store';

// Avoid
import React from 'react';
import userStore from '@/stores/user.store';
```

---

## TypeScript Configuration

### Strict Mode Enabled

```json
{
  "compilerOptions": {
    "strict": true,
    "noImplicitAny": true,
    "strictNullChecks": true,
    "strictFunctionTypes": true,
    "strictBindCallApply": true,
    "strictPropertyInitialization": true,
    "noImplicitThis": true,
    "alwaysStrict": true,
    "esModuleInterop": true,
    "forceConsistentCasingInFileNames": true,
    "skipLibCheck": true,
    "allowSyntheticDefaultImports": true,
    "experimentalDecorators": true,
    "emitDecoratorMetadata": true
  }
}
```

### Type Safety Standards

#### Interface vs Type

- Use `interface` for object types that might be extended
- Use `type` for unions, intersections, and utility types

```typescript
// Interface for objects that might be extended
interface User {
  id: string;
  name: string;
  email: string;
}

interface Admin extends User {
  role: 'admin';
}

// Type for unions and intersections
type UserStatus = 'active' | 'inactive' | 'pending';
type UserProfile = User & { profile: Profile };
```

#### Generic Type Constraints

```typescript
// Always specify constraints when appropriate
function fetchData<T extends { id: string }>(url: string): Promise<T> {
  return fetch(url).then((res) => res.json());
}

// Use readonly for immutable data
interface ImmutableUser {
  readonly id: string;
  readonly name: string;
}
```

#### Null and Undefined Handling

```typescript
// Use nullish coalescing operator
const name = user?.name ?? 'Guest';

// Use optional chaining for nested properties
const address = user?.address?.street;

// Explicitly type optional props
interface ButtonProps {
  onClick?: () => void;
  disabled?: boolean;
}
```

---

## Testing Standards

### Jest Configuration

```javascript
// jest.config.js
module.exports = {
  testEnvironment: 'jsdom',
  setupFilesAfterEnv: ['<rootDir>/jest.setup.js'],
  moduleNameMapping: {
    '^@/(.*)$': '<rootDir>/src/$1'
  },
  collectCoverageFrom: ['src/**/*.{ts,tsx}', '!src/**/*.d.ts', '!src/**/*.stories.{ts,tsx}'],
  coverageThreshold: {
    global: {
      branches: 80,
      functions: 80,
      lines: 80,
      statements: 80
    }
  }
};
```

### Component Testing with React Testing Library

#### Basic Component Test

```typescript
import { render, screen } from '@testing-library/react';
import { Button } from '@/components/ui/button';

describe('Button', () => {
  it('renders button with correct text', () => {
    render(<Button>Click me</Button>);
    expect(screen.getByRole('button', { name: /click me/i })).toBeInTheDocument();
  });

  it('calls onClick when clicked', () => {
    const handleClick = jest.fn();
    render(<Button onClick={handleClick}>Click me</Button>);

    const button = screen.getByRole('button');
    button.click();

    expect(handleClick).toHaveBeenCalledTimes(1);
  });
});
```

#### Async Component Test

```typescript
import { render, screen, waitFor } from '@testing-library/react';
import { UserProfile } from '@/components/user-profile';
import { useUserStore } from '@/stores/user.store';

jest.mock('@/stores/user.store');

describe('UserProfile', () => {
  it('displays user name when loaded', async () => {
    (useUserStore as jest.Mock).mockReturnValue({
      user: { id: '1', name: 'John', email: 'john@example.com' }
    });

    render(<UserProfile />);

    await waitFor(() => {
      expect(screen.getByText('John')).toBeInTheDocument();
    });
  });
});
```

### API Service Testing

```typescript
import { httpClient } from '@/services/http/client';
import { login } from '@/services/api/auth.service';

jest.mock('@/services/http/client');

describe('Auth Service', () => {
  beforeEach(() => {
    jest.clearAllMocks();
  });

  it('sends correct login request', async () => {
    (httpClient.post as jest.Mock).mockResolvedValue({
      data: { success: true, data: { token: 'fake-token' } }
    });

    await login({ email: 'test@example.com', password: 'password' });

    expect(httpClient.post).toHaveBeenCalledWith('/auth/login', {
      email: 'test@example.com',
      password: 'password'
    });
  });
});
```

---

## Git Hooks (Husky, lint-staged)

### Configuration

```json
// package.json
{
  "lint-staged": {
    "src/**/*": ["pnpm prettier:format", "pnpm eslint:format"]
  },
  "husky": {
    "hooks": {
      "pre-commit": "lint-staged",
      "commit-msg": "commitlint -E HUSKY_GIT_PARAMS"
    }
  }
}
```

### Hook Workflow

#### Pre-commit Hook

1. **lint-staged** runs on staged files
2. **Prettier** formats the files
3. **ESLint** fixes auto-fixable issues
4. Files are restaged automatically

#### Commit Message Hook

1. **commitlint** enforces conventional commit format
2. Validates commit message structure

### Commit Message Standards

```bash
# Format: type(scope): description
feat(auth): add login functionality
fix(ui): resolve button styling issue
docs(readme): update installation instructions
test(component): add button tests
chore(deps): update react to latest version
```

---

## General Coding Conventions

### Naming Conventions

#### Variables and Functions

```typescript
// Use camelCase
const userName = 'John';
const calculateTotal = (items: Item[]) => { ... };

// Use descriptive names
const isLoading = false; // Not: isLd
const userPreferences = { ... }; // Not: usrPrefs
```

#### Components and Files

```typescript
// Use PascalCase for components
const UserProfile = () => { ... };
const UserList = () => { ... };

// Use kebab-case for files
user-profile.tsx
user-list.tsx
auth-service.ts
```

#### Constants and Types

```typescript
// Use UPPER_SNAKE_CASE for constants
const MAX_RETRIES = 3;
const API_BASE_URL = 'https://api.example.com';

// Use PascalCase for interfaces and types
interface User { ... }
type UserStatus = 'active' | 'inactive';
```

### Function Patterns

#### Async Functions

```typescript
// Always use async/await
const fetchUserData = async (id: string): Promise<User> => {
  try {
    const response = await httpClient.get(`/users/${id}`);
    return response.data;
  } catch (error) {
    throw new Error('Failed to fetch user data');
  }
};

// Handle errors properly
const handleError = (error: unknown): never => {
  if (error instanceof Error) {
    console.error('Error:', error.message);
  } else {
    console.error('Unknown error occurred');
  }
  throw error;
};
```

#### Pure Functions

```typescript
// Prefer pure functions when possible
const calculateTotal = (items: Item[]): number => {
  return items.reduce((sum, item) => sum + item.price, 0);
};

// Avoid side effects in pure functions
const filterActiveUsers = (users: User[]): User[] => {
  return users.filter((user) => user.status === 'active');
};
```

---

## Component Patterns

### Functional Components with TypeScript

```typescript
interface UserCardProps {
  user: User;
  onClick?: () => void;
  className?: string;
}

const UserCard: React.FC<UserCardProps> = ({ user, onClick, className }) => {
  return (
    <div className={cn('user-card', className)} onClick={onClick}>
      <Avatar src={user.avatar} />
      <div className="user-info">
        <h3>{user.name}</h3>
        <p>{user.email}</p>
      </div>
    </div>
  );
};
```

### Custom Hooks Pattern

```typescript
import { useState, useEffect } from 'react';

const useUser = (id: string) => {
  const [user, setUser] = useState<User | null>(null);
  const [isLoading, setIsLoading] = useState(true);
  const [error, setError] = useState<Error | null>(null);

  useEffect(() => {
    const fetchUser = async () => {
      try {
        const response = await httpClient.get(`/users/${id}`);
        setUser(response.data);
      } catch (err) {
        setError(err as Error);
      } finally {
        setIsLoading(false);
      }
    };

    fetchUser();
  }, [id]);

  return { user, isLoading, error };
};
```

### Higher-Order Components (Optional)

```typescript
interface withAuthProps {
  children: React.ReactNode;
}

const withAuth = <P extends object>(
  Component: React.ComponentType<P>
): React.FC<P & withAuthProps> => {
  return ({ children, ...props }) => {
    const { isAuthenticated } = useUserStore();

    if (!isAuthenticated) {
      return <Navigate to="/auth/login" />;
    }

    return <Component {...(props as P)}>{children}</Component>;
  };
};
```

---

## State Management Standards

### Zustand Store Pattern

```typescript
interface UserState {
  user: User | null;
  token: string | null;
  isLoading: boolean;
  error: Error | null;
}

interface UserActions {
  login: (credentials: LoginRequest) => Promise<void>;
  logout: () => void;
  setUser: (user: User) => void;
  clearError: () => void;
}

export const useUserStore = create<UserState & UserActions>()(
  persist(
    (set, get) => ({
      // Initial state
      user: null,
      token: null,
      isLoading: false,
      error: null,

      // Actions
      login: async (credentials) => {
        set({ isLoading: true });
        try {
          const response = await loginService(credentials);
          set({
            user: response.user,
            token: response.token,
            isLoading: false,
            error: null
          });
        } catch (error) {
          set({
            error: error as Error,
            isLoading: false
          });
        }
      },

      logout: () => {
        set({
          user: null,
          token: null,
          error: null
        });
      },

      setUser: (user) => {
        set({ user });
      },

      clearError: () => {
        set({ error: null });
      }
    }),
    {
      name: 'user-storage',
      partialize: (state) => ({
        user: state.user,
        token: state.token
      })
    }
  )
);
```

### State Update Patterns

```typescript
// Prefer selectors for derived state
const userSelector = (state: UserState) => state.user;
const user = useUserStore(userSelector);

// Batch updates when possible
setUser(newUser);
setLoading(false);
setError(null);

// Use middleware for side effects
const logger = storeApi((set, get) => ({
  ...initialState,
  updateUser: (user) => {
    console.log('Updating user:', user);
    set({ user });
  }
}));
```

---

## Pitch Deck Management Standards

### File Organization

Pitch deck management follows established patterns:

```
src/
├── constants/
│   └── pitch-deck-status.ts        # Status constants and utilities
├── services/api/
│   └── pitch-deck.service.ts      # Pitch deck API service
├── types/
│   ├── request/
│   │   └── pitch-deck.ts          # Request types
│   └── response/
│       └── pitch-deck.ts         # Response types with VC framework
├── utils/
│   ├── retry.ts                   # Retry utility for transient failures
│   └── index.ts                   # Utility exports
└── stores/
    └── pitch-deck.store.ts        # Pitch deck state management
```

### API Type Definitions

#### Request Types

```typescript
// Always use specific request types
interface UploadPitchDeckRequest {
  file: File;
}

interface UploadPitchDeckWithMetadataRequest {
  deck: File;
  title: string;
  description?: string;
  tags?: string[];
}

interface ListPitchDecksQuery {
  status?: PitchDeckStatus; // Use enum from constants
  limit?: number;
  offset?: number;
}
```

#### Response Types

```typescript
// Use comprehensive response types
interface PitchDeckListItem {
  id: string;
  uuid: string;
  title: string;
  description: string | null;
  originalFileName: string;
  mimeType: string;
  fileSize: number;
  status: PitchDeckStatus; // Use enum from constants
  chunkCount: number;
  errorMessage: string | null;
  tags: string[] | null;
  createdAt: string;
  updatedAt: string;
  lastAccessedAt: string;
}
```

### Status Management

#### Using Status Constants

```typescript
// Import from constants
import {
  PitchDeckStatus,
  PITCH_DECK_STATUS,
  getStatusLabel,
  getStatusColor
} from '@/constants/pitch-deck-status';

// Display status in UI
function StatusBadge({ status }: { status: PitchDeckStatus }) {
  const colorClass = getStatusColor(status);
  const label = getStatusLabel(status);

  return (
    <span className={`${colorClass} px-2 py-1 rounded-full text-sm font-medium`}>
      {label}
    </span>
  );
}
```

### Retry Utility Usage

#### For API Calls

```typescript
// Import retry utility
import { withRetry, type RetryOptions } from '@/utils/retry';

// Configure retry for specific operations
const pitchDeckRetryOptions: RetryOptions = {
  maxRetries: 3,
  baseDelay: 1000,
  maxDelay: 30000
};

// Use with API calls
const uploadResult = await withRetry(
  () => pitchDeckService.uploadPitchDeck(request),
  pitchDeckRetryOptions
);
```

#### Error Handling with Retry

```typescript
async function uploadWithRetry(file: File) {
  try {
    const result = await withRetry(() => pitchDeckService.uploadPitchDeck({ file }), {
      maxRetries: 3
    });
    return result;
  } catch (error) {
    // Handle final error after all retries
    if (error.response?.status === 413) {
      throw new Error('File size exceeds limit');
    }
    throw new Error('Upload failed. Please try again.');
  }
}
```

---

## API Layer Standards

### HTTP Client Configuration

```typescript
// Always use typed responses
export const httpClient = Axios.create({
  baseURL: env.NEXT_PUBLIC_API_BASE,
  timeout: 60000 * 5,
  headers: {
    'Content-Type': 'application/json'
  }
});

// Request interceptor with proper typing
httpClient.interceptors.request.use(
  (config: InternalAxiosRequestConfig) => {
    // Add authentication token
    const token = getAuthToken();
    if (token) {
      config.headers.Authorization = `Bearer ${token}`;
    }
    return config;
  },
  (error) => Promise.reject(error)
);

// Response interceptor with error handling
httpClient.interceptors.response.use(
  (response: AxiosResponse) => response,
  (error: AxiosError) => {
    // Handle specific error cases
    if (error.response?.status === 401) {
      // Clear auth state
      clearAuth();
      redirect to login
    }
    return Promise.reject(error);
  }
);
```

### API Service Pattern

```typescript
// Always use request/response types
interface LoginRequest {
  email: string;
  password: string;
}

interface LoginResponse {
  token: string;
  user: User;
  expiresIn: number;
}

export const authService = {
  login: async (credentials: LoginRequest): Promise<LoginResponse> => {
    const response = await httpClient.post<ApiResponse<LoginResponse>>('/auth/login', credentials);
    return response.data.data;
  },

  logout: async (): Promise<void> => {
    await httpClient.post('/auth/logout');
  },

  refreshToken: async (): Promise<{ token: string }> => {
    const response = await httpClient.post<{ token: string }>('/auth/refresh');
    return response.data;
  }
};
```

### Error Handling Patterns

```typescript
// Custom error class
class ApiError extends Error {
  constructor(
    message: string,
    public statusCode: number,
    public code?: string
  ) {
    super(message);
    this.name = 'ApiError';
  }
}

// API error wrapper
export const handleApiError = (error: unknown): never => {
  if (axios.isAxiosError(error)) {
    const response = error.response?.data;
    throw new ApiError(
      response?.message || 'API request failed',
      error.response?.status || 500,
      response?.code
    );
  }

  if (error instanceof Error) {
    throw new ApiError(error.message, 500, 'UNKNOWN_ERROR');
  }

  throw new ApiError('Unknown error occurred', 500);
};
```

---

## Code Review Checklist

### Before Merging

- [ ] All ESLint rules pass
- [ ] Code is formatted with Prettier
- [ ] TypeScript compilation succeeds
- [ ] Tests are written for new functionality
- [ ] Documentation is updated if needed
- [ ] Follows established patterns and conventions
- [ ] Proper error handling implemented
- [ ] Performance considerations addressed

### Quality Metrics

- Maintainability: High
- Test Coverage: Target 80%+
- Code Complexity: Low to moderate
- Documentation: Comprehensive for complex features

---

_Last Updated: 2026-02-03_
_Version: 0.1.0_
</file>

<file path="docs/codebase-summary.md">
# Codebase Summary

This document provides a comprehensive overview of the pitch deck management system codebase, including architecture, patterns, and key components.

## Project Overview

**Project:** Pitch Deck Management System
**Technology Stack:** Next.js 15, React 19, TypeScript, Tailwind CSS, Zustand
**Phase:** Foundation Layer (v0.1.0)

## Architecture Overview

### 1. Core Architecture Pattern

The application follows a clean architecture with clear separation of concerns:

```
src/
├── app/                    # Next.js App Router pages
├── components/            # UI components (organized by domain)
├── config/               # Configuration files
├── constants/            # Application constants and enums
├── hooks/                # Custom React hooks
├── lib/                  # External library configurations
├── providers/            # Context providers
├── services/             # API services and HTTP client
├── stores/               # State management (Zustand)
├── types/                # TypeScript type definitions
└── utils/                # Utility functions and helpers
```

### 2. Service Layer Pattern

Strict separation between API logic and UI components:

- **HTTP Client** (`src/services/http/client.ts`): Axios instance with JWT interceptors
- **API Services** (`src/services/api/`): Domain-specific service modules
- **Type Safety**: Comprehensive request/response type definitions

### 3. State Management

Zustand stores with localStorage persistence:

- User authentication store with JWT handling
- Pitch deck store for managing upload states and analysis results
- Automatic token attachment via HTTP interceptors

## Key Components

### Pitch Deck Management System

#### 1. Status Management (`src/constants/pitch-deck-status.ts`)

Four-state system for tracking pitch deck lifecycle:

```typescript
export type PitchDeckStatus = 'uploading' | 'processing' | 'ready' | 'error';
```

**Features:**

- Configurable labels and Tailwind CSS color classes
- Utility functions for status management
- Visual indicators (badges, progress rings)
- Dark/light mode support

#### 2. API Type Definitions

**Request Types:**

- `UploadPitchDeckRequest`: Basic file upload
- `UploadPitchDeckWithMetadataRequest`: Upload with title, description, tags
- `AnalyzePitchDeckRequest`: Trigger analysis by upload ID
- `ListPitchDecksQuery`: Filter and paginate pitch deck lists

**Response Types:**

- `PitchDeckListItem`: Basic pitch deck information
- `PitchDeckAnalysisResponse`: VC framework analysis results
- `VCCategoryScore`: Scores for 7 VC evaluation categories
- `StrengthItem[]` and `ImprovementItem[]`: Analysis insights

#### 3. Retry Utility (`src/utils/retry.ts`)

Exponential backoff with jitter for handling transient failures:

```typescript
export const withRetry = async <T>(
  fn: () => Promise<T>,
  options: RetryOptions = {}
): Promise<T>
```

**Features:**

- Configurable retry parameters (maxRetries, baseDelay, maxDelay)
- Prevents retry storms with random jitter
- Handles network timeouts and server overload
- Integration with pitch deck API services

### VC Framework Integration

#### 7 VC Categories:

1. **teamAndFounders**: Evaluation of founding team
2. **marketSize**: Market opportunity and sizing
3. **productSolution**: Product-market fit
4. **traction**: Growth metrics and validation
5. **businessModel**: Revenue and monetization
6. **competition**: Competitive landscape
7. **financials**: Financial projections and health

#### Analysis Output Structure:

```typescript
{
  overallScore: number,
  categoryScores: VCCategoryScore,
  strengths: StrengthItem[],
  improvements: ImprovementItem[],
  competitiveAnalysis?: CompetitiveAnalysis
}
```

## Component Architecture

### 1. Component Organization

```
components/
├── auth/           # Authentication components
├── common/         # Shared UI components
├── layout/         # Layout components (header, footer)
├── pitch-deck/     # Pitch deck specific components
└── ui/            # shadcn/ui base components
```

### 2. Pitch Deck Components

- **file-uploader.tsx**: Drag-and-drop file upload interface
- **upload-progress.tsx**: Real-time upload progress display
- **analysis-result.tsx**: VC framework analysis results
- **category-card.tsx**: Individual category score display
- **strength-card.tsx** & **improvement-card.tsx**: Actionable insights
- **competitive-analysis.tsx**: Market positioning visualization
- **gauge-chart.tsx**: Visual score representation

### 3. UI Components

- **Animated components**: Fade-in, scale-in, slide-up effects
- **Base components**: Button, input, with consistent styling
- **Sonner integration**: Toast notifications for user feedback

## API Integration

### 1. HTTP Client Configuration

```typescript
export const httpClient = Axios.create({
  baseURL: env.NEXT_PUBLIC_API_BASE,
  timeout: 60000 * 5,
  headers: { 'Content-Type': 'application/json' }
});
```

**Features:**

- Automatic JWT token attachment
- Global error handling (401 redirect to login)
- Request/response interceptors
- Timeout protection

### 2. Service Layer

```typescript
export class PitchDeckService {
  async uploadPitchDeck(request: UploadPitchDeckRequest);
  async uploadPitchDeckWithMetadata(request: UploadPitchDeckWithMetadataRequest);
  async analyzePitchDeck(request: AnalyzePitchDeckRequest);
  async listPitchDecks(query?: ListPitchDecksQuery);
  async getPitchDeckDetail(id: string);
}
```

### 3. Error Handling Patterns

- Retry utility for transient failures
- Type-safe error handling
- User-friendly error messages
- Network error recovery

## Type Safety

### 1. Strict TypeScript Configuration

- All rules enabled in strict mode
- No implicit any or null checks
- Explicit return types for functions
- Comprehensive interface definitions

### 2. API Contract Types

- Separate request/response type definitions
- Union types for status values
- Generic types for reusable functions
- Optional chaining and nullish coalescing

### 3. Path Aliases

```json
{
  "compilerOptions": {
    "paths": {
      "@/*": ["./src/*"]
    }
  }
}
```

## Development Standards

### 1. Code Organization

- **Kebab-case** for filenames
- **Barrel exports** for clean imports
- **200-line limit** per file
- **Clear separation** of concerns

### 2. Import Organization

1. Next.js imports
2. Third-party imports
3. Internal imports (styles, components, utilities)
4. Relative imports

### 3. Testing Strategy

- Jest with React Testing Library
- 70% coverage threshold
- Component testing patterns
- API service mocking

## Security Considerations

### 1. Authentication

- JWT-based authentication
- Token auto-refresh handling
- Protected route guards
- Secure storage of tokens

### 2. Environment Variables

- T3 Env with Zod validation
- All sensitive data in .env files
- No hardcoded credentials

### 3. API Security

- Request/response validation
- Error handling without information leakage
- HTTPS enforcement in production

## Performance Optimizations

### 1. Next.js Optimizations

- App Router for efficient routing
- Code splitting and lazy loading
- Optimized image handling
- Fast refresh for development

### 2. Bundle Management

- Tree-shaking for unused code
- Dynamic imports for heavy components
- Optimized dependencies with pnpm

### 3. State Management

- Zustand for reactive updates
- LocalStorage persistence
- Selectors for derived state

## Key Files and Directories

### Core Configuration

- `package.json`: Project dependencies and scripts
- `tsconfig.json`: TypeScript configuration
- `tailwind.config.js`: Tailwind CSS configuration
- `next.config.mjs`: Next.js configuration
- `eslint.config.mjs`: ESLint configuration

### Application Entry Points

- `src/app/layout.tsx`: Root layout with providers
- `src/app/page.tsx`: Landing page
- `src/components/ui/`: shadcn/ui component library
- `src/stores/index.ts`: State management entry point

### API Layer

- `src/services/http/client.ts`: HTTP client configuration
- `src/services/api/pitch-deck.service.ts`: Pitch deck API service
- `src/types/request/pitch-deck.ts`: Request type definitions
- `src/types/response/pitch-deck.ts`: Response type definitions

### Constants and Utilities

- `src/constants/pitch-deck-status.ts`: Status management
- `src/utils/retry.ts`: Retry mechanism
- `src/utils/index.ts`: Utility exports

## Development Workflow

### 1. Git Workflow

- Pre-commit hooks (Prettier + ESLint)
- Conventional commits
- Pre-push test suite
- Feature branch development

### 2. Code Quality

- ESLint rule enforcement
- Prettier formatting
- TypeScript strict mode
- Regular code reviews

### 3. Deployment

- Vercel deployment configuration
- Environment-specific builds
- Optimized production builds

## Future Enhancements

### Phase 1 (Foundation Layer - In Progress)

- ✅ Pitch deck status system
- ✅ API type definitions
- ✅ Retry utility
- ✅ Service architecture
- 🚧 UI component implementation
- 🚧 Upload interface
- 🚧 Analysis visualization

### Phase 2 (v0.3.0)

- Internationalization (i18n)
- Analytics integration
- Performance monitoring
- Accessibility improvements

### Phase 3 (v1.0.0)

- Advanced analytics dashboard
- Export and sharing capabilities
- Multi-user support
- Advanced filtering and search

## Maintenance

### Documentation

- Comprehensive API documentation
- Component usage examples
- Code standards and patterns
- Migration guides

### Monitoring

- Error tracking integration
- Performance metrics
- User behavior analytics
- API health monitoring

---

_Last Updated: 2026-02-03_
_Version: 0.1.0_
_Status: Foundation Layer Development_
</file>

<file path="docs/project-overview-pdr.md">
# Project Overview - Product Development Requirements (PDR)

## Project Information

**Project Name:** pitch-deck-management
**Version:** 0.1.0
**Description:** Pitch deck management system with upload, analysis, and VC framework evaluation capabilities
**Status:** Active Development - Phase 01: Foundation Layer

## Technology Stack

### Core Framework

- **Next.js 15.5** - React framework with App Router and Server Components
- **React 19 RC** - Latest React with concurrent features and hooks
- **TypeScript 5.7** - Type-safe JavaScript with modern features

### Styling & UI

- **Tailwind CSS 3.4** - Utility-first CSS framework
- **shadcn/ui** - Modern component library with Radix UI primitives
- **tailwind-merge** - Tailwind CSS class merging utilities
- **tailwindcss-animate** - Animation utilities for Tailwind CSS

### State Management

- **Zustand** - Lightweight state management solution
- **React Context API** - Theme and authentication contexts

### HTTP & API

- **Axios** - Promise-based HTTP client
- **Zod** - TypeScript-first schema validation

### Development Tools

- **ESLint** - JavaScript/TypeScript linting
- **Prettier** - Code formatting
- **Jest** - Testing framework
- **Testing Library** - Testing utilities
- **Husky & lint-staged** - Git hooks for pre-commit checks

### Build & Deployment

- **PostCSS** - CSS transformation tool
- **Autoprefixer** - CSS vendor prefixing
- **pnpm** - Fast, disk space efficient package manager

## Key Features

### 1. Authentication System

- JWT-based authentication with state persistence
- Protected routes and guards
- Automatic token refresh handling
- User session management

### 2. Dark Mode Support

- Theme provider with light/dark mode switching
- System preference detection
- Persistent theme selection

### 3. State Management

- Centralized user authentication state
- Persistent storage for user data
- Reactive state updates with Zustand

### 4. Testing Infrastructure

- Comprehensive test setup with Jest
- React Testing Library integration
- Coverage reports and CI/CD support
- Storybook for component development

### 5. Developer Experience

- ESLint + Prettier for consistent code style
- Husky pre-commit hooks
- lint-staged for staged file formatting
- TypeScript strict mode enabled

### 6. Pitch Deck Management

- File upload with chunked transfer support
- Real-time status tracking (uploading, processing, ready, error)
- VC framework analysis with 7 key categories
- Retry mechanism with exponential backoff for transient failures
- Comprehensive API type definitions

### 7. Performance Optimizations

- Next.js App Router for efficient routing
- Code splitting and lazy loading
- Optimized bundle sizes
- Image optimization support

## Product Requirements

### Functional Requirements

1. **User Authentication**

   - Login/logout functionality
   - Protected route access
   - Token-based authorization
   - Session persistence

2. **Theme Management**

   - Light/dark mode toggle
   - System preference detection
   - Theme persistence across sessions

3. **API Integration**

   - RESTful API communication
   - Request/response interceptors
   - Error handling and status codes
   - Axios configuration with timeouts

4. **Pitch Deck Management**
   - File upload with metadata support
   - Real-time status tracking
   - VC framework analysis integration
   - Automatic retry mechanism for transient failures
   - Pagination and filtering for pitch deck lists

### Non-Functional Requirements

1. **Code Quality**

   - TypeScript strict mode
   - ESLint rule enforcement
   - Prettier formatting
   - Consistent coding standards

2. **Performance**

   - Fast initial load times
   - Optimized bundle sizes
   - Efficient state management
   - Proper image handling

3. **Maintainability**

   - Clear directory structure
   - Consistent naming conventions
   - Comprehensive documentation
   - Type-safe API contracts

4. **Testing**
   - Unit tests for utilities
   - Component tests with RTL
   - Integration tests
   - Coverage reporting

## Acceptance Criteria

### Basic Setup

- [ ] Project builds successfully
- [ ] ESLint passes without errors
- [ ] Prettier formatting is consistent
- [ ] TypeScript compilation succeeds

### Authentication

- [ ] User can login with valid credentials
- [ ] Protected routes are inaccessible without auth
- [ ] JWT tokens are properly stored and refreshed
- [ ] Logout clears user state

### Theme System

- [ ] Theme switcher functions correctly
- [ ] Theme persists across page refreshes
- [ ] System preference is detected
- [ ] UI elements adapt to theme

### API Integration

- [ ] HTTP client is properly configured
- [ ] Requests include authentication headers
- [ ] Error handling is implemented
- [ ] API responses are properly typed

### Pitch Deck Management

- [ ] File upload functionality works with metadata
- [ ] Status tracking displays correctly (uploading, processing, ready, error)
- [ ] Retry mechanism handles transient failures
- [ ] Pitch deck lists load with pagination
- [ ] VC framework analysis results display properly

## Implementation Status

### ✅ Completed

- Basic Next.js setup with App Router
- TypeScript configuration
- Tailwind CSS integration
- shadcn/ui component setup
- Basic project structure
- ESLint + Prettier configuration
- Husky + lint-staged setup
- Zustand store configuration
- HTTP client with Axios
- Basic layout components
- Pitch deck status constants and utilities
- API type definitions for pitch deck management
- Retry utility with exponential backoff
- Service layer architecture for pitch deck API

### 🚧 In Progress

- Authentication system implementation
- Theme provider integration
- API service integration
- Component library expansion
- Pitch deck upload UI implementation
- Pitch deck list management interface
- Status display components
- VC framework analysis visualization

### ❌ Planned

- Storybook configuration
- Additional UI components
- Error boundary implementation
- Loading states
- Form validation
- Internationalization support

## Dependencies & Requirements

### Node.js

- Version: >= 18.20.2

### Package Manager

- pnpm: ^9.1.1

### Browser Support

- Modern browsers with ES2017+ support
- Chrome, Firefox, Safari, Edge latest versions

## Security Considerations

1. **Environment Variables**

   - All sensitive data in .env files
   - Environment validation with @t3-oss/env-nextjs

2. **Authentication**

   - JWT token storage in secure cookies (planned)
   - HTTPS requirement in production
   - CSRF protection (planned)

3. **Input Validation**
   - Zod schema validation for API requests
   - Type checking at runtime
   - Sanitization of user inputs

## Future Enhancements

### Phase 1 (v0.2.0) - Foundation Layer

- ✅ Pitch deck status constants and utilities
- ✅ API type definitions for pitch deck management
- ✅ Retry utility with exponential backoff
- ✅ Service layer architecture for pitch deck API
- 🚧 Pitch deck upload UI implementation
- 🚧 Pitch deck list management interface
- 🚧 Status display components
- 🚧 VC framework analysis visualization
- Form validation with Zod and React Hook Form
- Error boundaries and error pages
- Loading states and skeletons
- SEO optimization

### Phase 2 (v0.3.0)

- Internationalization (i18n)
- Analytics integration
- Performance monitoring
- Accessibility improvements

### Phase 3 (v1.0.0)

- CMS integration
- E-commerce features
- Real-time features (WebSockets)
- PWA capabilities

## Maintainers

- Development Team: TBX/Capylabs
- Contact: development@capylabs.com

## Phase 01: Foundation Layer Summary

### Completed Components (February 3, 2026)

1. **Pitch Deck Status System**

   - Four status constants: uploading, processing, ready, error
   - Configurable labels and Tailwind CSS color classes
   - Utility functions for status management

2. **API Type Definitions**

   - Request types: UploadPitchDeckRequest, AnalyzePitchDeckRequest, ListPitchDecksQuery
   - Response types: PitchDeckListItem, PitchDeckAnalysisResponse with VC framework types
   - Comprehensive typing for all API interactions

3. **Retry Utility**

   - Exponential backoff with jitter to prevent retry storms
   - Configurable retry parameters (maxRetries, baseDelay, maxDelay)
   - Handles transient network and server failures

4. **Service Architecture**
   - Separated API logic from UI components
   - Axios HTTP client with JWT interceptors
   - Domain-specific service modules for clean code organization

### Next Steps

1. Implement UI components for pitch deck upload interface
2. Create pitch deck list management interface with status display
3. Develop VC framework analysis visualization components
4. Integrate retry mechanism in UI for better user experience

---

_Last Updated: 2026-02-03_
_Version: 0.1.0_
</file>

<file path="docs/system-architecture.md">
# System Architecture

This document provides a comprehensive overview of the Next.js boilerplate system architecture, including component organization, data flow, and implementation patterns.

## Table of Contents

1. [Application Architecture Overview](#application-architecture-overview)
2. [Layer Structure](#layer-structure)
3. [Authentication Flow](#authentication-flow)
4. [HTTP Client Architecture](#http-client-architecture)
5. [Provider Setup](#provider-setup)
6. [State Management Architecture](#state-management-architecture)
7. [Component Architecture](#component-architecture)
8. [API Integration Pattern](#api-integration-pattern)
9. [Error Handling Strategy](#error-handling-strategy)
10. [Performance Architecture](#performance-architecture)

---

## Application Architecture Overview

### High-Level Architecture Diagram

```
┌─────────────────────────────────────────────────────────────┐
│                      Presentation Layer                      │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐        │
│  │   UI        │  │   Layout    │  │   Pages     │        │
│  │  Components │  │  Components │  │  Components │        │
│  └─────────────┘  └─────────────┘  └─────────────┘        │
└─────────────────────────────────────────────────────────────┘
                              │
┌─────────────────────────────────────────────────────────────┐
│                        Logic Layer                           │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐        │
│  │   Hooks    │  │  Stores     │  │   Services  │        │
│  │  (Custom)  │  │  (Zustand)  │  │   (API)     │        │
│  └─────────────┘  └─────────────┘  └─────────────┘        │
└─────────────────────────────────────────────────────────────┘
                              │
┌─────────────────────────────────────────────────────────────┐
│                        Data Layer                           │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐        │
│  │  HTTP      │  │   Local     │  │   External  │        │
│  │  Client    │  │   State     │  │   API       │        │
│  │ (Axios)    │  │ (Storage)   │  │             │        │
│  └─────────────┘  └─────────────┘  └─────────────┘        │
└─────────────────────────────────────────────────────────────┘
```

### Key Architectural Principles

1. **Layered Architecture**: Clear separation between presentation, logic, and data layers
2. **Component Composition**: Reusable components with single responsibility
3. **State Management**: Centralized state with Zustand, persisted locally
4. **API Integration**: Centralized HTTP client with interceptors
5. **Type Safety**: Comprehensive TypeScript implementation
6. **Error Boundaries**: Graceful error handling throughout the application

---

## Layer Structure

### 1. Presentation Layer

**Responsibility**: User interface and user interactions

#### Components Layer

```typescript
// src/components/
├── ui/           # shadcn/ui primitives (Button, Input, etc.)
├── common/       # Reusable business components
├── layout/       # Page layout components
└── forms/        # Form components (future)
```

**Component Responsibilities**:

- **UI Components**: Low-level, reusable components
- **Common Components**: Business logic with UI components
- **Layout Components**: Page structure and navigation

#### Pages Layer

```typescript
// src/app/
├── layout.tsx           # Root layout with providers
├── page.tsx            # Home page
├── dashboard/          # Dashboard section
│   ├── layout.tsx      # Dashboard layout
│   └── page.tsx       # Dashboard home
└── auth/              # Authentication pages
    ├── login/         # Login page
    └── register/     # Register page
```

### 2. Logic Layer

**Responsibility**: Business logic and state management

#### Custom Hooks

```typescript
// src/hooks/
├── useAuth.ts          # Authentication logic
├── useTheme.ts         # Theme management
├── useApi.ts          # API data fetching
└── index.ts          # Hook exports
```

#### State Management (Zustand)

```typescript
// src/stores/
├── user.store.ts      # User authentication state
├── theme.store.ts     # Theme preferences (future)
└── index.ts          # Store exports
```

### 3. Data Layer

**Responsibility**: Data persistence and external API communication

#### HTTP Client

```typescript
// src/services/http/
├── client.ts          # Axios instance with interceptors
├── interceptors.ts    # Request/response interceptors
└── index.ts          # HTTP exports
```

#### API Services

```typescript
// src/services/api/
├── auth.service.ts   # Authentication API calls
├── user.service.ts   # User API calls
└── index.ts         # API service exports
```

---

## Authentication Flow

### Authentication Architecture

```mermaid
sequenceDiagram
    participant User
    participant UI
    participant AuthProvider
    participant UserStore
    participant HTTPClient
    participant API

    User->>UI: Clicks Login
    UI->>AuthProvider: Initiates login
    AuthProvider->>UserStore: Updates loading state
    UserStore->>HTTPClient: Sends login request
    HTTPClient->>API: POST /auth/login
    API->>HTTPClient: Returns JWT token
    HTTPClient->>UserStore: Stores token
    UserStore->>AuthProvider: Updates auth state
    AuthProvider->>UI: Shows success
    UI->>User: Redirects to dashboard
```

### Authentication Implementation Pattern

#### 1. Auth Provider Setup

```typescript
// src/providers/auth-provider.tsx
interface AuthProviderProps {
  children: React.ReactNode;
}

export const AuthProvider: React.FC<AuthProviderProps> = ({ children }) => {
  const { user, token, isLoading } = useUserStore();

  // Protect routes
  if (isLoading) {
    return <LoadingSpinner />;
  }

  if (!user || !token) {
    return <Navigate to="/auth/login" />;
  }

  return <>{children}</>;
};
```

#### 2. Protected Route Pattern

```typescript
// src/components/common/protected-route.tsx
interface ProtectedRouteProps {
  children: React.ReactNode;
  requiredPermission?: string;
}

export const ProtectedRoute: React.FC<ProtectedRouteProps> = ({
  children,
  requiredPermission
}) => {
  const { user, isAuthenticated } = useUserStore();

  if (!isAuthenticated) {
    return <Navigate to="/auth/login" />;
  }

  if (requiredPermission && !user?.permissions?.includes(requiredPermission)) {
    return <Navigate to="/unauthorized" />;
  }

  return <>{children}</>;
};
```

#### 3. Login Flow Implementation

```typescript
// src/components/auth/login-form.tsx
export const LoginForm = () => {
  const [formData, setFormData] = useState<LoginRequest>({
    email: '',
    password: ''
  });
  const { login, isLoading, error } = useUserStore();

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    await login(formData);
  };

  return (
    <form onSubmit={handleSubmit}>
      <Input
        type="email"
        value={formData.email}
        onChange={(e) => setFormData({ ...formData, email: e.target.value })}
      />
      <Input
        type="password"
        value={formData.password}
        onChange={(e) => setFormData({ ...formData, password: e.target.value })}
      />
      <Button type="submit" disabled={isLoading}>
        {isLoading ? 'Logging in...' : 'Login'}
      </Button>
      {error && <ErrorMessage>{error.message}</ErrorMessage>}
    </form>
  );
};
```

---

## HTTP Client Architecture

### HTTP Client Setup

```typescript
// src/services/http/client.ts
export const httpClient = Axios.create({
  baseURL: env.NEXT_PUBLIC_API_BASE,
  timeout: 60000 * 5, // 5 minutes
  headers: {
    'Content-Type': 'application/json'
  },
  maxContentLength: 1024 * 1024 * 1024, // 1GB
  maxBodyLength: 1024 * 1024 * 1024
});
```

### Request Interceptor Chain

```typescript
// Request interceptor for authentication
httpClient.interceptors.request.use(
  async (config: InternalAxiosRequestConfig) => {
    // Step 1: Get JWT token from store
    const token = await getCurrentAccessToken();

    // Step 2: Add Authorization header if token exists
    if (token) {
      config.headers.Authorization = `Bearer ${token}`;
    }

    // Step 3: Add request ID for tracking
    config.headers['X-Request-ID'] = generateRequestId();

    // Step 4: Add timestamp
    config.headers['X-Request-Time'] = Date.now().toString();

    return config;
  },
  (error: AxiosError) => {
    return Promise.reject(error);
  }
);
```

### Response Interceptor Chain

```typescript
// Response interceptor for global error handling
httpClient.interceptors.response.use(
  (response: AxiosResponse) => {
    // Step 1: Validate response structure
    if (!response.data || typeof response.data !== 'object') {
      throw new ApiError('Invalid response structure', 500);
    }

    // Step 2: Check for API errors
    if (response.data.success === false) {
      throw new ApiError(
        response.data.message || 'API request failed',
        response.status,
        response.data.code
      );
    }

    // Step 3: Transform response data
    response.data = transformResponseData(response.data);

    return response;
  },
  async (error: AxiosError) => {
    // Step 1: Handle network errors
    if (!error.response) {
      throw new NetworkError('Network error occurred');
    }

    // Step 2: Handle authentication errors
    if (error.response.status === 401) {
      await handleUnauthorized();
      return Promise.reject(error);
    }

    // Step 3: Handle validation errors
    if (error.response.status === 422) {
      const validationErrors = parseValidationError(error.response.data);
      throw new ValidationError('Validation failed', validationErrors);
    }

    // Step 4: Handle server errors
    if (error.response.status >= 500) {
      throw new ServerError('Server error occurred');
    }

    return Promise.reject(error);
  }
);
```

### Error Handling Hierarchy

```typescript
// Custom error classes hierarchy
class ApiError extends Error {
  constructor(
    message: string,
    public statusCode: number,
    public code?: string
  ) {
    super(message);
    this.name = 'ApiError';
  }
}

class NetworkError extends Error {
  constructor(message: string) {
    super(message);
    this.name = 'NetworkError';
  }
}

class ValidationError extends Error {
  constructor(
    message: string,
    public errors: Record<string, string[]>
  ) {
    super(message);
    this.name = 'ValidationError';
  }
}

class ServerError extends Error {
  constructor(message: string) {
    super(message);
    this.name = 'ServerError';
  }
}
```

---

## Provider Setup

### Root Provider Structure

```typescript
// src/app/layout.tsx
import { AuthProvider } from '@/providers/auth-provider';
import { ThemeProvider } from '@/providers/theme-provider';
import { Toaster } from '@/components/ui/sonner';

export const metadata: Metadata = {
  title: 'Next.js Boilerplate',
  description: 'Modern web application with Next.js'
};

export default function RootLayout({
  children
}: {
  children: React.ReactNode;
}) {
  return (
    <html lang="en">
      <body className="antialiased">
        <ThemeProvider
          attribute="class"
          defaultTheme="system"
          enableSystem
          disableTransitionOnChange
        >
          <AuthProvider>
            {children}
            <Toaster />
          </AuthProvider>
        </ThemeProvider>
      </body>
    </html>
  );
}
```

### Theme Provider Implementation

```typescript
// src/providers/theme-provider.tsx
interface ThemeProviderProps {
  children: React.ReactNode;
  attribute?: string;
  defaultTheme?: string;
  enableSystem?: boolean;
  disableTransitionOnChange?: boolean;
}

export const ThemeProvider: React.FC<ThemeProviderProps> = ({
  children,
  attribute = 'class',
  defaultTheme = 'system',
  enableSystem = true,
  disableTransitionOnChange = false
}) => {
  const theme = useTheme();
  const mounted = useIsMounted();

  useEffect(() => {
    // Handle theme persistence
    const storedTheme = localStorage.getItem('theme');
    if (storedTheme) {
      theme.set(storedTheme);
    } else if (defaultTheme === 'system') {
      const systemTheme = window.matchMedia('(prefers-color-scheme: dark)').matches
        ? 'dark'
        : 'light';
      theme.set(systemTheme);
    } else {
      theme.set(defaultTheme);
    }
  }, [defaultTheme, theme]);

  // Apply theme to document
  useEffect(() => {
    if (!mounted) return;

    const root = document.documentElement;
    root.classList.remove('light', 'dark');
    root.classList.add(theme);

    if (disableTransitionOnChange) {
      root.classList.add('transition-colors');
    }
  }, [theme, mounted, disableTransitionOnChange]);

  return <ThemeProviderContext.Provider value={{ theme, setTheme }}>
    {children}
  </ThemeProviderContext.Provider>;
};
```

### Context Provider Pattern

```typescript
// src/providers/index.ts
// Combine all providers in a single file for easy importing
export { AuthProvider } from './auth-provider';
export { ThemeProvider } from './theme-provider';
export { useAuth } from './auth-context';
export { useTheme } from './theme-context';
```

---

## State Management Architecture

### Zustand Store Structure

```typescript
// src/stores/user.store.ts
interface UserState {
  // State
  user: User | null;
  token: string | null;
  isLoading: boolean;
  error: Error | null;

  // Derived state
  isAuthenticated: boolean;
  permissions: string[];
}

interface UserActions {
  // Actions
  login: (credentials: LoginRequest) => Promise<void>;
  logout: () => void;
  setUser: (user: User) => void;
  clearError: () => void;

  // Async actions
  refreshUser: () => Promise<void>;
}

export const useUserStore = create<UserState & UserActions>()(
  persist(
    (set, get) => ({
      // Initial state
      ...defaultState,

      // Actions
      login: async (credentials) => {
        set({ isLoading: true, error: null });
        try {
          const response = await authService.login(credentials);
          set({
            user: response.user,
            token: response.token,
            isLoading: false,
            error: null
          });

          // Store token in cookies for API requests
          setCookie('auth-token', response.token, {
            expires: new Date(Date.now() + response.expiresIn * 1000)
          });
        } catch (error) {
          set({
            error: error as Error,
            isLoading: false
          });
        }
      },

      logout: () => {
        set(defaultState);
        deleteCookie('auth-token');
      },

      // Selectors
      isAuthenticated: () => !!get().token,

      // Async actions
      refreshUser: async () => {
        const token = get().token;
        if (!token) return;

        try {
          const user = await userService.getMe();
          set({ user });
        } catch (error) {
          set({ error: error as Error });
        }
      }
    }),
    {
      name: 'user-storage',
      partialize: (state) => ({
        user: state.user,
        token: state.token
      }),
      storage: createJSONStorage(() => localStorage)
    }
  )
);
```

### Store Selector Pattern

```typescript
// Custom selectors for performance optimization
const userSelector = (state: UserState) => ({
  user: state.user,
  isAuthenticated: state.isAuthenticated
});

const authStatusSelector = (state: UserState) => ({
  isLoading: state.isLoading,
  error: state.error
});

// Usage in components
const { user, isAuthenticated } = useUserStore(userSelector);
const { isLoading, error } = useUserStore(authStatusSelector);
```

### State Management Best Practices

1. **Single Responsibility**: Each store manages one domain
2. **Immutable Updates**: Use state setters for updates
3. **Derived State**: Use selectors for computed values
4. **Persistence**: Only persist necessary state
5. **Error Handling**: Handle errors in store actions

---

## Component Architecture

### Component Hierarchy

```
┌─────────────────────────────────────────────────────────┐
│                    App Component                         │
│  ┌─────────────────────────────────────────────────────┐ │
│  │                Layout Component                     │ │
│  │  ┌─────────────────────────────────────────────────┐ │ │
│  │  │               Page Component                    │ │ │
│  │  │  ┌─────────────────────────────────────────────┐ │ │ │
│  │  │  │              Component                        │ │ │ │
│  │  │  │  ┌─────────────────────────────────────────┐ │ │ │ │
│  │  │  │  │              UI Component                │ │ │ │ │
│  │  │  │  │                                         │ │ │ │ │
│  │  │  │  └─────────────────────────────────────────┘ │ │ │ │
│  │  │  │                                               │ │ │ │
│  │  │  └─────────────────────────────────────────────┘ │ │ │
│  │  │                                                   │ │ │
│  │  └─────────────────────────────────────────────────┘ │ │
│  │                                                       │ │
│  └─────────────────────────────────────────────────────┘ │
│                                                           │
└─────────────────────────────────────────────────────────┘
```

### Component Composition Pattern

```typescript
// src/components/common/with-error-boundary.tsx
interface ErrorBoundaryProps {
  children: React.ReactNode;
  fallback?: React.ReactNode;
  onError?: (error: Error, errorInfo: React.ErrorInfo) => void;
}

export class ErrorBoundary extends React.Component<ErrorBoundaryProps> {
  state = { hasError: false, error: null };

  static getDerivedStateFromError(error: Error) {
    return { hasError: true, error };
  }

  componentDidCatch(error: Error, errorInfo: React.ErrorInfo) {
    this.props.onError?.(error, errorInfo);
  }

  render() {
    if (this.state.hasError) {
      return this.props.fallback || (
        <div className="error-boundary">
          <h2>Something went wrong</h2>
          <p>{this.state.error?.message}</p>
        </div>
      );
    }

    return this.props.children;
  }
}
```

### Higher-Order Component Pattern

```typescript
// src/components/hoc/with-auth.tsx
import { useUserStore } from '@/stores';

interface WithAuthProps {
  children: React.ReactNode;
  requiredPermission?: string;
}

export const withAuth = <P extends object>(
  Component: React.ComponentType<P>
): React.FC<P & WithAuthProps> => {
  const AuthenticatedComponent: React.FC<P & WithAuthProps> = ({
    children,
    requiredPermission,
    ...props
  }) => {
    const { isAuthenticated, user } = useUserStore();

    if (!isAuthenticated) {
      return <Navigate to="/auth/login" />;
    }

    if (requiredPermission && !user?.permissions?.includes(requiredPermission)) {
      return <Navigate to="/unauthorized" />;
    }

    return <Component {...(props as P)}>{children}</Component>;
  };

  return AuthenticatedComponent;
};
```

### Component Testing Strategy

```typescript
// Component tests
describe('UserProfile', () => {
  it('renders user information', () => {
    render(
      <UserStoreProvider>
        <UserProfile userId="1" />
      </UserStoreProvider>
    );

    expect(screen.getByText('John Doe')).toBeInTheDocument();
    expect(screen.getByText('john@example.com')).toBeInTheDocument();
  });

  it('shows loading state', () => {
    const { getByText } = render(
      <UserStoreProvider>
        <UserProfile userId="1" isLoading={true} />
      </UserStoreProvider>
    );

    expect(getByText('Loading...')).toBeInTheDocument();
  });

  it('shows error message', () => {
    const { getByText } = render(
      <UserStoreProvider>
        <UserProfile userId="1" error={new Error('Failed to load user')} />
      </UserStoreProvider>
    );

    expect(getByText('Failed to load user')).toBeInTheDocument();
  });
});
```

---

## API Integration Pattern

### Service Layer Architecture

```typescript
// src/services/api/index.ts
// Central API service exports
export { authService } from './auth.service';
export { userService } from './user.service';
export { apiService } from './base.service';

// API types
export type { LoginRequest, LoginResponse } from './types/auth';
export type { User, UserCreate, UserUpdate } from './types/user';
```

### Base Service Pattern

```typescript
// src/services/api/base.service.ts
export class BaseService {
  protected baseURL = env.NEXT_PUBLIC_API_BASE;
  protected httpClient = axiosClient;

  protected async get<T>(endpoint: string, config?: AxiosRequestConfig): Promise<T> {
    const response = await this.httpClient.get<T>(endpoint, config);
    return response.data;
  }

  protected async post<T>(
    endpoint: string,
    data: unknown,
    config?: AxiosRequestConfig
  ): Promise<T> {
    const response = await this.httpClient.post<T>(endpoint, data, config);
    return response.data;
  }

  protected async put<T>(endpoint: string, data: unknown, config?: AxiosRequestConfig): Promise<T> {
    const response = await this.httpClient.put<T>(endpoint, data, config);
    return response.data;
  }

  protected async delete<T>(endpoint: string, config?: AxiosRequestConfig): Promise<T> {
    const response = await this.httpClient.delete<T>(endpoint, config);
    return response.data;
  }
}
```

### Authentication Service Implementation

```typescript
// src/services/api/auth.service.ts
export class AuthService extends BaseService {
  async login(credentials: LoginRequest): Promise<LoginResponse> {
    const response = await this.post<ApiResponse<LoginResponse>>('/auth/login', credentials, {
      withCredentials: true
    });
    return response.data;
  }

  async logout(): Promise<void> {
    await this.post('/auth/logout', {}, { withCredentials: true });
  }

  async refreshToken(): Promise<{ token: string }> {
    const response = await this.post<{ token: string }>(
      '/auth/refresh',
      {},
      { withCredentials: true }
    );
    return response.data;
  }

  async validateToken(): Promise<boolean> {
    try {
      await this.get('/auth/validate');
      return true;
    } catch {
      return false;
    }
  }
}

// Service instance
export const authService = new AuthService();
```

### API Error Handling Pattern

```typescript
// src/utils/api-error.ts
export class ApiErrorHandler {
  static handle(error: unknown): never {
    if (axios.isAxiosError(error)) {
      const response = error.response;

      if (response?.status === 401) {
        throw new UnauthorizedError('Session expired', error);
      }

      if (response?.status === 403) {
        throw new ForbiddenError('Access denied', error);
      }

      if (response?.status === 404) {
        throw new NotFoundError('Resource not found', error);
      }

      if (response?.status === 422) {
        throw new ValidationError('Validation failed', error);
      }

      throw new ApiError(
        response?.data?.message || 'API request failed',
        response?.status || 500,
        error
      );
    }

    if (error instanceof Error) {
      throw error;
    }

    throw new ApiError('Unknown error occurred');
  }
}
```

---

## Error Handling Strategy

### Error Boundary Implementation

```typescript
// src/components/common/error-boundary.tsx
export class ErrorBoundary extends React.Component<
  { children: React.ReactNode },
  { hasError: boolean; error: Error | null }
> {
  constructor(props: { children: React.ReactNode }) {
    super(props);
    this.state = { hasError: false, error: null };
  }

  static getDerivedStateFromError(error: Error) {
    return { hasError: true, error };
  }

  componentDidCatch(error: Error, errorInfo: React.ErrorInfo) {
    // Log error to monitoring service
    logErrorToService(error, errorInfo);
  }

  render() {
    if (this.state.hasError) {
      return (
        <div className="error-boundary">
          <h2>Something went wrong</h2>
          <p>{this.state.error?.message}</p>
          <Button onClick={() => this.setState({ hasError: false })}>
            Try again
          </Button>
        </div>
      );
    }

    return this.props.children;
  }
}
```

### Global Error Handler

```typescript
// src/app/error.tsx
'use client';

import { useEffect } from 'react';
import { usePathname, useSearchParams } from 'next/navigation';

export default function ErrorBoundary({
  error,
  reset,
}: {
  error: Error & { digest?: string };
  reset: () => void;
}) {
  const pathname = usePathname();
  const searchParams = useSearchParams();

  useEffect(() => {
    // Log error to monitoring service
    logError({
      error,
      pathname,
      searchParams: searchParams.toString(),
      timestamp: new Date().toISOString()
    });
  }, [error, pathname, searchParams]);

  return (
    <div className="error-container">
      <h2>Something went wrong</h2>
      <p>{error.message}</p>
      <button onClick={reset}>Try again</button>
    </div>
  );
}
```

---

## Performance Architecture

### Code Splitting Strategy

```typescript
// Dynamic imports for large components
const HeavyComponent = React.lazy(() => import('@/components/heavy-component'));

// Usage in component
const Dashboard = () => (
  <div>
    <React.Suspense fallback={<LoadingSpinner />}>
      <HeavyComponent />
    </React.Suspense>
  </div>
);
```

### Image Optimization

```typescript
// Optimized image component
interface OptimizedImageProps {
  src: string;
  alt: string;
  width?: number;
  height?: number;
  priority?: boolean;
}

export const OptimizedImage: React.FC<OptimizedImageProps> = ({
  src,
  alt,
  width,
  height,
  priority = false
}) => {
  return (
    <Image
      src={src}
      alt={alt}
      width={width}
      height={height}
      priority={priority}
      sizes="(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 33vw"
      quality={85}
      loading={priority ? 'eager' : 'lazy'}
    />
  );
};
```

### Bundle Analysis

```json
// webpack-bundle-analyzer configuration
{
  "scripts": {
    "analyze": "ANALYZE=true pnpm build"
  }
}
```

### Caching Strategy

```typescript
// Cache API responses
export const useCachedData = <T>(
  key: string,
  fetcher: () => Promise<T>,
  options?: { staleTime?: number; revalidateOnFocus?: boolean }
) => {
  return useSWR(key, fetcher, {
    revalidateOnFocus: true,
    revalidateOnReconnect: true,
    shouldRetryOnError: false,
    ...options
  });
};
```

---

_Last Updated: 2026-02-03_
_Version: 0.1.0_
</file>

<file path="src/app/auth/login/page.tsx">
'use client';

import { APP_URL } from '@/constants/routes';
import { login } from '@/services/api';
import { useUserStore } from '@/stores';
import { useRouter } from 'next/navigation';
import { useState } from 'react';
import { toast } from 'sonner';

import { Button } from '@/components/ui/button';
import { Input } from '@/components/ui/input';

const USERNAME_MIN_LENGTH = 3;
const PASSWORD_MIN_LENGTH = 6;

function getErrorMessage(error: unknown): string {
  if (typeof error === 'string') return error;
  if (error instanceof Error) return error.message;

  return (
    (error as { response?: { data?: { message?: string } } })?.response?.data?.message ||
    'Login failed'
  );
}

export default function LoginPage() {
  const router = useRouter();
  const setAuth = useUserStore((state) => state.setAuth);

  const [username, setUsername] = useState('');
  const [password, setPassword] = useState('');
  const [isLoading, setIsLoading] = useState(false);

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();

    const trimmedUsername = username.trim();

    if (!trimmedUsername) {
      toast.error('Username is required');

      return;
    }

    if (trimmedUsername.length < USERNAME_MIN_LENGTH) {
      toast.error(`Username must be at least ${USERNAME_MIN_LENGTH} characters`);

      return;
    }

    if (!password) {
      toast.error('Password is required');

      return;
    }

    if (password.length < PASSWORD_MIN_LENGTH) {
      toast.error(`Password must be at least ${PASSWORD_MIN_LENGTH} characters`);

      return;
    }

    setIsLoading(true);

    try {
      const response = await login({ username: trimmedUsername, password });

      setAuth(response.user, response.token);

      toast.success('Login successful');

      router.push(APP_URL.PITCH_DECK);
    } catch (error: unknown) {
      toast.error(getErrorMessage(error));
    } finally {
      setIsLoading(false);
    }
  };

  return (
    <div className="min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900">
      <div className="max-w-md w-full space-y-8 p-8">
        <div>
          <h2 className="mt-6 text-center text-3xl font-bold tracking-tight text-gray-900 dark:text-white">
            Sign in to your account
          </h2>
        </div>
        <form className="mt-8 space-y-6" onSubmit={handleSubmit}>
          <div className="space-y-4">
            <div>
              <label htmlFor="username" className="sr-only">
                Username
              </label>
              <Input
                id="username"
                name="username"
                type="text"
                required
                placeholder="Username"
                value={username}
                onChange={(e) => setUsername(e.target.value)}
                disabled={isLoading}
                autoComplete="username"
                minLength={USERNAME_MIN_LENGTH}
              />
            </div>
            <div>
              <label htmlFor="password" className="sr-only">
                Password
              </label>
              <Input
                id="password"
                name="password"
                type="password"
                required
                placeholder="Password"
                value={password}
                onChange={(e) => setPassword(e.target.value)}
                disabled={isLoading}
                autoComplete="current-password"
                minLength={PASSWORD_MIN_LENGTH}
              />
            </div>
          </div>

          <Button type="submit" className="w-full" disabled={isLoading}>
            {isLoading ? 'Signing in...' : 'Sign in'}
          </Button>
        </form>
      </div>
    </div>
  );
}
</file>

<file path="src/app/dashboard/pitch-deck/page.tsx">
'use client';

import { uploadPitchDeck, analyzePitchDeck } from '@/services/api';
import { usePitchDeckStore, AnalysisStage } from '@/stores';
import { useCallback, useState, useEffect } from 'react';
import { toast } from 'sonner';

import { FileUploader } from '@/components/pitch-deck';
import { UploadProgress } from '@/components/pitch-deck';
import { AnalysisResult } from '@/components/pitch-deck';

export default function PitchDeckPage() {
  const {
    uploadState,
    currentStage,
    currentUpload,
    currentAnalysis,
    error,
    setCurrentStage,
    reset
  } = usePitchDeckStore();

  const [progress, setProgress] = useState(0);

  // Auto-progress through stages during analysis
  useEffect(() => {
    if (uploadState === 'analyzing') {
      // Simulate stage transitions
      const stages: AnalysisStage[] = ['analyzing', 'insights'];
      let stageIndex = 0;

      const interval = setInterval(() => {
        if (stageIndex < stages.length) {
          setCurrentStage(stages[stageIndex]);
          stageIndex++;
        }
      }, 1000);

      return () => clearInterval(interval);
    }
  }, [uploadState, setCurrentStage]);

  const handleFileSelect = useCallback(
    async (file: File) => {
      try {
        reset();
        setCurrentStage('uploading');
        usePitchDeckStore.getState().setUploadState('uploading');

        // Upload with progress simulation
        let uploadProgress = 0;
        const progressInterval = setInterval(() => {
          uploadProgress += 10;
          setProgress(Math.min(uploadProgress, 90));
          if (uploadProgress >= 90) clearInterval(progressInterval);
        }, 150);

        const uploadResult = await uploadPitchDeck(file);
        clearInterval(progressInterval);
        setProgress(100);

        usePitchDeckStore.getState().setCurrentUpload(uploadResult);

        // Start analysis
        setCurrentStage('analyzing');
        usePitchDeckStore.getState().setUploadState('analyzing');
        setProgress(0);

        // Analysis progress simulation
        let analysisProgress = 0;
        const analysisInterval = setInterval(() => {
          analysisProgress += 5;
          setProgress(Math.min(analysisProgress, 90));
          if (analysisProgress >= 90) clearInterval(analysisInterval);
        }, 150);

        const result = await analyzePitchDeck(uploadResult.uploadId, file.name);
        clearInterval(analysisInterval);
        setProgress(100);

        usePitchDeckStore.getState().setCurrentAnalysis(result);
        toast.success('Analysis complete!');
      } catch (err) {
        const message = err instanceof Error ? err.message : 'Upload failed';
        usePitchDeckStore.getState().setError(message);
        toast.error(message);
      }
    },
    [reset, setCurrentStage]
  );

  const handleCancel = useCallback(() => {
    reset();
    setProgress(0);
  }, [reset]);

  const handleReset = useCallback(() => {
    reset();
    setProgress(0);
  }, [reset]);

  return (
    <div className="container max-w-5xl mx-auto py-8 px-4">
      {/* Page header */}
      <div className="mb-8">
        <h1 className="text-3xl font-bold mb-2">Pitch Deck Analysis</h1>
        <p className="text-muted-foreground">
          Upload your pitch deck to get AI-powered insights based on VC framework
        </p>
      </div>

      {/* File uploader - shown when idle */}
      {uploadState === 'idle' && !currentAnalysis && (
        <FileUploader onFileSelect={handleFileSelect} />
      )}

      {/* Upload/Analysis progress */}
      {(uploadState === 'uploading' || uploadState === 'analyzing') && currentUpload && (
        <UploadProgress
          filename={currentUpload.filename}
          fileType={currentUpload.fileType}
          progress={progress}
          state={currentStage}
          onCancel={handleCancel}
        />
      )}

      {/* Error state */}
      {uploadState === 'error' && (
        <div className="border border-destructive bg-destructive/10 rounded-lg p-4">
          <p className="text-destructive font-medium">Error</p>
          <p className="text-sm text-destructive/80">{error}</p>
          <button onClick={handleReset} className="mt-4 text-sm text-primary hover:underline">
            Try again
          </button>
        </div>
      )}

      {/* Analysis result */}
      {uploadState === 'completed' && currentAnalysis && (
        <>
          <AnalysisResult analysis={currentAnalysis} />

          {/* Reset button */}
          <div className="mt-8 text-center">
            <button onClick={handleReset} className="text-primary hover:underline text-sm">
              Analyze another pitch deck
            </button>
          </div>
        </>
      )}
    </div>
  );
}
</file>

<file path="src/app/dashboard/pitch-decks/[uuid]/page.tsx">
'use client';

import { APP_URL } from '@/constants/routes';
import { deletePitchDeckByUuid } from '@/services/api';
import { usePitchDeckManagementStore } from '@/stores';
import { ArrowLeft, FileX } from 'lucide-react';
import { useParams, useRouter } from 'next/navigation';
import { useEffect, useState } from 'react';
import { toast } from 'sonner';

import { AuthGuard } from '@/components/auth/auth-guard';
import { PitchDeckDetailHeader } from '@/components/pitch-deck-management';
import { PitchDeckInfo } from '@/components/pitch-deck-management';
import { PitchDeckActions } from '@/components/pitch-deck-management';
import { Button } from '@/components/ui/button';

// Loading skeleton component
const LoadingSkeleton = () => (
  <div className="container max-w-4xl mx-auto py-8 px-4 space-y-6">
    <div className="space-y-2">
      <div className="h-8 w-48 bg-muted animate-pulse rounded" />
      <div className="h-6 w-64 bg-muted animate-pulse rounded" />
    </div>
    <div className="space-y-4">
      <div className="h-32 bg-muted animate-pulse rounded-lg" />
      <div className="h-24 bg-muted animate-pulse rounded-lg" />
    </div>
  </div>
);

// Not found component
const NotFoundState = ({ error }: { error?: string | null }) => (
  <div className="container max-w-4xl mx-auto py-16 px-4 text-center">
    <div className="flex justify-center mb-4">
      <div className="w-16 h-16 rounded-full bg-muted flex items-center justify-center">
        <FileX className="w-8 h-8 text-muted-foreground" />
      </div>
    </div>
    <h2 className="text-2xl font-semibold mb-2">Pitch Deck Not Found</h2>
    <p className="text-muted-foreground mb-6">
      {error ||
        'The pitch deck you are looking for does not exist or you do not have access to it.'}
    </p>
    <Button variant="outline" onClick={() => window.history.back()}>
      <ArrowLeft className="w-4 h-4 mr-2" />
      Go Back
    </Button>
  </div>
);

// Breadcrumb component
const Breadcrumb = ({ title }: { title: string }) => (
  <nav className="flex items-center gap-2 text-sm text-muted-foreground mb-6">
    <button
      onClick={() => window.history.back()}
      className="hover:text-foreground transition-colors"
    >
      Pitch Decks
    </button>
    <span>/</span>
    <span className="text-foreground font-medium truncate max-w-[200px]">{title}</span>
  </nav>
);

// UUID v4 validation regex
const UUID_V4_REGEX = /^[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i;

function PitchDeckDetailContent() {
  const params = useParams();
  const router = useRouter();
  const uuid = params.uuid as string;

  // Validate UUID format before using
  const isValidUuid = UUID_V4_REGEX.test(uuid);
  const [isDeleting, setIsDeleting] = useState(false);

  const { currentDeck, isLoading, error, fetchPitchDeckDetail, removePitchDeck } =
    usePitchDeckManagementStore();

  useEffect(() => {
    if (uuid && isValidUuid) {
      fetchPitchDeckDetail(uuid);
    }
  }, [uuid, isValidUuid, fetchPitchDeckDetail]);

  const handleDelete = async () => {
    if (!uuid || !isValidUuid || !currentDeck) return;

    setIsDeleting(true);
    try {
      // Optimistic remove from store
      removePitchDeck(uuid);

      // Call delete API
      await deletePitchDeckByUuid(uuid);

      toast.success('Pitch deck deleted successfully');

      // Navigate to list page
      router.push(APP_URL.PITCH_DECKS);
    } catch (err) {
      toast.error(err instanceof Error ? err.message : 'Failed to delete pitch deck');
      // Re-fetch on error to restore state
      fetchPitchDeckDetail(uuid);
    } finally {
      setIsDeleting(false);
    }
  };

  // Invalid UUID state
  if (!isValidUuid) {
    return <NotFoundState error="Invalid pitch deck ID format" />;
  }

  // Loading state
  if (isLoading) {
    return <LoadingSkeleton />;
  }

  // Error or not found state
  if (error || !currentDeck) {
    return <NotFoundState error={error} />;
  }

  // Build file info for display
  const files = currentDeck
    ? [
        {
          originalFileName: currentDeck.originalFileName,
          fileSize: currentDeck.fileSize,
          mimeType: currentDeck.mimeType
        }
      ]
    : undefined;

  return (
    <div className="container max-w-4xl mx-auto py-8 px-4 space-y-8">
      {/* Breadcrumb */}
      <Breadcrumb title={currentDeck.title} />

      {/* Header with title, status, dates */}
      <PitchDeckDetailHeader
        title={currentDeck.title}
        status={currentDeck.status}
        createdAt={currentDeck.createdAt}
        updatedAt={currentDeck.updatedAt}
      />

      {/* Info section: description, tags, files */}
      <PitchDeckInfo
        description={currentDeck.description}
        tags={currentDeck.tags}
        files={files}
        status={currentDeck.status}
      />

      {/* Action buttons */}
      <div className="border-t pt-6">
        <PitchDeckActions
          uuid={uuid}
          status={currentDeck.status}
          title={currentDeck.title}
          isDeleting={isDeleting}
          onDelete={handleDelete}
        />
      </div>
    </div>
  );
}

export default function PitchDeckDetailPage() {
  return (
    <AuthGuard>
      <PitchDeckDetailContent />
    </AuthGuard>
  );
}
</file>

<file path="src/app/dashboard/pitch-decks/upload/page.tsx">
'use client';

import { ArrowLeft, Upload } from 'lucide-react';
import Link from 'next/link';
import { useRouter } from 'next/navigation';

import { UploadForm } from '@/components/pitch-deck-management/upload-form';

export default function UploadPitchDeckPage() {
  const router = useRouter();

  const handleSuccess = (_uuid: string) => {
    // Upload successful, navigation handled by form
  };

  const handleCancel = () => {
    router.push('/dashboard/pitch-decks');
  };

  return (
    <div className="container max-w-3xl py-8 px-4">
      {/* Breadcrumb */}
      <div className="flex items-center gap-2 text-sm text-muted-foreground mb-6">
        <Link
          href="/dashboard/pitch-decks"
          className="hover:text-foreground transition-colors flex items-center gap-1"
        >
          <ArrowLeft className="w-4 h-4" />
          Back to Pitch Decks
        </Link>
      </div>

      {/* Page Header */}
      <div className="mb-8">
        <div className="flex items-center gap-3 mb-2">
          <div className="p-2 bg-primary/10 rounded-lg">
            <Upload className="w-6 h-6 text-primary" />
          </div>
          <h1 className="text-2xl font-bold">Upload New Pitch Deck</h1>
        </div>
        <p className="text-muted-foreground">
          Upload your pitch deck and add metadata for better organization and analysis.
        </p>
      </div>

      {/* Upload Form */}
      <div className="bg-card rounded-lg border p-6">
        <UploadForm onSuccess={handleSuccess} onCancel={handleCancel} />
      </div>

      {/* Help Text */}
      <div className="mt-6 p-4 bg-muted/50 rounded-lg border">
        <h3 className="text-sm font-medium mb-2">Upload Guidelines</h3>
        <ul className="text-sm text-muted-foreground space-y-1 list-disc list-inside">
          <li>Supported formats: PDF, PPT, PPTX, DOC, DOCX, TXT</li>
          <li>Maximum file size: 10MB</li>
          <li>Title is required (max 200 characters)</li>
          <li>Description is optional (max 1000 characters)</li>
          <li>You can add up to 10 tags for better organization</li>
        </ul>
      </div>
    </div>
  );
}
</file>

<file path="src/app/dashboard/pitch-decks/page.tsx">
'use client';

import type { PitchDeckStatus } from '@/constants/pitch-deck-status';
import { deletePitchDeckByUuid } from '@/services/api';
import { usePitchDeckManagementStore } from '@/stores';
import { Plus } from 'lucide-react';
import { useRouter } from 'next/navigation';
import { useEffect, useState, useCallback } from 'react';
import { toast } from 'sonner';

import {
  PitchDeckFilter,
  PitchDeckList,
  PitchDeckPagination,
  DeleteConfirmationDialog
} from '@/components/pitch-deck-management';
import { Button } from '@/components/ui/button';

export default function PitchDecksPage() {
  const router = useRouter();
  const {
    pitchDecks,
    total,
    limit,
    offset,
    filters,
    isLoading,
    error,
    fetchPitchDecks,
    removePitchDeck,
    setFilters,
    setPagination
  } = usePitchDeckManagementStore();

  const [deleteDialogOpen, setDeleteDialogOpen] = useState(false);
  const [deckToDelete, setDeckToDelete] = useState<{ uuid: string; title: string } | null>(null);
  const [isDeleting, setIsDeleting] = useState(false);

  // Fetch pitch decks on mount and when filters/pagination change
  useEffect(() => {
    fetchPitchDecks();
  }, [fetchPitchDecks, offset, filters.status]);

  const handleStatusChange = useCallback(
    (status: PitchDeckStatus | 'all') => {
      setPagination(0);
      setFilters({ status: status === 'all' ? undefined : status });
    },
    [setFilters, setPagination]
  );

  const handlePageChange = useCallback(
    (newOffset: number) => {
      setPagination(newOffset);
    },
    [setPagination]
  );

  const handleDeleteClick = useCallback(
    (uuid: string) => {
      const deck = pitchDecks.find((d) => d.uuid === uuid);
      if (deck) {
        setDeckToDelete({ uuid: deck.uuid, title: deck.title });
        setDeleteDialogOpen(true);
      }
    },
    [pitchDecks]
  );

  const handleDeleteConfirm = useCallback(async () => {
    if (!deckToDelete) return;

    setIsDeleting(true);
    removePitchDeck(deckToDelete.uuid);

    try {
      await deletePitchDeckByUuid(deckToDelete.uuid);
      toast.success('Pitch deck deleted successfully');
      setDeleteDialogOpen(false);
      setDeckToDelete(null);
    } catch {
      toast.error('Failed to delete pitch deck');
      fetchPitchDecks();
    } finally {
      setIsDeleting(false);
    }
  }, [deckToDelete, removePitchDeck, fetchPitchDecks]);

  const handleCardClick = useCallback(
    (uuid: string) => {
      router.push(`/dashboard/pitch-decks/${uuid}`);
    },
    [router]
  );

  const handleCreateNew = useCallback(() => {
    router.push('/dashboard/pitch-deck');
  }, [router]);

  return (
    <div className="container mx-auto py-8 px-4 max-w-7xl">
      {/* Header */}
      <div className="flex items-center justify-between mb-8">
        <div>
          <h1 className="text-3xl font-bold text-foreground">Pitch Decks</h1>
          <p className="text-muted-foreground mt-1">Manage and analyze your pitch decks</p>
        </div>
        <Button onClick={handleCreateNew} className="gap-2">
          <Plus className="h-4 w-4" />
          New Deck
        </Button>
      </div>

      {/* Error State */}
      {error && (
        <div className="mb-6 p-4 rounded-lg bg-destructive/10 border border-destructive/20">
          <p className="text-sm text-destructive">{error}</p>
        </div>
      )}

      {/* Filter */}
      <div className="mb-6">
        <PitchDeckFilter
          selectedStatus={filters.status || 'all'}
          onStatusChange={handleStatusChange}
          totalCount={total}
        />
      </div>

      {/* List */}
      <PitchDeckList
        decks={pitchDecks}
        isLoading={isLoading}
        onDelete={handleDeleteClick}
        onClick={handleCardClick}
        onCreateNew={handleCreateNew}
      />

      {/* Pagination */}
      {!isLoading && pitchDecks.length > 0 && (
        <div className="mt-8">
          <PitchDeckPagination
            total={total}
            limit={limit}
            offset={offset}
            onPageChange={handlePageChange}
          />
        </div>
      )}

      {/* Delete Confirmation Dialog */}
      {deckToDelete && (
        <DeleteConfirmationDialog
          open={deleteDialogOpen}
          onOpenChange={setDeleteDialogOpen}
          onConfirm={handleDeleteConfirm}
          deckTitle={deckToDelete.title}
          isDeleting={isDeleting}
        />
      )}
    </div>
  );
}
</file>

<file path="src/app/dashboard/page.tsx">
'use client';

import { APP_URL } from '@/constants/routes';
import { logout } from '@/services/api';
import { useUserStore } from '@/stores';
import { useRouter } from 'next/navigation';
import { toast } from 'sonner';

import { AuthGuard } from '@/components/auth/auth-guard';
import { Button } from '@/components/ui/button';

function DashboardContent() {
  const router = useRouter();
  const user = useUserStore((state) => state.user);
  const clear = useUserStore((state) => state.clear);

  const handleLogout = async () => {
    try {
      await logout();
    } catch {
      console.error('Logout API failed');
    }

    clear();
    toast.success('Logged out successfully');
    router.push(APP_URL.HOME);
  };

  return (
    <div className="min-h-screen bg-gray-50 dark:bg-gray-900">
      <header className="bg-white dark:bg-gray-800 shadow">
        <div className="container mx-auto px-6 py-4 flex justify-between items-center">
          <h1 className="text-xl font-bold text-gray-900 dark:text-white">Dashboard</h1>
          <Button variant="outline" onClick={handleLogout}>
            Logout
          </Button>
        </div>
      </header>

      <main className="container mx-auto px-6 py-8">
        <div className="bg-white dark:bg-gray-800 rounded-lg shadow p-6">
          <h2 className="text-2xl font-semibold mb-4 text-gray-900 dark:text-white">
            Welcome back!
          </h2>

          <div className="space-y-2">
            <p className="text-gray-600 dark:text-gray-400">
              <span className="font-medium">Username:</span> {user?.username}
            </p>
            <p className="text-gray-600 dark:text-gray-400">
              <span className="font-medium">User ID:</span> {user?._id}
            </p>
          </div>

          <div className="mt-8 p-4 bg-blue-50 dark:bg-blue-900/20 rounded-md border border-blue-200 dark:border-blue-800">
            <p className="text-blue-800 dark:text-blue-300">
              This is a basic dashboard placeholder. Add your features here.
            </p>
          </div>
        </div>
      </main>
    </div>
  );
}

export default function DashboardPage() {
  return (
    <AuthGuard>
      <DashboardContent />
    </AuthGuard>
  );
}
</file>

<file path="src/components/auth/auth-guard.tsx">
'use client';

import { APP_URL } from '@/constants/routes';
import { useUserStore } from '@/stores';
import { useRouter } from 'next/navigation';
import { useEffect } from 'react';

interface AuthGuardProps {
  children: React.ReactNode;
}

export function AuthGuard({ children }: AuthGuardProps) {
  const router = useRouter();
  const jwt = useUserStore((state) => state.jwt);

  useEffect(() => {
    if (!jwt) {
      router.push(APP_URL.LOGIN);
    }
  }, [jwt, router]);

  if (!jwt) {
    return null;
  }

  return <>{children}</>;
}
</file>

<file path="src/components/auth/index.ts">
export * from './auth-guard';
</file>

<file path="src/components/pitch-deck/analysis-result.tsx">
'use client';

import type { PitchDeckAnalysisResponse } from '@/types/response/pitch-deck';
import { formatDistanceToNow } from 'date-fns';
import { Clock } from 'lucide-react';

import { SlideUp, StaggerChildren } from '@/components/ui/animated';

import { CategoryGrid } from './category-grid';
import { CompetitiveAnalysisView } from './competitive-analysis';
import { GaugeChart } from './gauge-chart';
import { ImprovementList } from './improvement-list';
import { StrengthList } from './strength-list';

type AnalysisResultProps = {
  analysis: PitchDeckAnalysisResponse;
  className?: string;
};

export const AnalysisResult = ({ analysis, className }: AnalysisResultProps) => {
  const timeAgo = formatDistanceToNow(new Date(analysis.analyzedAt), {
    addSuffix: true
  });

  return (
    <div className={className}>
      <StaggerChildren className="space-y-8">
        {/* Header */}
        <SlideUp>
          <div className="flex items-center justify-between">
            <div>
              <h2 className="text-xl font-bold">{analysis.filename}</h2>
              <p className="text-sm text-muted-foreground flex items-center gap-1">
                <Clock className="w-3 h-3" />
                Analyzed {timeAgo}
              </p>
            </div>
          </div>
        </SlideUp>

        {/* Overall Score Gauge */}
        <SlideUp delay={0.1}>
          <div className="flex justify-center">
            <GaugeChart score={analysis.overallScore} size={240} />
          </div>
        </SlideUp>

        {/* Category Scores */}
        <SlideUp delay={0.2}>
          <div>
            <h3 className="text-lg font-semibold mb-4">Category Breakdown</h3>
            <CategoryGrid categoryScores={analysis.categoryScores} />
          </div>
        </SlideUp>

        {/* Strengths & Improvements */}
        <SlideUp delay={0.3}>
          <div className="grid md:grid-cols-2 gap-6">
            <StrengthList strengths={analysis.strengths} />
            <ImprovementList improvements={analysis.improvements} />
          </div>
        </SlideUp>

        {/* Competitive Analysis */}
        {analysis.competitiveAnalysis && (
          <SlideUp delay={0.4}>
            <CompetitiveAnalysisView analysis={analysis.competitiveAnalysis} />
          </SlideUp>
        )}
      </StaggerChildren>
    </div>
  );
};
</file>

<file path="src/components/pitch-deck/category-card.tsx">
'use client';

import { getScoreBand } from '@/constants/score-bands';
import { VC_CATEGORY_CONFIG } from '@/constants/vc-framework';
import type { VCCategory } from '@/types/response/pitch-deck';
import { cn } from '@/utils';
import { motion } from 'framer-motion';
import { ChevronDown } from 'lucide-react';

type CategoryCardProps = {
  category: VCCategory;
  score: number;
  weight: number;
  details?: string;
  isExpanded?: boolean;
  onToggle?: () => void;
  className?: string;
};

export const CategoryCard = ({
  category,
  score,
  weight,
  details,
  isExpanded = false,
  onToggle,
  className
}: CategoryCardProps) => {
  const config = VC_CATEGORY_CONFIG[category];
  const Icon = config.icon;
  const band = getScoreBand(score);
  const weightPercent = Math.round(weight * 100);

  return (
    <motion.div
      layout
      className={cn(
        'border rounded-lg overflow-hidden transition-colors',
        isExpanded && 'ring-2 ring-primary/20',
        className
      )}
    >
      {/* Card header */}
      <button
        onClick={onToggle}
        className="w-full p-4 text-left hover:bg-muted/50 transition-colors"
      >
        <div className="flex items-start gap-3">
          {/* Icon */}
          <div
            className={cn(
              'w-10 h-10 rounded-lg flex items-center justify-center shrink-0',
              `bg-gradient-to-br ${config.gradientFrom} ${config.gradientTo}`
            )}
          >
            <Icon className="w-5 h-5 text-white" />
          </div>

          {/* Content */}
          <div className="flex-1 min-w-0">
            <div className="flex items-center justify-between gap-2">
              <h3 className="font-semibold text-sm">{config.label}</h3>
              <span className="text-xs px-2 py-0.5 rounded-full bg-muted text-muted-foreground">
                {weightPercent}%
              </span>
            </div>
            <p className="text-xs text-muted-foreground mt-0.5">{config.description}</p>
          </div>

          {/* Score */}
          <div className="text-right shrink-0">
            <p className={cn('text-2xl font-bold tabular-nums', band.textColor)}>{score}</p>
            <p className="text-xs text-muted-foreground">{band.label}</p>
          </div>

          {/* Expand icon */}
          {onToggle && (
            <ChevronDown
              className={cn(
                'w-5 h-5 text-muted-foreground transition-transform shrink-0',
                isExpanded && 'transform rotate-180'
              )}
            />
          )}
        </div>

        {/* Progress bar */}
        <div className="mt-3 h-2 bg-muted rounded-full overflow-hidden">
          <motion.div
            initial={{ width: 0 }}
            animate={{ width: `${score}%` }}
            transition={{ duration: 0.6, ease: 'circOut' }}
            className={cn('h-full', band.bgColor)}
          />
        </div>
      </button>

      {/* Expanded details */}
      {isExpanded && details && (
        <motion.div
          initial={{ height: 0, opacity: 0 }}
          animate={{ height: 'auto', opacity: 1 }}
          exit={{ height: 0, opacity: 0 }}
          className="border-t bg-muted/30 p-4"
        >
          <p className="text-sm text-foreground">{details}</p>
        </motion.div>
      )}
    </motion.div>
  );
};
</file>

<file path="src/components/pitch-deck/category-expansion.tsx">
'use client';

import type { VCCategory } from '@/types/response/pitch-deck';
import { cn } from '@/utils';

// Category color mapping for Tailwind JIT compatibility
const CATEGORY_COLORS: Record<VCCategory, string> = {
  teamAndFounders: 'text-blue-500',
  marketSize: 'text-purple-500',
  productSolution: 'text-green-500',
  traction: 'text-orange-500',
  businessModel: 'text-cyan-500',
  competition: 'text-pink-500',
  financials: 'text-amber-500'
};

type CategoryExpansionProps = {
  category: VCCategory;
  insights?: string[];
  recommendations?: string[];
  className?: string;
};

export const CategoryExpansion = ({
  category,
  insights = [],
  recommendations = [],
  className
}: CategoryExpansionProps) => {
  const bulletColor = CATEGORY_COLORS[category];

  return (
    <div className={cn('p-4 space-y-4', className)}>
      {/* Insights section */}
      {insights.length > 0 && (
        <div>
          <h4 className="text-sm font-semibold mb-2">Key Insights</h4>
          <ul className="space-y-1">
            {insights.map((insight, i) => (
              <li key={i} className="text-sm text-muted-foreground flex gap-2">
                <span className={bulletColor}>•</span>
                {insight}
              </li>
            ))}
          </ul>
        </div>
      )}

      {/* Recommendations section */}
      {recommendations.length > 0 && (
        <div>
          <h4 className="text-sm font-semibold mb-2">Recommendations</h4>
          <ul className="space-y-1">
            {recommendations.map((rec, i) => (
              <li key={i} className="text-sm text-muted-foreground flex gap-2">
                <span className="text-primary">→</span>
                {rec}
              </li>
            ))}
          </ul>
        </div>
      )}
    </div>
  );
};
</file>

<file path="src/components/pitch-deck/category-grid.tsx">
'use client';

import { VC_CATEGORIES, VC_CATEGORY_CONFIG } from '@/constants/vc-framework';
import type { VCCategory, VCCategoryScore } from '@/types/response/pitch-deck';
import { cn } from '@/utils';
import { ArrowUp, ArrowDown } from 'lucide-react';
import { useState } from 'react';

import { Button } from '@/components/ui/button';

import { CategoryCard } from './category-card';

type SortOption = 'score' | 'weight' | 'name';
type SortOrder = 'asc' | 'desc';

type CategoryGridProps = {
  categoryScores: VCCategoryScore;
  className?: string;
};

export const CategoryGrid = ({ categoryScores, className }: CategoryGridProps) => {
  const [expandedCategory, setExpandedCategory] = useState<VCCategory | null>(null);
  const [sortBy, setSortBy] = useState<SortOption>('weight');
  const [sortOrder, setSortOrder] = useState<SortOrder>('desc');

  // Sort categories
  const sortedCategories = [...VC_CATEGORIES].sort((a, b) => {
    let comparison = 0;

    switch (sortBy) {
      case 'score':
        comparison = categoryScores[a].score - categoryScores[b].score;
        break;
      case 'weight':
        comparison = categoryScores[a].weight - categoryScores[b].weight;
        break;
      case 'name':
        comparison = VC_CATEGORY_CONFIG[a].label.localeCompare(VC_CATEGORY_CONFIG[b].label);
        break;
    }

    return sortOrder === 'asc' ? comparison : -comparison;
  });

  const toggleSort = (option: SortOption) => {
    if (sortBy === option) {
      setSortOrder(sortOrder === 'asc' ? 'desc' : 'asc');
    } else {
      setSortBy(option);
      setSortOrder('desc');
    }
  };

  return (
    <div className={cn('space-y-4', className)}>
      {/* Sort controls */}
      <div className="flex gap-2">
        <Button
          variant={sortBy === 'score' ? 'default' : 'outline'}
          size="sm"
          onClick={() => toggleSort('score')}
        >
          Score
          {sortBy === 'score' &&
            (sortOrder === 'asc' ? (
              <ArrowUp className="w-4 h-4 ml-1" />
            ) : (
              <ArrowDown className="w-4 h-4 ml-1" />
            ))}
        </Button>
        <Button
          variant={sortBy === 'weight' ? 'default' : 'outline'}
          size="sm"
          onClick={() => toggleSort('weight')}
        >
          Weight
          {sortBy === 'weight' &&
            (sortOrder === 'asc' ? (
              <ArrowUp className="w-4 h-4 ml-1" />
            ) : (
              <ArrowDown className="w-4 h-4 ml-1" />
            ))}
        </Button>
        <Button
          variant={sortBy === 'name' ? 'default' : 'outline'}
          size="sm"
          onClick={() => toggleSort('name')}
        >
          Name
          {sortBy === 'name' &&
            (sortOrder === 'asc' ? (
              <ArrowUp className="w-4 h-4 ml-1" />
            ) : (
              <ArrowDown className="w-4 h-4 ml-1" />
            ))}
        </Button>
      </div>

      {/* Category cards */}
      <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
        {sortedCategories.map((category) => {
          const { score, weight, details } = categoryScores[category];

          return (
            <CategoryCard
              key={category}
              category={category}
              score={score}
              weight={weight}
              details={details}
              isExpanded={expandedCategory === category}
              onToggle={() => setExpandedCategory(expandedCategory === category ? null : category)}
            />
          );
        })}
      </div>
    </div>
  );
};
</file>

<file path="src/components/pitch-deck/category-scores.tsx">
'use client';

import type { VCCategoryScore } from '@/types/response/pitch-deck';

import { CategoryGrid } from './category-grid';

type CategoryScoresProps = {
  scores: VCCategoryScore;
  className?: string;
};

/**
 * @deprecated Use CategoryGrid for full 7-category display
 * This component maintained for backward compatibility
 */
export const CategoryScoresDisplay = ({ scores, className }: CategoryScoresProps) => {
  return <CategoryGrid categoryScores={scores} className={className} />;
};
</file>

<file path="src/components/pitch-deck/competitive-analysis.tsx">
'use client';

import { CompetitiveAnalysis } from '@/types/response/pitch-deck';
import { cn } from '@/utils';

import { DifferentiatorList } from './differentiator-list';
import { MarketOpportunity } from './market-opportunity';
import { PositioningMap } from './positioning-map';

type CompetitiveAnalysisViewProps = {
  analysis: CompetitiveAnalysis;
  className?: string;
};

export const CompetitiveAnalysisView = ({ analysis, className }: CompetitiveAnalysisViewProps) => {
  if (!analysis) return null;

  return (
    <div className={cn('space-y-6', className)}>
      {/* Positioning Map */}
      <PositioningMap positions={analysis.positioning} />

      {/* Market Opportunity */}
      <MarketOpportunity
        size={analysis.marketOpportunity.size}
        growth={analysis.marketOpportunity.growth}
        trend={analysis.marketOpportunity.trend}
      />

      {/* Differentiators */}
      <DifferentiatorList differentiators={analysis.differentiators} />
    </div>
  );
};
</file>

<file path="src/components/pitch-deck/differentiator-list.tsx">
'use client';

import { Differentiator } from '@/types/response/pitch-deck';
import { cn } from '@/utils';
import { motion } from 'framer-motion';
import { TrendingUp, TrendingDown, Minus } from 'lucide-react';

type DifferentiatorListProps = {
  differentiators: Differentiator[];
  className?: string;
};

export const DifferentiatorList = ({ differentiators, className }: DifferentiatorListProps) => {
  return (
    <div className={cn('space-y-4', className)}>
      <h3 className="text-lg font-semibold">Key Differentiators</h3>

      <div className="space-y-3">
        {differentiators.map((diff, index) => {
          const delta = diff.userScore - diff.competitorAvg;
          const isPositive = delta > 0;
          const isNeutral = delta === 0;

          return (
            <motion.div
              key={diff.id}
              initial={{ opacity: 0, x: -20 }}
              animate={{ opacity: 1, x: 0 }}
              transition={{ delay: index * 0.1 }}
              className="border rounded-lg p-4"
            >
              <div className="flex items-center justify-between mb-2">
                <h4 className="font-medium text-sm">{diff.aspect}</h4>
                <div className="flex items-center gap-1 text-xs">
                  {isPositive ? (
                    <TrendingUp className="w-4 h-4 text-green-500" />
                  ) : isNeutral ? (
                    <Minus className="w-4 h-4 text-muted-foreground" />
                  ) : (
                    <TrendingDown className="w-4 h-4 text-red-500" />
                  )}
                  <span
                    className={cn(
                      'font-medium tabular-nums',
                      isPositive
                        ? 'text-green-600 dark:text-green-400'
                        : isNeutral
                          ? 'text-muted-foreground'
                          : 'text-red-600 dark:text-red-400'
                    )}
                  >
                    {isPositive ? '+' : ''}
                    {delta}
                  </span>
                </div>
              </div>

              <p className="text-xs text-muted-foreground mb-3">{diff.description}</p>

              {/* Comparison bars */}
              <div className="space-y-2">
                <div>
                  <div className="flex justify-between text-xs mb-1">
                    <span className="text-muted-foreground">You</span>
                    <span className="font-medium">{diff.userScore}</span>
                  </div>
                  <div className="h-2 bg-muted rounded-full overflow-hidden">
                    <motion.div
                      initial={{ width: 0 }}
                      animate={{ width: `${diff.userScore}%` }}
                      transition={{ duration: 0.6, delay: index * 0.1 }}
                      className="h-full bg-primary"
                    />
                  </div>
                </div>
                <div>
                  <div className="flex justify-between text-xs mb-1">
                    <span className="text-muted-foreground">Competitor Avg</span>
                    <span className="font-medium">{diff.competitorAvg}</span>
                  </div>
                  <div className="h-2 bg-muted rounded-full overflow-hidden">
                    <motion.div
                      initial={{ width: 0 }}
                      animate={{ width: `${diff.competitorAvg}%` }}
                      transition={{ duration: 0.6, delay: index * 0.1 }}
                      className="h-full bg-muted-foreground/40"
                    />
                  </div>
                </div>
              </div>
            </motion.div>
          );
        })}
      </div>
    </div>
  );
};
</file>

<file path="src/components/pitch-deck/file-preview-card.tsx">
'use client';

import { FILE_TYPE_LABELS, formatFileSize } from '@/constants/file-types';
import { cn } from '@/utils';
import { FileText, Trash2 } from 'lucide-react';

import { Button } from '@/components/ui/button';

type FilePreviewCardProps = {
  filename: string;
  fileType: string;
  fileSize: number;
  onRemove?: () => void;
  disabled?: boolean;
  className?: string;
};

export const FilePreviewCard = ({
  filename,
  fileType,
  fileSize,
  onRemove,
  disabled,
  className
}: FilePreviewCardProps) => {
  return (
    <div className={cn('border rounded-lg p-4', className)}>
      <div className="flex items-center gap-3">
        <div className="w-12 h-12 rounded-md bg-primary/10 flex items-center justify-center">
          <FileText className="w-6 h-6 text-primary" />
        </div>

        <div className="flex-1 min-w-0">
          <p className="text-sm font-medium truncate">{filename}</p>
          <p className="text-xs text-muted-foreground">
            {FILE_TYPE_LABELS[fileType] || fileType} • {formatFileSize(fileSize)}
          </p>
        </div>

        {onRemove && !disabled && (
          <Button
            type="button"
            variant="ghost"
            size="icon"
            onClick={onRemove}
            className="shrink-0 text-destructive hover:text-destructive"
          >
            <Trash2 className="w-4 h-4" />
          </Button>
        )}
      </div>
    </div>
  );
};
</file>

<file path="src/components/pitch-deck/file-uploader.tsx">
'use client';

import { ALLOWED_PITCH_DECK_TYPES, MAX_PITCH_DECK_SIZE } from '@/constants/file-types';
import { validatePitchDeckFile } from '@/constants/file-types';
import { cn } from '@/utils';
import { Upload } from 'lucide-react';
import { useCallback, useState } from 'react';

import { Button } from '@/components/ui/button';

type FileUploaderProps = {
  onFileSelect: (file: File) => void;
  disabled?: boolean;
  className?: string;
};

export const FileUploader = ({ onFileSelect, disabled, className }: FileUploaderProps) => {
  const [isDragging, setIsDragging] = useState(false);
  const [error, setError] = useState<string | null>(null);

  const validateAndSelect = useCallback(
    (file: File) => {
      const validation = validatePitchDeckFile(file);
      if (!validation.valid) {
        setError(validation.error || 'Invalid file');

        return;
      }
      setError(null);
      onFileSelect(file);
    },
    [onFileSelect]
  );

  const handleDragOver = useCallback((e: React.DragEvent) => {
    e.preventDefault();
    setIsDragging(true);
  }, []);

  const handleDragLeave = useCallback((e: React.DragEvent) => {
    e.preventDefault();
    setIsDragging(false);
  }, []);

  const handleDrop = useCallback(
    (e: React.DragEvent) => {
      e.preventDefault();
      setIsDragging(false);

      const file = e.dataTransfer.files[0];
      if (file) {
        validateAndSelect(file);
      }
    },
    [validateAndSelect]
  );

  const handleFileInput = useCallback(
    (e: React.ChangeEvent<HTMLInputElement>) => {
      const file = e.target.files?.[0];
      if (file) {
        validateAndSelect(file);
      }
    },
    [validateAndSelect]
  );

  return (
    <div className={cn('w-full', className)}>
      <div
        onDragOver={handleDragOver}
        onDragLeave={handleDragLeave}
        onDrop={handleDrop}
        className={cn(
          'relative border-2 border-dashed rounded-lg p-8 text-center transition-colors',
          isDragging
            ? 'border-primary bg-primary/5'
            : 'border-muted-foreground/25 hover:border-primary/50',
          disabled && 'opacity-50 cursor-not-allowed'
        )}
      >
        <input
          type="file"
          accept={ALLOWED_PITCH_DECK_TYPES.join(',')}
          onChange={handleFileInput}
          disabled={disabled}
          className="absolute inset-0 w-full h-full opacity-0 cursor-pointer disabled:cursor-not-allowed"
        />

        <Upload className="w-12 h-12 mx-auto mb-4 text-muted-foreground" />

        <p className="text-sm font-medium mb-1">Drop your pitch deck here, or click to browse</p>

        <p className="text-xs text-muted-foreground mb-4">
          Supported formats: PDF, PPT, PPTX, DOC, DOCX, TXT (max {MAX_PITCH_DECK_SIZE / 1024 / 1024}
          MB)
        </p>

        <Button type="button" variant="outline" size="sm" disabled={disabled}>
          Select File
        </Button>
      </div>

      {error && <p className="mt-2 text-sm text-destructive">{error}</p>}
    </div>
  );
};
</file>

<file path="src/components/pitch-deck/gauge-chart.tsx">
'use client';

import { SCORE_BANDS } from '@/constants/score-bands';
import { cn } from '@/utils';
import { motion } from 'framer-motion';
import { useEffect, useState } from 'react';

type GaugeChartProps = {
  score: number;
  size?: number;
  strokeWidth?: number;
  showLabel?: boolean;
  className?: string;
};

export const GaugeChart = ({
  score,
  size = 200,
  strokeWidth = 12,
  showLabel = true,
  className
}: GaugeChartProps) => {
  const [animatedScore, setAnimatedScore] = useState(0);
  const band = SCORE_BANDS.find((b) => score >= b.min && score <= b.max) || SCORE_BANDS[3];

  useEffect(() => {
    const duration = 1000;
    const steps = 60;
    const increment = score / steps;
    let current = 0;

    const timer = setInterval(() => {
      current += increment;
      if (current >= score) {
        setAnimatedScore(score);
        clearInterval(timer);
      } else {
        setAnimatedScore(Math.round(current));
      }
    }, duration / steps);

    return () => clearInterval(timer);
  }, [score]);

  const center = size / 2;
  const radius = (size - strokeWidth) / 2;
  const circumference = 2 * Math.PI * radius;
  const strokeDasharray = circumference;
  const strokeDashoffset = circumference - (score / 100) * circumference;

  return (
    <div className={cn('relative', className)} style={{ width: size, height: size }}>
      <svg width={size} height={size} className="transform -rotate-90">
        <circle
          cx={center}
          cy={center}
          r={radius}
          fill="none"
          stroke="currentColor"
          strokeWidth={strokeWidth}
          className="text-muted opacity-20"
        />

        {SCORE_BANDS.map((bandInfo, i) => {
          const bandStart = (bandInfo.min / 100) * circumference;
          const bandLength = ((bandInfo.max - bandInfo.min + 1) / 100) * circumference;

          return (
            <circle
              key={i}
              cx={center}
              cy={center}
              r={radius}
              fill="none"
              stroke="currentColor"
              strokeWidth={strokeWidth}
              strokeDasharray={`${bandLength} ${circumference}`}
              strokeDashoffset={-bandStart}
              className={cn(bandInfo.borderColor, 'opacity-30')}
            />
          );
        }).reverse()}

        <motion.circle
          cx={center}
          cy={center}
          r={radius}
          fill="none"
          stroke="currentColor"
          strokeWidth={strokeWidth}
          strokeDasharray={strokeDasharray}
          initial={{ strokeDashoffset: circumference }}
          animate={{ strokeDashoffset }}
          transition={{ duration: 1, ease: 'circOut' }}
          className={cn(band.textColor, 'drop-shadow-lg')}
          strokeLinecap="round"
        />
      </svg>

      <div className="absolute inset-0 flex flex-col items-center justify-center">
        <motion.span
          key={animatedScore}
          initial={{ scale: 0.8, opacity: 0 }}
          animate={{ scale: 1, opacity: 1 }}
          className="text-5xl font-bold tabular-nums"
        >
          {animatedScore}
        </motion.span>
        {showLabel && (
          <span className={cn('text-sm font-medium mt-1', band.textColor)}>{band.label}</span>
        )}
      </div>
    </div>
  );
};
</file>

<file path="src/components/pitch-deck/improvement-card.tsx">
'use client';

import { SEVERITY_CONFIG } from '@/constants/indicators';
import { ImprovementItem } from '@/types/response/pitch-deck';
import { cn } from '@/utils';
import { motion } from 'framer-motion';
import { AlertTriangle, CheckCircle2 } from 'lucide-react';
import { useState } from 'react';

type ImprovementCardProps = {
  improvement: ImprovementItem;
  className?: string;
};

export const ImprovementCard = ({ improvement, className }: ImprovementCardProps) => {
  const [isExpanded, setIsExpanded] = useState(false);
  const severityConfig = SEVERITY_CONFIG[improvement.severity];

  return (
    <motion.div
      layout
      className={cn(
        'border rounded-lg overflow-hidden transition-colors',
        improvement.severity === 'high' && 'border-red-200 dark:border-red-800',
        improvement.severity === 'medium' && 'border-amber-200 dark:border-amber-800',
        improvement.severity === 'low' && 'border-gray-200 dark:border-gray-800',
        isExpanded && 'ring-2 ring-primary/20',
        className
      )}
    >
      <button
        onClick={() => setIsExpanded(!isExpanded)}
        className="w-full p-4 text-left hover:bg-muted/50 transition-colors"
      >
        <div className="flex items-start gap-3">
          {/* Priority indicator */}
          <div
            className={cn(
              'w-10 h-10 rounded-lg flex items-center justify-center shrink-0',
              improvement.severity === 'high' && 'bg-red-100 dark:bg-red-900/30',
              improvement.severity === 'medium' && 'bg-amber-100 dark:bg-amber-900/30',
              improvement.severity === 'low' && 'bg-gray-100 dark:bg-gray-900/30'
            )}
          >
            <AlertTriangle
              className={cn(
                'w-5 h-5',
                improvement.severity === 'high' && 'text-red-600 dark:text-red-400',
                improvement.severity === 'medium' && 'text-amber-600 dark:text-amber-400',
                improvement.severity === 'low' && 'text-gray-600 dark:text-gray-400'
              )}
            />
          </div>

          {/* Content */}
          <div className="flex-1 min-w-0">
            <div className="flex items-center gap-2 mb-1 flex-wrap">
              <h4 className="font-semibold text-sm">{improvement.title}</h4>
              <span
                className={cn(
                  'text-xs px-2 py-0.5 rounded-full',
                  severityConfig.bgColor,
                  severityConfig.color
                )}
              >
                {severityConfig.label}
              </span>
              <span
                className={cn('text-xs px-2 py-0.5 rounded-full bg-muted text-muted-foreground')}
              >
                Priority #{improvement.priority}
              </span>
            </div>
            <p className="text-sm text-muted-foreground line-clamp-2">{improvement.description}</p>
          </div>
        </div>
      </button>

      {/* Expanded recommendation */}
      {isExpanded && (
        <motion.div
          initial={{ height: 0, opacity: 0 }}
          animate={{ height: 'auto', opacity: 1 }}
          exit={{ height: 0, opacity: 0 }}
          className="border-t bg-muted/30 p-4"
        >
          <div className="flex items-start gap-2">
            <CheckCircle2 className="w-5 h-5 text-primary shrink-0 mt-0.5" />
            <div>
              <h5 className="text-sm font-semibold mb-1">Recommended Action</h5>
              <p className="text-sm text-foreground">{improvement.recommendation}</p>
            </div>
          </div>
        </motion.div>
      )}
    </motion.div>
  );
};
</file>

<file path="src/components/pitch-deck/improvement-list.tsx">
'use client';

import { ImprovementItem } from '@/types/response/pitch-deck';
import { cn } from '@/utils';
import { AlertTriangle } from 'lucide-react';

import { StaggerChildren } from '@/components/ui/animated';

import { ImprovementCard } from './improvement-card';

type ImprovementListProps = {
  improvements: ImprovementItem[];
  className?: string;
};

export const ImprovementList = ({ improvements, className }: ImprovementListProps) => {
  if (improvements.length === 0) {
    return (
      <div className={cn('text-center py-8 text-muted-foreground', className)}>
        <AlertTriangle className="w-12 h-12 mx-auto mb-2 opacity-50" />
        <p>No areas for improvement</p>
      </div>
    );
  }

  // Sort by priority
  const sorted = [...improvements].sort((a, b) => a.priority - b.priority);

  return (
    <div className={className}>
      <h3 className="text-lg font-semibold mb-4 flex items-center gap-2">
        <AlertTriangle className="w-5 h-5 text-amber-500" />
        Areas for Improvement ({sorted.length})
      </h3>
      <StaggerChildren className="space-y-3">
        {sorted.map((improvement) => (
          <ImprovementCard key={improvement.id} improvement={improvement} />
        ))}
      </StaggerChildren>
    </div>
  );
};
</file>

<file path="src/components/pitch-deck/index.ts">
export { FileUploader } from './file-uploader';
export { UploadProgress } from './upload-progress';
export { FilePreviewCard } from './file-preview-card';
export { ScoreCard } from './score-card';
export { CategoryGrid } from './category-grid';
export { CategoryCard } from './category-card';
export { CategoryExpansion } from './category-expansion';
export { CategoryScoresDisplay } from './category-scores';
export { StrengthCard } from './strength-card';
export { StrengthList } from './strength-list';
export { ImprovementCard } from './improvement-card';
export { ImprovementList } from './improvement-list';
export { RecommendationCard } from './recommendation-card';
export { AnalysisResult } from './analysis-result';
export { PositioningMap } from './positioning-map';
export { DifferentiatorList } from './differentiator-list';
export { MarketOpportunity } from './market-opportunity';
export { CompetitiveAnalysisView } from './competitive-analysis';
export { GaugeChart } from './gauge-chart';
export { StageIndicator } from './stage-indicator';
</file>

<file path="src/components/pitch-deck/market-opportunity.tsx">
'use client';

import { cn } from '@/utils';
import { motion } from 'framer-motion';
import { TrendingUp, TrendingDown, Minus } from 'lucide-react';

type MarketOpportunityProps = {
  size: string;
  growth: string;
  trend: 'rising' | 'stable' | 'declining';
  className?: string;
};

export const MarketOpportunity = ({ size, growth, trend, className }: MarketOpportunityProps) => {
  const trendConfig = {
    rising: { icon: TrendingUp, color: 'text-green-500', label: 'Growing' },
    stable: { icon: Minus, color: 'text-blue-500', label: 'Stable' },
    declining: { icon: TrendingDown, color: 'text-red-500', label: 'Declining' }
  };

  const config = trendConfig[trend];
  const Icon = config.icon;

  return (
    <div
      className={cn(
        'border rounded-lg p-4 bg-gradient-to-br from-primary/5 to-primary/10',
        className
      )}
    >
      <h3 className="text-lg font-semibold mb-4">Market Opportunity</h3>

      <div className="grid grid-cols-3 gap-4">
        {/* Market size */}
        <motion.div
          initial={{ opacity: 0, y: 10 }}
          animate={{ opacity: 1, y: 0 }}
          className="text-center"
        >
          <p className="text-2xl font-bold">{size}</p>
          <p className="text-xs text-muted-foreground mt-1">Market Size</p>
        </motion.div>

        {/* Growth rate */}
        <motion.div
          initial={{ opacity: 0, y: 10 }}
          animate={{ opacity: 1, y: 0 }}
          transition={{ delay: 0.1 }}
          className="text-center"
        >
          <p className="text-2xl font-bold text-primary">{growth}</p>
          <p className="text-xs text-muted-foreground mt-1">CAGR</p>
        </motion.div>

        {/* Trend */}
        <motion.div
          initial={{ opacity: 0, y: 10 }}
          animate={{ opacity: 1, y: 0 }}
          transition={{ delay: 0.2 }}
          className="text-center"
        >
          <Icon className={cn('w-8 h-8 mx-auto', config.color)} />
          <p className={cn('text-xs font-medium mt-1', config.color)}>{config.label}</p>
        </motion.div>
      </div>
    </div>
  );
};
</file>

<file path="src/components/pitch-deck/positioning-map.tsx">
'use client';

import { CompetitivePosition } from '@/types/response/pitch-deck';
import { cn } from '@/utils';
import { motion } from 'framer-motion';
import { useState } from 'react';

type PositioningMapProps = {
  positions: CompetitivePosition[];
  className?: string;
};

export const PositioningMap = ({ positions, className }: PositioningMapProps) => {
  const [hoveredId, setHoveredId] = useState<string | null>(null);

  // SVG dimensions
  const width = 400;
  const height = 300;
  const padding = 40;
  const chartWidth = width - padding * 2;
  const chartHeight = height - padding * 2;

  return (
    <div className={cn('w-full', className)}>
      <h3 className="text-lg font-semibold mb-4">Competitive Positioning</h3>

      <div className="relative" style={{ width, height }}>
        <svg width={width} height={height} className="w-full h-auto">
          {/* Grid lines */}
          {[0, 25, 50, 75, 100].map((value) => (
            <g key={value}>
              {/* Vertical */}
              <line
                x1={padding + (value / 100) * chartWidth}
                y1={padding}
                x2={padding + (value / 100) * chartWidth}
                y2={height - padding}
                stroke="currentColor"
                className="text-muted-foreground/20"
                strokeWidth={1}
              />
              {/* Horizontal */}
              <line
                x1={padding}
                y1={padding + ((100 - value) / 100) * chartHeight}
                x2={width - padding}
                y2={padding + ((100 - value) / 100) * chartHeight}
                stroke="currentColor"
                className="text-muted-foreground/20"
                strokeWidth={1}
              />
            </g>
          ))}

          {/* Axis labels */}
          <text
            x={width / 2}
            y={height - 5}
            textAnchor="middle"
            className="text-xs fill-muted-foreground"
          >
            Market Size →
          </text>
          <text
            x={10}
            y={height / 2}
            textAnchor="middle"
            transform={`rotate(-90, 10, ${height / 2})`}
            className="text-xs fill-muted-foreground"
          >
            ← Differentiation →
          </text>

          {/* Position points */}
          {positions.map((position) => {
            const x = padding + (position.x / 100) * chartWidth;
            const y = padding + ((100 - position.y) / 100) * chartHeight;
            const isHovered = hoveredId === position.id;
            const isUser = position.isUser;

            return (
              <g key={position.id}>
                {/* Outer ring for user */}
                {isUser && (
                  <circle
                    cx={x}
                    cy={y}
                    r={isHovered ? 16 : 12}
                    fill="none"
                    stroke="currentColor"
                    className="text-primary/30"
                    strokeWidth={2}
                  />
                )}

                {/* Main point */}
                <motion.circle
                  cx={x}
                  cy={y}
                  r={isHovered ? 10 : 6}
                  fill={isUser ? 'hsl(var(--primary))' : 'currentColor'}
                  className={isUser ? '' : 'text-muted-foreground/60'}
                  initial={{ scale: 0 }}
                  animate={{ scale: 1 }}
                  whileHover={{ scale: 1.2 }}
                  onMouseEnter={() => setHoveredId(position.id)}
                  onMouseLeave={() => setHoveredId(null)}
                />

                {/* Tooltip */}
                {isHovered && (
                  <motion.g initial={{ opacity: 0, y: 10 }} animate={{ opacity: 1, y: 0 }}>
                    <rect
                      x={x - 40}
                      y={y - 35}
                      width={80}
                      height={24}
                      rx={4}
                      fill="currentColor"
                      className="fill-foreground"
                    />
                    <text
                      x={x}
                      y={y - 19}
                      textAnchor="middle"
                      className="text-xs fill-background font-medium"
                    >
                      {position.name}
                    </text>
                  </motion.g>
                )}
              </g>
            );
          })}
        </svg>

        {/* Legend */}
        <div className="absolute bottom-2 right-2 flex items-center gap-3 text-xs">
          <div className="flex items-center gap-1">
            <div className="w-3 h-3 rounded-full bg-primary" />
            <span className="text-muted-foreground">You</span>
          </div>
          <div className="flex items-center gap-1">
            <div className="w-3 h-3 rounded-full bg-muted-foreground/60" />
            <span className="text-muted-foreground">Competitors</span>
          </div>
        </div>
      </div>
    </div>
  );
};
</file>

<file path="src/components/pitch-deck/recommendation-card.tsx">
'use client';

import { cn } from '@/utils';
import { Lightbulb } from 'lucide-react';

type RecommendationCardProps = {
  recommendations: string[];
  className?: string;
};

export const RecommendationCard = ({ recommendations, className }: RecommendationCardProps) => {
  return (
    <div className={cn('border rounded-lg p-4 bg-primary/5', className)}>
      <div className="flex items-center gap-2 mb-3">
        <Lightbulb className="w-5 h-5 text-primary" />
        <h3 className="font-semibold">Recommendations</h3>
      </div>
      <ul className="space-y-2">
        {recommendations.map((recommendation, index) => (
          <li key={index} className="text-sm flex gap-2">
            <span className="text-primary font-semibold">{index + 1}.</span>
            <span>{recommendation}</span>
          </li>
        ))}
      </ul>
    </div>
  );
};
</file>

<file path="src/components/pitch-deck/score-card.tsx">
'use client';

import { getScoreColor } from '@/constants/score-bands';
import { cn } from '@/utils';
import { getScoreGrade } from '@/utils/mock-analysis';

type ScoreCardProps = {
  score: number;
  label: string;
  size?: 'default' | 'large';
  showGrade?: boolean;
  className?: string;
};

export const ScoreCard = ({
  score,
  label,
  size = 'default',
  showGrade = true,
  className
}: ScoreCardProps) => {
  const sizeClasses = {
    default: 'w-24 h-24 text-2xl',
    large: 'w-32 h-32 text-4xl'
  };

  return (
    <div className={cn('flex flex-col items-center', className)}>
      <div
        className={cn(
          'rounded-full border-4 flex items-center justify-center font-bold',
          sizeClasses[size],
          getScoreColor(score),
          score >= 80
            ? 'border-green-200 bg-green-50 dark:border-green-800 dark:bg-green-950'
            : score >= 60
              ? 'border-amber-200 bg-amber-50 dark:border-amber-800 dark:bg-amber-950'
              : 'border-red-200 bg-red-50 dark:border-red-800 dark:bg-red-950'
        )}
      >
        {score}
      </div>
      <p className="text-sm font-medium mt-2">{label}</p>
      {showGrade && (
        <span
          className={cn(
            'text-xs font-semibold px-2 py-0.5 rounded-full mt-1',
            getScoreColor(score)
          )}
        >
          Grade: {getScoreGrade(score)}
        </span>
      )}
    </div>
  );
};
</file>

<file path="src/components/pitch-deck/stage-indicator.tsx">
'use client';

import type { AnalysisStage } from '@/stores';
import { cn } from '@/utils';
import { motion } from 'framer-motion';
import { Check, Loader2 } from 'lucide-react';

type StageConfig = {
  id: AnalysisStage;
  label: string;
  description: string;
};

const STAGES: StageConfig[] = [
  { id: 'uploading', label: 'Uploading', description: 'Transferring your pitch deck' },
  { id: 'analyzing', label: 'Analyzing', description: 'Processing content with AI' },
  { id: 'insights', label: 'Generating Insights', description: 'Creating recommendations' },
  { id: 'completed', label: 'Complete', description: 'Analysis ready' }
];

type StageIndicatorProps = {
  currentStage: AnalysisStage;
  progress?: number;
  className?: string;
};

export const StageIndicator = ({ currentStage, progress = 0, className }: StageIndicatorProps) => {
  // Only show stages when in an active state
  const isActiveStage =
    currentStage === 'uploading' ||
    currentStage === 'analyzing' ||
    currentStage === 'insights' ||
    currentStage === 'completed';
  if (!isActiveStage) return null;

  const currentStageIndex = STAGES.findIndex((s) => s.id === currentStage);

  return (
    <div className={cn('w-full relative', className)}>
      <div className="flex items-center justify-between">
        {STAGES.map((stage, index) => {
          const isCompleted = index < currentStageIndex;
          const isCurrent = index === currentStageIndex;
          const isPending = index > currentStageIndex;

          return (
            <div key={stage.id} className="flex flex-col items-center flex-1">
              <motion.div
                initial={{ scale: 0.8 }}
                animate={{ scale: 1 }}
                className={cn(
                  'relative w-12 h-12 rounded-full flex items-center justify-center border-2 transition-colors',
                  isCompleted && 'bg-primary border-primary text-primary-foreground',
                  isCurrent && 'bg-primary/10 border-primary text-primary',
                  isPending && 'bg-muted border-muted-foreground/30 text-muted-foreground'
                )}
              >
                {isCompleted && <Check className="w-5 h-5" />}
                {isCurrent && <Loader2 className="w-5 h-5 animate-spin" />}
                {isPending && <span className="text-sm font-medium">{index + 1}</span>}

                {isCurrent && progress > 0 && (
                  <svg className="absolute inset-0 -rotate-90" viewBox="0 0 48 48">
                    <circle
                      cx="24"
                      cy="24"
                      r="20"
                      fill="none"
                      stroke="currentColor"
                      strokeWidth="2"
                      className="text-primary/20"
                    />
                    <motion.circle
                      cx="24"
                      cy="24"
                      r="20"
                      fill="none"
                      stroke="currentColor"
                      strokeWidth="2"
                      strokeDasharray={125.6}
                      strokeDashoffset={125.6 - (progress / 100) * 125.6}
                      className="text-primary"
                      strokeLinecap="round"
                      initial={{ strokeDashoffset: 125.6 }}
                      animate={{ strokeDashoffset: 125.6 - (progress / 100) * 125.6 }}
                    />
                  </svg>
                )}
              </motion.div>

              <div className="mt-3 text-center">
                <p
                  className={cn(
                    'text-sm font-medium',
                    isCompleted || isCurrent ? 'text-foreground' : 'text-muted-foreground'
                  )}
                >
                  {stage.label}
                </p>
                <p className="text-xs text-muted-foreground mt-0.5">{stage.description}</p>
              </div>
            </div>
          );
        })}
      </div>

      <div className="absolute top-6 left-0 right-0 flex px-16 pointer-events-none">
        {STAGES.slice(0, -1).map((_, index) => (
          <motion.div
            key={index}
            className="h-0.5 flex-1 mx-1 bg-muted"
            initial={{ scaleX: 0 }}
            animate={{ scaleX: index < currentStageIndex ? 1 : 0 }}
            transition={{ delay: index * 0.1 }}
            style={{ originX: 0 }}
          />
        ))}
      </div>
    </div>
  );
};
</file>

<file path="src/components/pitch-deck/strength-card.tsx">
'use client';

import { IMPACT_CONFIG } from '@/constants/indicators';
import { VC_CATEGORY_CONFIG } from '@/constants/vc-framework';
import { StrengthItem } from '@/types/response/pitch-deck';
import { cn } from '@/utils';
import { motion } from 'framer-motion';
import { Quote } from 'lucide-react';
import { useState } from 'react';

type StrengthCardProps = {
  strength: StrengthItem;
  className?: string;
};

export const StrengthCard = ({ strength, className }: StrengthCardProps) => {
  const [isExpanded, setIsExpanded] = useState(false);
  const categoryConfig = VC_CATEGORY_CONFIG[strength.category];
  const Icon = categoryConfig.icon;
  const impactConfig = IMPACT_CONFIG[strength.impact];

  return (
    <motion.div
      layout
      className={cn(
        'border rounded-lg overflow-hidden transition-colors',
        isExpanded && 'ring-2 ring-green-500/20',
        className
      )}
    >
      <button
        onClick={() => setIsExpanded(!isExpanded)}
        className="w-full p-4 text-left hover:bg-muted/50 transition-colors"
      >
        <div className="flex items-start gap-3">
          {/* Category icon */}
          <div
            className={cn(
              'w-10 h-10 rounded-lg flex items-center justify-center shrink-0',
              `bg-gradient-to-br ${categoryConfig.gradientFrom} ${categoryConfig.gradientTo}`
            )}
          >
            <Icon className="w-5 h-5 text-white" />
          </div>

          {/* Content */}
          <div className="flex-1 min-w-0">
            <div className="flex items-center gap-2 mb-1">
              <h4 className="font-semibold text-sm">{strength.title}</h4>
              <span
                className={cn(
                  'text-xs px-2 py-0.5 rounded-full',
                  impactConfig.bgColor,
                  impactConfig.color
                )}
              >
                {impactConfig.icon} {impactConfig.label}
              </span>
            </div>
            <p className="text-sm text-muted-foreground line-clamp-2">{strength.description}</p>
          </div>
        </div>

        {/* Evidence count indicator */}
        {strength.evidence.length > 0 && (
          <div className="mt-2 flex items-center gap-1 text-xs text-muted-foreground">
            <Quote className="w-3 h-3" />
            <span>
              {strength.evidence.length} evidence source{strength.evidence.length > 1 ? 's' : ''}
            </span>
          </div>
        )}
      </button>

      {/* Expanded evidence */}
      {isExpanded && strength.evidence.length > 0 && (
        <motion.div
          initial={{ height: 0, opacity: 0 }}
          animate={{ height: 'auto', opacity: 1 }}
          exit={{ height: 0, opacity: 0 }}
          className="border-t bg-muted/30 p-4 space-y-2"
        >
          {strength.evidence.map((quote, i) => (
            <div
              key={i}
              className={cn('p-3 rounded-lg border-l-4', `border-${categoryConfig.color}-500`)}
            >
              <p className="text-sm italic text-foreground">&ldquo;{quote.text}&rdquo;</p>
              <div className="flex items-center gap-2 mt-1">
                <span className="text-xs text-muted-foreground">{categoryConfig.label}</span>
                {quote.slide && (
                  <>
                    <span className="text-muted-foreground">•</span>
                    <span className="text-xs text-muted-foreground">Slide {quote.slide}</span>
                  </>
                )}
              </div>
            </div>
          ))}
        </motion.div>
      )}
    </motion.div>
  );
};
</file>

<file path="src/components/pitch-deck/strength-list.tsx">
'use client';

import { StrengthItem } from '@/types/response/pitch-deck';
import { cn } from '@/utils';
import { TrendingUp } from 'lucide-react';

import { StaggerChildren } from '@/components/ui/animated';

import { StrengthCard } from './strength-card';

type StrengthListProps = {
  strengths: StrengthItem[];
  className?: string;
};

export const StrengthList = ({ strengths, className }: StrengthListProps) => {
  if (strengths.length === 0) {
    return (
      <div className={cn('text-center py-8 text-muted-foreground', className)}>
        <TrendingUp className="w-12 h-12 mx-auto mb-2 opacity-50" />
        <p>No strengths identified</p>
      </div>
    );
  }

  return (
    <div className={className}>
      <h3 className="text-lg font-semibold mb-4 flex items-center gap-2">
        <TrendingUp className="w-5 h-5 text-green-500" />
        Key Strengths ({strengths.length})
      </h3>
      <StaggerChildren className="space-y-3">
        {strengths.map((strength) => (
          <StrengthCard key={strength.id} strength={strength} />
        ))}
      </StaggerChildren>
    </div>
  );
};
</file>

<file path="src/components/pitch-deck/upload-progress.tsx">
'use client';

import { FILE_TYPE_LABELS } from '@/constants/file-types';
import type { AnalysisStage } from '@/stores';
import { cn } from '@/utils';
import { FileText, X } from 'lucide-react';

import { Button } from '@/components/ui/button';

import { StageIndicator } from './stage-indicator';

type UploadProgressProps = {
  filename: string;
  fileType: string;
  progress?: number;
  state: AnalysisStage;
  onCancel?: () => void;
  className?: string;
};

export const UploadProgress = ({
  filename,
  fileType,
  progress = 0,
  state,
  onCancel,
  className
}: UploadProgressProps) => {
  const getLabel = () => {
    switch (state) {
      case 'uploading':
        return 'Uploading...';
      case 'analyzing':
        return 'Analyzing pitch deck...';
      case 'insights':
        return 'Generating insights...';
      case 'completed':
        return 'Complete';
    }
  };

  return (
    <div className={cn('border rounded-lg p-6 space-y-6', className)}>
      <div className="flex items-center gap-3">
        <div className="w-10 h-10 rounded-md bg-primary/10 flex items-center justify-center">
          <FileText className="w-5 h-5 text-primary" />
        </div>
        <div className="flex-1 min-w-0">
          <p className="text-sm font-medium truncate">{filename}</p>
          <p className="text-xs text-muted-foreground">
            {FILE_TYPE_LABELS[fileType] || fileType} • {getLabel()}
          </p>
        </div>
        {onCancel && state !== 'completed' && (
          <Button type="button" variant="ghost" size="icon" onClick={onCancel}>
            <X className="w-4 h-4" />
          </Button>
        )}
      </div>

      <StageIndicator currentStage={state} progress={progress} />
    </div>
  );
};
</file>

<file path="src/components/pitch-deck-management/delete-confirmation-dialog.tsx">
import { AlertTriangle } from 'lucide-react';

import { Button } from '@/components/ui/button';
import {
  Dialog,
  DialogContent,
  DialogDescription,
  DialogFooter,
  DialogHeader,
  DialogTitle
} from '@/components/ui/dialog';

interface DeleteConfirmationDialogProps {
  open: boolean;
  onOpenChange: (open: boolean) => void;
  onConfirm: () => void;
  deckTitle: string;
  isDeleting: boolean;
}

export const DeleteConfirmationDialog = ({
  open,
  onOpenChange,
  onConfirm,
  deckTitle,
  isDeleting
}: DeleteConfirmationDialogProps) => {
  const handleConfirm = () => {
    onConfirm();
  };

  return (
    <Dialog open={open} onOpenChange={onOpenChange}>
      <DialogContent className="sm:max-w-[425px]">
        <DialogHeader>
          <div className="flex items-center gap-3">
            <div className="flex h-10 w-10 shrink-0 items-center justify-center rounded-full bg-destructive/10">
              <AlertTriangle className="h-5 w-5 text-destructive" />
            </div>
            <DialogTitle>Delete Pitch Deck</DialogTitle>
          </div>
        </DialogHeader>
        <DialogDescription className="pt-2">
          Are you sure you want to delete{' '}
          <span className="font-semibold text-foreground">&ldquo;{deckTitle}&rdquo;</span>? This
          action cannot be undone.
        </DialogDescription>
        <DialogFooter className="gap-2 sm:gap-0 pt-4">
          <Button variant="outline" onClick={() => onOpenChange(false)} disabled={isDeleting}>
            Cancel
          </Button>
          <Button variant="destructive" onClick={handleConfirm} disabled={isDeleting}>
            {isDeleting ? (
              <>
                <span className="animate-spin mr-2 h-4 w-4 border-2 border-current border-t-transparent rounded-full" />
                Deleting...
              </>
            ) : (
              'Delete'
            )}
          </Button>
        </DialogFooter>
      </DialogContent>
    </Dialog>
  );
};
</file>

<file path="src/components/pitch-deck-management/index.ts">
export { PitchDeckCard } from './pitch-deck-card';
export { DeleteConfirmationDialog } from './delete-confirmation-dialog';
export { PitchDeckFilter } from './pitch-deck-filter';
export { PitchDeckPagination } from './pitch-deck-pagination';
export { PitchDeckList } from './pitch-deck-list';

// Phase 06: Detail Page
export { PitchDeckDetailHeader } from './pitch-deck-detail-header';
export { PitchDeckInfo } from './pitch-deck-info';
export { PitchDeckActions } from './pitch-deck-actions';
</file>

<file path="src/components/pitch-deck-management/metadata-inputs.tsx">
'use client';

import { cn } from '@/utils';
import { X } from 'lucide-react';
import { KeyboardEvent, useCallback } from 'react';

// Constants
export const METADATA_LIMITS = {
  TITLE_MAX: 200,
  DESCRIPTION_MAX: 1000,
  TAGS_MAX: 10
} as const;

export type MetadataInputsProps = {
  title: string;
  description: string;
  tags: string[];
  onTitleChange: (title: string) => void;
  onDescriptionChange: (description: string) => void;
  onTagsChange: (tags: string[]) => void;
  disabled?: boolean;
  className?: string;
};

export const MetadataInputs = ({
  title,
  description,
  tags,
  onTitleChange,
  onDescriptionChange,
  onTagsChange,
  disabled = false,
  className
}: MetadataInputsProps) => {
  const handleTagInput = useCallback(
    (e: KeyboardEvent<HTMLInputElement>) => {
      if (e.key === 'Enter' || e.key === ',') {
        e.preventDefault();
        const input = e.currentTarget;
        const value = input.value.trim();

        if (value && !tags.includes(value) && tags.length < METADATA_LIMITS.TAGS_MAX) {
          onTagsChange([...tags, value]);
          input.value = '';
        }
      }

      if (e.key === 'Backspace' && !e.currentTarget.value && tags.length > 0) {
        onTagsChange(tags.slice(0, -1));
      }
    },
    [tags, onTagsChange]
  );

  const removeTag = useCallback(
    (tagToRemove: string) => {
      onTagsChange(tags.filter((tag) => tag !== tagToRemove));
    },
    [tags, onTagsChange]
  );

  const handlePaste = useCallback(
    (e: React.ClipboardEvent<HTMLInputElement>) => {
      e.preventDefault();
      const pastedText = e.clipboardData.getData('text').trim();
      const newTags = pastedText
        .split(/[,,\n]+/)
        .map((t) => t.trim())
        .filter((t) => t && !tags.includes(t));

      const availableSlots = METADATA_LIMITS.TAGS_MAX - tags.length;
      const tagsToAdd = newTags.slice(0, availableSlots);

      if (tagsToAdd.length > 0) {
        onTagsChange([...tags, ...tagsToAdd]);
      }
    },
    [tags, onTagsChange]
  );

  return (
    <div className={cn('space-y-5', className)}>
      {/* Title Input */}
      <div className="space-y-2">
        <label htmlFor="title" className="text-sm font-medium">
          Title <span className="text-destructive">*</span>
        </label>
        <input
          id="title"
          type="text"
          value={title}
          onChange={(e) => {
            const value = e.target.value;
            if (value.length <= METADATA_LIMITS.TITLE_MAX) {
              onTitleChange(value);
            }
          }}
          disabled={disabled}
          placeholder="Enter pitch deck title..."
          maxLength={METADATA_LIMITS.TITLE_MAX}
          className={cn(
            'w-full px-3 py-2 text-sm rounded-md border border-input',
            'bg-background ring-offset-background',
            'focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2',
            'disabled:cursor-not-allowed disabled:opacity-50',
            'placeholder:text-muted-foreground'
          )}
          required
        />
        <div className="flex justify-end">
          <span
            className={cn(
              'text-xs',
              title.length > METADATA_LIMITS.TITLE_MAX * 0.9
                ? 'text-destructive'
                : 'text-muted-foreground'
            )}
          >
            {title.length}/{METADATA_LIMITS.TITLE_MAX}
          </span>
        </div>
      </div>

      {/* Description Textarea */}
      <div className="space-y-2">
        <label htmlFor="description" className="text-sm font-medium">
          Description
        </label>
        <textarea
          id="description"
          value={description}
          onChange={(e) => {
            const value = e.target.value;
            if (value.length <= METADATA_LIMITS.DESCRIPTION_MAX) {
              onDescriptionChange(value);
            }
          }}
          disabled={disabled}
          placeholder="Add a brief description of your pitch deck..."
          rows={4}
          maxLength={METADATA_LIMITS.DESCRIPTION_MAX}
          className={cn(
            'w-full px-3 py-2 text-sm rounded-md border border-input',
            'bg-background ring-offset-background',
            'focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2',
            'disabled:cursor-not-allowed disabled:opacity-50',
            'placeholder:text-muted-foreground',
            'resize-y min-h-[100px] max-h-[200px]'
          )}
        />
        <div className="flex justify-end">
          <span
            className={cn(
              'text-xs',
              description.length > METADATA_LIMITS.DESCRIPTION_MAX * 0.9
                ? 'text-destructive'
                : 'text-muted-foreground'
            )}
          >
            {description.length}/{METADATA_LIMITS.DESCRIPTION_MAX}
          </span>
        </div>
      </div>

      {/* Tags Input */}
      <div className="space-y-2">
        <label htmlFor="tags" className="text-sm font-medium">
          Tags
        </label>
        <div
          className={cn(
            'w-full px-3 py-2 min-h-[42px] rounded-md border border-input',
            'bg-background flex flex-wrap gap-2 items-center',
            'focus-within:ring-2 focus-within:ring-ring focus-within:ring-offset-2',
            disabled && 'opacity-50 cursor-not-allowed'
          )}
        >
          {tags.map((tag) => (
            <span
              key={tag}
              className={cn(
                'inline-flex items-center gap-1 px-2 py-1 text-xs rounded-full',
                'bg-primary/10 text-primary',
                'group'
              )}
            >
              {tag}
              <button
                type="button"
                onClick={() => removeTag(tag)}
                disabled={disabled}
                className={cn(
                  'rounded-full p-0.5 hover:bg-primary/20',
                  'transition-colors',
                  disabled && 'cursor-not-allowed opacity-50'
                )}
                aria-label={`Remove ${tag} tag`}
              >
                <X className="w-3 h-3" />
              </button>
            </span>
          ))}
          {tags.length < METADATA_LIMITS.TAGS_MAX && (
            <input
              id="tags"
              type="text"
              disabled={disabled}
              placeholder={tags.length === 0 ? 'Add tags (press Enter or comma)' : ''}
              onKeyDown={handleTagInput}
              onPaste={handlePaste}
              className={cn(
                'flex-1 min-w-[120px] text-sm outline-none bg-transparent',
                'placeholder:text-muted-foreground',
                disabled && 'cursor-not-allowed'
              )}
            />
          )}
        </div>
        <div className="flex justify-between items-center">
          <span className="text-xs text-muted-foreground">Press Enter or comma to add tags</span>
          <span className="text-xs text-muted-foreground">
            {tags.length}/{METADATA_LIMITS.TAGS_MAX}
          </span>
        </div>
      </div>
    </div>
  );
};
</file>

<file path="src/components/pitch-deck-management/pitch-deck-actions.tsx">
'use client';

import { APP_URL } from '@/constants/routes';
import { cn } from '@/utils';
import { ArrowRight, Share2, Trash2 } from 'lucide-react';
import { useRouter } from 'next/navigation';
import { useState } from 'react';

import { Button } from '@/components/ui/button';

import { DeleteConfirmationDialog } from './delete-confirmation-dialog';

export type PitchDeckActionsProps = {
  uuid: string;
  status: string;
  title: string;
  isDeleting?: boolean;
  onDelete?: () => void;
  className?: string;
};

export const PitchDeckActions = ({
  uuid: _uuid,
  status,
  title,
  isDeleting = false,
  onDelete,
  className
}: PitchDeckActionsProps) => {
  const router = useRouter();
  const [isDeleteDialogOpen, setIsDeleteDialogOpen] = useState(false);

  const handleDeleteConfirm = () => {
    setIsDeleteDialogOpen(false);
    onDelete?.();
  };

  const canAnalyze = status === 'ready';

  return (
    <div className={cn('flex flex-wrap items-center gap-3', className)}>
      {/* Delete Button */}
      <Button
        type="button"
        variant="destructive"
        onClick={() => setIsDeleteDialogOpen(true)}
        disabled={isDeleting}
      >
        <Trash2 className="w-4 h-4" />
        Delete
      </Button>

      {/* Share Button (disabled placeholder) */}
      <Button type="button" variant="outline" disabled>
        <Share2 className="w-4 h-4" />
        Share
      </Button>

      {/* Analyze Button - links to analysis page if status is ready */}
      <Button
        type="button"
        variant="default"
        onClick={() => router.push(APP_URL.PITCH_DECK)}
        disabled={!canAnalyze}
      >
        Analyze Deck
        <ArrowRight className="w-4 h-4" />
      </Button>

      {/* Delete Confirmation Dialog */}
      <DeleteConfirmationDialog
        open={isDeleteDialogOpen}
        onOpenChange={setIsDeleteDialogOpen}
        onConfirm={handleDeleteConfirm}
        deckTitle={title}
        isDeleting={isDeleting}
      />
    </div>
  );
};
</file>

<file path="src/components/pitch-deck-management/pitch-deck-card.tsx">
import { PITCH_DECK_STATUS } from '@/constants/pitch-deck-status';
import type { PitchDeckListItem } from '@/types/response/pitch-deck';
import { cn } from '@/utils';
import { formatDistanceToNow } from 'date-fns';
import { Trash2 } from 'lucide-react';

import { Button } from '@/components/ui/button';

interface PitchDeckCardProps {
  deck: PitchDeckListItem;
  onDelete: (uuid: string) => void;
  onClick?: (uuid: string) => void;
}

const STATUS_COLORS = {
  uploading: PITCH_DECK_STATUS.uploading.color,
  processing: PITCH_DECK_STATUS.processing.color,
  ready: PITCH_DECK_STATUS.ready.color,
  error: PITCH_DECK_STATUS.error.color
};

export const PitchDeckCard = ({ deck, onDelete, onClick }: PitchDeckCardProps) => {
  const handleDeleteClick = (e: React.MouseEvent) => {
    e.stopPropagation();
    onDelete(deck.uuid);
  };

  const handleCardClick = () => {
    if (onClick) {
      onClick(deck.uuid);
    }
  };

  const statusColor = STATUS_COLORS[deck.status] || STATUS_COLORS.ready;
  const statusLabel = PITCH_DECK_STATUS[deck.status]?.label || deck.status;
  const createdDate = new Date(deck.createdAt);
  const timeAgo = isNaN(createdDate.getTime())
    ? 'Invalid date'
    : formatDistanceToNow(createdDate, { addSuffix: true });

  return (
    <div
      onClick={handleCardClick}
      className="group relative flex flex-col rounded-lg border bg-card p-4 shadow-sm transition-all hover:shadow-md cursor-pointer"
    >
      <div className="flex items-start justify-between gap-3 mb-3">
        <div className="flex-1 min-w-0">
          <h3 className="font-semibold text-base text-card-foreground truncate">{deck.title}</h3>
          {deck.description && (
            <p className="text-sm text-muted-foreground mt-1 line-clamp-2">{deck.description}</p>
          )}
        </div>
        <Button
          variant="ghost"
          size="icon"
          onClick={handleDeleteClick}
          className="h-8 w-8 text-muted-foreground hover:text-destructive shrink-0 opacity-0 group-hover:opacity-100 transition-opacity"
          aria-label="Delete pitch deck"
        >
          <Trash2 className="h-4 w-4" />
        </Button>
      </div>

      <div className="flex items-center justify-between text-xs text-muted-foreground mt-auto">
        <div className="flex items-center gap-3">
          <span
            className={cn(
              'inline-flex items-center rounded-full px-2 py-0.5 font-medium',
              statusColor
            )}
          >
            {statusLabel}
          </span>
          <span>
            {deck.chunkCount} {deck.chunkCount === 1 ? 'file' : 'files'}
          </span>
        </div>
        <span>{timeAgo}</span>
      </div>

      {deck.errorMessage && (
        <p className="text-xs text-destructive mt-2 truncate">{deck.errorMessage}</p>
      )}
    </div>
  );
};
</file>

<file path="src/components/pitch-deck-management/pitch-deck-detail-header.tsx">
'use client';

import type { PitchDeckStatus } from '@/constants/pitch-deck-status';
import { getStatusColor, getStatusLabel } from '@/constants/pitch-deck-status';
import { cn } from '@/utils';

export type PitchDeckDetailHeaderProps = {
  title: string;
  status: PitchDeckStatus;
  createdAt: string;
  updatedAt: string;
  className?: string;
};

const formatDate = (dateString: string): string => {
  const date = new Date(dateString);
  if (isNaN(date.getTime())) {
    return 'Invalid date';
  }

  return new Intl.DateTimeFormat('en-US', {
    year: 'numeric',
    month: 'short',
    day: 'numeric'
  }).format(date);
};

export const PitchDeckDetailHeader = ({
  title,
  status,
  createdAt,
  updatedAt,
  className
}: PitchDeckDetailHeaderProps) => {
  const statusColor = getStatusColor(status);
  const statusLabel = getStatusLabel(status);

  return (
    <div className={cn('space-y-3', className)}>
      <div className="flex items-start justify-between gap-4 flex-wrap">
        <h1 className="text-2xl font-bold tracking-tight">{title}</h1>
        <span className={cn('px-2.5 py-1 rounded-full text-xs font-medium shrink-0', statusColor)}>
          {statusLabel}
        </span>
      </div>

      <div className="flex flex-wrap gap-x-6 gap-y-2 text-sm text-muted-foreground">
        <span>Created {formatDate(createdAt)}</span>
        {updatedAt !== createdAt && <span>Updated {formatDate(updatedAt)}</span>}
      </div>
    </div>
  );
};
</file>

<file path="src/components/pitch-deck-management/pitch-deck-filter.tsx">
import { PITCH_DECK_STATUS } from '@/constants/pitch-deck-status';
import type { PitchDeckStatus } from '@/constants/pitch-deck-status';

import {
  Select,
  SelectContent,
  SelectItem,
  SelectTrigger,
  SelectValue
} from '@/components/ui/select';

interface PitchDeckFilterProps {
  selectedStatus: PitchDeckStatus | 'all';
  onStatusChange: (status: PitchDeckStatus | 'all') => void;
  totalCount: number;
}

const STATUS_OPTIONS = [
  { value: 'all', label: 'All' },
  { value: 'uploading', label: PITCH_DECK_STATUS.uploading.label },
  { value: 'processing', label: PITCH_DECK_STATUS.processing.label },
  { value: 'ready', label: PITCH_DECK_STATUS.ready.label },
  { value: 'error', label: PITCH_DECK_STATUS.error.label }
] as const;

export const PitchDeckFilter = ({
  selectedStatus,
  onStatusChange,
  totalCount
}: PitchDeckFilterProps) => {
  return (
    <div className="flex items-center justify-between flex-wrap gap-3">
      <Select
        value={selectedStatus}
        onValueChange={(value) => onStatusChange(value as PitchDeckStatus | 'all')}
      >
        <SelectTrigger className="w-[180px]">
          <SelectValue placeholder="Filter by status" />
        </SelectTrigger>
        <SelectContent>
          {STATUS_OPTIONS.map((option) => (
            <SelectItem key={option.value} value={option.value}>
              {option.label}
            </SelectItem>
          ))}
        </SelectContent>
      </Select>

      <p className="text-sm text-muted-foreground">
        Showing <span className="font-medium text-foreground">{totalCount}</span> pitch deck
        {totalCount !== 1 ? 's' : ''}
      </p>
    </div>
  );
};
</file>

<file path="src/components/pitch-deck-management/pitch-deck-info.tsx">
'use client';

import { FILE_TYPE_LABELS } from '@/constants/file-types';
import { formatFileSize } from '@/constants/file-types';
import type { PitchDeckStatus } from '@/constants/pitch-deck-status';
import { cn } from '@/utils';
import { FileText, Tag } from 'lucide-react';

type UploadedFile = {
  originalFileName: string;
  fileSize: number;
  mimeType: string;
};

export type PitchDeckInfoProps = {
  description?: string | null;
  tags?: string[] | null;
  files?: UploadedFile[];
  status: PitchDeckStatus;
  className?: string;
};

const InfoSection = ({
  title,
  icon: Icon,
  children
}: {
  title: string;
  icon: React.ElementType;
  children: React.ReactNode;
}) => (
  <div className="space-y-2">
    <div className="flex items-center gap-2 text-sm font-medium text-muted-foreground">
      <Icon className="w-4 h-4" />
      <span>{title}</span>
    </div>
    <div className="pl-6">{children}</div>
  </div>
);

const Chip = ({ children }: { children: React.ReactNode }) => (
  <span className="inline-flex items-center px-2.5 py-1 rounded-md text-xs font-medium bg-secondary text-secondary-foreground">
    {children}
  </span>
);

const FileItem = ({
  fileName,
  fileSize,
  mimeType
}: {
  fileName: string;
  fileSize: number;
  mimeType: string;
}) => {
  const typeLabel = FILE_TYPE_LABELS[mimeType] || mimeType.split('/')[1]?.toUpperCase() || 'FILE';

  return (
    <div className="flex items-center gap-3 p-3 rounded-lg border bg-card">
      <FileText className="w-5 h-5 text-muted-foreground shrink-0" />
      <div className="min-w-0 flex-1">
        <p className="text-sm font-medium truncate">{fileName}</p>
        <p className="text-xs text-muted-foreground">
          {formatFileSize(fileSize)} • {typeLabel}
        </p>
      </div>
    </div>
  );
};

export const PitchDeckInfo = ({
  description,
  tags,
  files,
  status: _status,
  className
}: PitchDeckInfoProps) => {
  const hasFiles = files && files.length > 0;

  return (
    <div className={cn('space-y-6', className)}>
      {/* Description Section */}
      {description && (
        <InfoSection title="Description" icon={FileText}>
          <p className="text-sm leading-relaxed">{description}</p>
        </InfoSection>
      )}

      {/* Tags Section */}
      {tags && tags.length > 0 && (
        <InfoSection title="Tags" icon={Tag}>
          <div className="flex flex-wrap gap-2">
            {tags.map((tag) => (
              <Chip key={tag}>{tag}</Chip>
            ))}
          </div>
        </InfoSection>
      )}

      {/* Files Section */}
      {hasFiles && (
        <InfoSection title="Files" icon={FileText}>
          <div className="space-y-2">
            {files.map((file, index) => (
              <FileItem
                key={index}
                fileName={file.originalFileName}
                fileSize={file.fileSize}
                mimeType={file.mimeType}
              />
            ))}
          </div>
        </InfoSection>
      )}

      {/* Empty state when no info available */}
      {!description && (!tags || tags.length === 0) && !hasFiles && (
        <div className="text-center py-8 text-muted-foreground text-sm">
          No additional information available for this pitch deck.
        </div>
      )}
    </div>
  );
};
</file>

<file path="src/components/pitch-deck-management/pitch-deck-list.tsx">
import type { PitchDeckListItem } from '@/types/response/pitch-deck';
import { FileText, Plus } from 'lucide-react';

import { Button } from '@/components/ui/button';

import { PitchDeckCard } from './pitch-deck-card';

interface PitchDeckListProps {
  decks: PitchDeckListItem[];
  isLoading: boolean;
  onDelete: (uuid: string) => void;
  onClick?: (uuid: string) => void;
  onCreateNew?: () => void;
}

const CardSkeleton = () => (
  <div className="flex flex-col rounded-lg border bg-card p-4 shadow-sm animate-pulse">
    <div className="flex items-start justify-between gap-3 mb-3">
      <div className="flex-1 min-w-0">
        <div className="h-5 bg-muted rounded w-3/4 mb-2" />
        <div className="h-4 bg-muted rounded w-1/2" />
      </div>
      <div className="h-8 w-8 bg-muted rounded" />
    </div>
    <div className="flex items-center justify-between mt-auto">
      <div className="flex items-center gap-3">
        <div className="h-5 bg-muted rounded-full w-16" />
        <div className="h-4 bg-muted rounded w-12" />
      </div>
      <div className="h-4 bg-muted rounded w-16" />
    </div>
  </div>
);

const EmptyState = ({ onCreateNew }: { onCreateNew?: () => void }) => (
  <div className="flex flex-col items-center justify-center py-16 px-4 text-center">
    <div className="flex h-16 w-16 items-center justify-center rounded-full bg-muted/50 mb-4">
      <FileText className="h-8 w-8 text-muted-foreground" />
    </div>
    <h3 className="text-lg font-semibold text-foreground mb-2">No pitch decks yet</h3>
    <p className="text-sm text-muted-foreground mb-6 max-w-md">
      Create your first pitch deck to get started with AI-powered analysis and insights.
    </p>
    {onCreateNew && (
      <Button onClick={onCreateNew} className="gap-2">
        <Plus className="h-4 w-4" />
        Create Your First Deck
      </Button>
    )}
  </div>
);

export const PitchDeckList = ({
  decks,
  isLoading,
  onDelete,
  onClick,
  onCreateNew
}: PitchDeckListProps) => {
  if (isLoading) {
    return (
      <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
        {Array.from({ length: 6 }).map((_, i) => (
          <CardSkeleton key={i} />
        ))}
      </div>
    );
  }

  if (decks.length === 0) {
    return <EmptyState onCreateNew={onCreateNew} />;
  }

  return (
    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
      {decks.map((deck) => (
        <PitchDeckCard key={deck.uuid} deck={deck} onDelete={onDelete} onClick={onClick} />
      ))}
    </div>
  );
};
</file>

<file path="src/components/pitch-deck-management/pitch-deck-pagination.tsx">
import { ChevronLeft, ChevronRight } from 'lucide-react';

import { Button } from '@/components/ui/button';

interface PitchDeckPaginationProps {
  total: number;
  limit: number;
  offset: number;
  onPageChange: (offset: number) => void;
}

export const PitchDeckPagination = ({
  total,
  limit,
  offset,
  onPageChange
}: PitchDeckPaginationProps) => {
  const currentPage = Math.floor(offset / limit) + 1;
  const totalPages = Math.ceil(total / limit);

  const hasPrevPage = offset > 0;
  const hasNextPage = offset + limit < total;

  const handlePrevious = () => {
    if (hasPrevPage) {
      onPageChange(Math.max(0, offset - limit));
    }
  };

  const handleNext = () => {
    if (hasNextPage) {
      onPageChange(offset + limit);
    }
  };

  if (total === 0) {
    return null;
  }

  return (
    <div className="flex items-center justify-center gap-2">
      <Button
        variant="outline"
        size="sm"
        onClick={handlePrevious}
        disabled={!hasPrevPage}
        className="gap-1"
      >
        <ChevronLeft className="h-4 w-4" />
        Previous
      </Button>

      <span className="text-sm text-muted-foreground min-w-[80px] text-center">
        Page <span className="font-medium text-foreground">{currentPage}</span> of{' '}
        <span className="font-medium text-foreground">{totalPages}</span>
      </span>

      <Button
        variant="outline"
        size="sm"
        onClick={handleNext}
        disabled={!hasNextPage}
        className="gap-1"
      >
        Next
        <ChevronRight className="h-4 w-4" />
      </Button>
    </div>
  );
};
</file>

<file path="src/components/pitch-deck-management/upload-form.tsx">
'use client';

import { uploadPitchDeck } from '@/services/api/pitch-deck.service';
import type { PitchDeckListItem } from '@/types/response/pitch-deck';
import { useRouter } from 'next/navigation';
import { useCallback, useState, useRef, useEffect } from 'react';

import { FileUploader } from '@/components/pitch-deck/file-uploader';
import { Button } from '@/components/ui/button';

import { MetadataInputs } from './metadata-inputs';
import {
  UploadProgressTracker,
  UploadSuccessActions,
  type UploadState
} from './upload-progress-tracker';

export type UploadFormProps = {
  onSuccess?: (uuid: string) => void;
  onCancel?: () => void;
  className?: string;
};

type FormState = {
  selectedFile: File | null;
  title: string;
  description: string;
  tags: string[];
  uploadProgress: number;
  uploadState: UploadState;
  uploadError: string | null;
  uploadedDeck: PitchDeckListItem | null;
};

const INITIAL_FORM_STATE: FormState = {
  selectedFile: null,
  title: '',
  description: '',
  tags: [],
  uploadProgress: 0,
  uploadState: 'uploading',
  uploadError: null,
  uploadedDeck: null
};

export const UploadForm = ({ onSuccess, onCancel, className }: UploadFormProps) => {
  const router = useRouter();

  const [formState, setFormState] = useState<FormState>(INITIAL_FORM_STATE);

  const {
    selectedFile,
    title,
    description,
    tags,
    uploadProgress,
    uploadState,
    uploadError,
    uploadedDeck
  } = formState;

  const isUploading = uploadState === 'uploading' || uploadState === 'processing';
  const isComplete = uploadState === 'success';
  const hasError = uploadState === 'error';

  const canSubmit = selectedFile !== null && title.trim().length > 0 && !isUploading;

  const handleFileSelect = useCallback((file: File) => {
    setFormState((prev) => ({
      ...prev,
      selectedFile: file,
      uploadError: null
    }));
  }, []);

  const handleTitleChange = useCallback((value: string) => {
    setFormState((prev) => ({ ...prev, title: value }));
  }, []);

  const handleDescriptionChange = useCallback((value: string) => {
    setFormState((prev) => ({ ...prev, description: value }));
  }, []);

  const handleTagsChange = useCallback((newTags: string[]) => {
    setFormState((prev) => ({ ...prev, tags: newTags }));
  }, []);

  const intervalRef = useRef<NodeJS.Timeout | null>(null);

  const simulateProgress = useCallback((onComplete: () => void) => {
    let progress = 0;
    intervalRef.current = setInterval(() => {
      progress += Math.random() * 15 + 5;
      if (progress >= 90) {
        if (intervalRef.current) clearInterval(intervalRef.current);
        setFormState((prev) => ({ ...prev, uploadProgress: 90, uploadState: 'processing' }));
        onComplete();
      } else {
        setFormState((prev) => ({
          ...prev,
          uploadProgress: Math.min(progress, 90)
        }));
      }
    }, 200);
  }, []);

  // Cleanup interval on unmount
  useEffect(() => {
    return () => {
      if (intervalRef.current) {
        clearInterval(intervalRef.current);
      }
    };
  }, []);

  const handleSubmit = useCallback(async () => {
    if (!selectedFile || !title.trim()) {
      return;
    }

    setFormState((prev) => ({
      ...prev,
      uploadState: 'uploading',
      uploadProgress: 0,
      uploadError: null
    }));

    try {
      simulateProgress(async () => {
        try {
          const response = await uploadPitchDeck(selectedFile);

          const mockDeck: PitchDeckListItem = {
            id: response.uploadId,
            uuid: response.uploadId,
            title: title.trim(),
            description: description.trim() || null,
            originalFileName: response.filename,
            mimeType: response.fileType,
            fileSize: response.fileSize,
            status: 'processing',
            chunkCount: 0,
            errorMessage: null,
            tags: tags.length > 0 ? tags : null,
            createdAt: response.uploadedAt,
            updatedAt: response.uploadedAt,
            lastAccessedAt: response.uploadedAt
          };

          setFormState((prev) => ({
            ...prev,
            uploadProgress: 100,
            uploadState: 'success',
            uploadedDeck: mockDeck
          }));

          onSuccess?.(mockDeck.uuid);
        } catch (error) {
          const errorMessage =
            error instanceof Error ? error.message : 'Upload failed. Please try again.';
          setFormState((prev) => ({
            ...prev,
            uploadState: 'error',
            uploadError: errorMessage
          }));
        }
      });
    } catch (error) {
      const errorMessage =
        error instanceof Error ? error.message : 'Upload failed. Please try again.';
      setFormState((prev) => ({
        ...prev,
        uploadState: 'error',
        uploadError: errorMessage
      }));
    }
  }, [selectedFile, title, description, tags, simulateProgress, onSuccess]);

  const handleReset = useCallback(() => {
    setFormState(INITIAL_FORM_STATE);
  }, []);

  const handleViewDeck = useCallback(() => {
    if (uploadedDeck) {
      router.push(`/dashboard/pitch-decks/${uploadedDeck.uuid}`);
    }
  }, [uploadedDeck, router]);

  const handleBackToList = useCallback(() => {
    router.push('/dashboard/pitch-decks');
  }, [router]);

  return (
    <div className={className}>
      {/* Upload Progress / Success / Error */}
      {isUploading || isComplete || hasError ? (
        <div className="space-y-6">
          <UploadProgressTracker
            filename={selectedFile?.name || 'Unknown file'}
            progress={uploadProgress}
            state={uploadState}
            error={uploadError ?? undefined}
          />

          {isComplete && uploadedDeck && (
            <UploadSuccessActions
              onViewDeck={handleViewDeck}
              onUploadAnother={handleReset}
              onBackToList={handleBackToList}
            />
          )}

          {hasError && (
            <div className="flex gap-3 justify-end">
              <Button
                type="button"
                variant="outline"
                onClick={handleBackToList}
                disabled={isUploading}
              >
                Back to List
              </Button>
              <Button type="button" onClick={handleReset} disabled={isUploading}>
                Try Again
              </Button>
            </div>
          )}
        </div>
      ) : (
        <>
          {/* File Uploader */}
          <div className="space-y-2 mb-6">
            <label className="text-sm font-medium">Pitch Deck File</label>
            <FileUploader onFileSelect={handleFileSelect} disabled={isUploading} />
          </div>

          {/* Metadata Inputs */}
          <MetadataInputs
            title={title}
            description={description}
            tags={tags}
            onTitleChange={handleTitleChange}
            onDescriptionChange={handleDescriptionChange}
            onTagsChange={handleTagsChange}
            disabled={isUploading}
            className="mb-6"
          />

          {/* Form Actions */}
          <div className="flex gap-3 justify-end pt-4 border-t">
            {onCancel && (
              <Button type="button" variant="outline" onClick={onCancel} disabled={isUploading}>
                Cancel
              </Button>
            )}
            <Button type="button" onClick={handleSubmit} disabled={!canSubmit || isUploading}>
              {isUploading ? 'Uploading...' : 'Upload Pitch Deck'}
            </Button>
          </div>
        </>
      )}
    </div>
  );
};
</file>

<file path="src/components/pitch-deck-management/upload-progress-tracker.tsx">
'use client';

import { cn } from '@/utils';
import { AlertCircle, CheckCircle2, Loader2 } from 'lucide-react';

export type UploadState = 'uploading' | 'processing' | 'success' | 'error';

export type UploadProgressTrackerProps = {
  filename: string;
  progress: number;
  state: UploadState;
  error?: string;
  className?: string;
};

const STATE_CONFIG = {
  uploading: {
    icon: Loader2,
    iconClass: 'animate-spin text-primary',
    bgClass: 'bg-primary/10',
    progressClass: 'bg-primary',
    getText: (progress: number) => `Uploading... ${progress}%`
  },
  processing: {
    icon: Loader2,
    iconClass: 'animate-spin text-primary',
    bgClass: 'bg-primary/10',
    progressClass: 'bg-primary',
    getText: () => 'Processing pitch deck...'
  },
  success: {
    icon: CheckCircle2,
    iconClass: 'text-green-600 dark:text-green-500',
    bgClass: 'bg-green-100 dark:bg-green-900/30',
    progressClass: 'bg-green-600 dark:bg-green-500',
    getText: () => 'Upload complete!'
  },
  error: {
    icon: AlertCircle,
    iconClass: 'text-destructive',
    bgClass: 'bg-destructive/10',
    progressClass: 'bg-destructive',
    getText: () => 'Upload failed'
  }
} as const;

export const UploadProgressTracker = ({
  filename,
  progress,
  state,
  error,
  className
}: UploadProgressTrackerProps) => {
  const config = STATE_CONFIG[state];
  const Icon = config.icon;

  return (
    <div className={cn('space-y-4', className)}>
      {/* File Info Card */}
      <div className={cn('flex items-center gap-3 p-4 rounded-lg border', config.bgClass)}>
        <Icon className={cn('w-5 h-5 shrink-0', config.iconClass)} />
        <div className="flex-1 min-w-0">
          <p className="text-sm font-medium truncate">{filename}</p>
          <p className="text-xs text-muted-foreground">{config.getText(progress)}</p>
        </div>
      </div>

      {/* Progress Bar */}
      {(state === 'uploading' || state === 'processing') && (
        <div className="space-y-2">
          <div className="h-2 w-full bg-muted rounded-full overflow-hidden">
            <div
              className={cn('h-full transition-all duration-300 ease-out', config.progressClass)}
              style={{ width: `${state === 'processing' ? 100 : progress}%` }}
            />
          </div>
          <div className="flex justify-between text-xs text-muted-foreground">
            <span>{state === 'uploading' ? `${progress}%` : 'Processing...'}</span>
          </div>
        </div>
      )}

      {/* Success State */}
      {state === 'success' && (
        <div className="h-2 w-full bg-muted rounded-full overflow-hidden">
          <div className={cn('h-full', config.progressClass)} style={{ width: '100%' }} />
        </div>
      )}

      {/* Error Message */}
      {state === 'error' && error && (
        <div className="p-3 rounded-lg bg-destructive/10 border border-destructive/20">
          <p className="text-sm text-destructive">{error}</p>
        </div>
      )}
    </div>
  );
};

// Helper component for success state with navigation options
export type UploadSuccessActionsProps = {
  onViewDeck: () => void;
  onUploadAnother: () => void;
  onBackToList: () => void;
  className?: string;
};

export const UploadSuccessActions = ({
  onViewDeck,
  onUploadAnother,
  onBackToList,
  className
}: UploadSuccessActionsProps) => {
  return (
    <div className={cn('space-y-4 pt-4 border-t', className)}>
      <div className="text-center">
        <CheckCircle2 className="w-12 h-12 mx-auto mb-3 text-green-600 dark:text-green-500" />
        <h3 className="text-lg font-semibold mb-1">Upload Complete!</h3>
        <p className="text-sm text-muted-foreground">
          Your pitch deck has been uploaded successfully.
        </p>
      </div>

      <div className="flex flex-col sm:flex-row gap-3 justify-center">
        <button
          onClick={onViewDeck}
          className={cn(
            'px-4 py-2 text-sm font-medium rounded-md',
            'bg-primary text-primary-foreground',
            'hover:bg-primary/90',
            'transition-colors'
          )}
        >
          View Deck
        </button>
        <button
          onClick={onUploadAnother}
          className={cn(
            'px-4 py-2 text-sm font-medium rounded-md',
            'bg-secondary text-secondary-foreground',
            'hover:bg-secondary/80',
            'transition-colors'
          )}
        >
          Upload Another
        </button>
        <button
          onClick={onBackToList}
          className={cn(
            'px-4 py-2 text-sm font-medium rounded-md',
            'border border-input bg-background',
            'hover:bg-accent hover:text-accent-foreground',
            'transition-colors'
          )}
        >
          Back to List
        </button>
      </div>
    </div>
  );
};
</file>

<file path="src/components/ui/animated/fade-in.tsx">
'use client';

import { DEFAULT_TRANSITION } from '@/constants/animation';
import { useReducedMotion } from '@/hooks/use-reduced-motion';
import { motion, HTMLMotionProps } from 'framer-motion';

type FadeInProps = HTMLMotionProps<'div'> & {
  delay?: number;
  duration?: number;
};

export const FadeIn = ({
  children,
  delay = 0,
  duration = DEFAULT_TRANSITION.duration,
  ...props
}: FadeInProps) => {
  const prefersReducedMotion = useReducedMotion();

  return (
    <motion.div
      initial={prefersReducedMotion ? {} : { opacity: 0 }}
      animate={{ opacity: 1 }}
      transition={{
        duration: prefersReducedMotion ? 0 : duration,
        delay: prefersReducedMotion ? 0 : delay
      }}
      {...props}
    >
      {children}
    </motion.div>
  );
};
</file>

<file path="src/components/ui/animated/index.ts">
export { FadeIn } from './fade-in';
export { SlideUp } from './slide-up';
export { ScaleIn } from './scale-in';
export { StaggerChildren } from './stagger-children';
</file>

<file path="src/components/ui/animated/scale-in.tsx">
'use client';

import { DEFAULT_TRANSITION } from '@/constants/animation';
import { useReducedMotion } from '@/hooks/use-reduced-motion';
import { motion, HTMLMotionProps } from 'framer-motion';

type ScaleInProps = HTMLMotionProps<'div'> & {
  delay?: number;
  initialScale?: number;
};

export const ScaleIn = ({ children, delay = 0, initialScale = 0.9, ...props }: ScaleInProps) => {
  const prefersReducedMotion = useReducedMotion();

  return (
    <motion.div
      initial={prefersReducedMotion ? {} : { opacity: 0, scale: initialScale }}
      animate={{ opacity: 1, scale: 1 }}
      transition={{
        duration: prefersReducedMotion ? 0 : DEFAULT_TRANSITION.duration,
        delay: prefersReducedMotion ? 0 : delay,
        ease: DEFAULT_TRANSITION.ease
      }}
      {...props}
    >
      {children}
    </motion.div>
  );
};
</file>

<file path="src/components/ui/animated/slide-up.tsx">
'use client';

import { DEFAULT_TRANSITION } from '@/constants/animation';
import { useReducedMotion } from '@/hooks/use-reduced-motion';
import { motion, HTMLMotionProps } from 'framer-motion';

type SlideUpProps = HTMLMotionProps<'div'> & {
  delay?: number;
  distance?: number;
};

export const SlideUp = ({ children, delay = 0, distance = 20, ...props }: SlideUpProps) => {
  const prefersReducedMotion = useReducedMotion();

  return (
    <motion.div
      initial={prefersReducedMotion ? {} : { opacity: 0, y: distance }}
      animate={{ opacity: 1, y: 0 }}
      transition={{
        duration: prefersReducedMotion ? 0 : DEFAULT_TRANSITION.duration,
        delay: prefersReducedMotion ? 0 : delay,
        ease: DEFAULT_TRANSITION.ease
      }}
      {...props}
    >
      {children}
    </motion.div>
  );
};
</file>

<file path="src/components/ui/animated/stagger-children.tsx">
'use client';

import { ANIMATION_STAGGER, DEFAULT_TRANSITION } from '@/constants/animation';
import { useReducedMotion } from '@/hooks/use-reduced-motion';
import { motion, HTMLMotionProps, Variants } from 'framer-motion';

type StaggerChildrenProps = HTMLMotionProps<'div'> & {
  staggerDelay?: number;
  childClassName?: string;
};

const itemVariants: Variants = {
  hidden: { opacity: 0, y: 10 },
  visible: {
    opacity: 1,
    y: 0,
    transition: DEFAULT_TRANSITION
  }
};

export const StaggerChildren = ({
  children,
  staggerDelay = ANIMATION_STAGGER.normal,
  childClassName,
  className,
  ...props
}: StaggerChildrenProps) => {
  const prefersReducedMotion = useReducedMotion();

  if (prefersReducedMotion) {
    return <div className={className}>{children as React.ReactNode}</div>;
  }

  const childrenAsArray = Array.isArray(children) ? children : [children];

  return (
    <motion.div
      variants={{
        hidden: {},
        visible: {
          transition: {
            staggerChildren: staggerDelay
          }
        }
      }}
      initial="hidden"
      animate="visible"
      className={className}
      {...props}
    >
      {childrenAsArray.map((child, i) => (
        <motion.div key={i} variants={itemVariants} className={childClassName}>
          {child as React.ReactNode}
        </motion.div>
      ))}
    </motion.div>
  );
};
</file>

<file path="src/components/ui/dialog.tsx">
'use client';

import { cn } from '@/utils';
import * as DialogPrimitive from '@radix-ui/react-dialog';
import { X } from 'lucide-react';
import * as React from 'react';

const Dialog = DialogPrimitive.Root;

const DialogTrigger = DialogPrimitive.Trigger;

const DialogPortal = DialogPrimitive.Portal;

const DialogClose = DialogPrimitive.Close;

const DialogOverlay = React.forwardRef<
  React.ElementRef<typeof DialogPrimitive.Overlay>,
  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>
>(({ className, ...props }, ref) => (
  <DialogPrimitive.Overlay
    ref={ref}
    className={cn(
      'fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0',
      className
    )}
    {...props}
  />
));
DialogOverlay.displayName = DialogPrimitive.Overlay.displayName;

const DialogContent = React.forwardRef<
  React.ElementRef<typeof DialogPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content>
>(({ className, children, ...props }, ref) => (
  <DialogPortal>
    <DialogOverlay />
    <DialogPrimitive.Content
      ref={ref}
      className={cn(
        'fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg',
        className
      )}
      {...props}
    >
      {children}
      <DialogPrimitive.Close className="absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground">
        <X className="h-4 w-4" />
        <span className="sr-only">Close</span>
      </DialogPrimitive.Close>
    </DialogPrimitive.Content>
  </DialogPortal>
));
DialogContent.displayName = DialogPrimitive.Content.displayName;

const DialogHeader = ({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) => (
  <div className={cn('flex flex-col space-y-1.5 text-center sm:text-left', className)} {...props} />
);
DialogHeader.displayName = 'DialogHeader';

const DialogFooter = ({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) => (
  <div
    className={cn('flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2', className)}
    {...props}
  />
);
DialogFooter.displayName = 'DialogFooter';

const DialogTitle = React.forwardRef<
  React.ElementRef<typeof DialogPrimitive.Title>,
  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>
>(({ className, ...props }, ref) => (
  <DialogPrimitive.Title
    ref={ref}
    className={cn('text-lg font-semibold leading-none tracking-tight', className)}
    {...props}
  />
));
DialogTitle.displayName = DialogPrimitive.Title.displayName;

const DialogDescription = React.forwardRef<
  React.ElementRef<typeof DialogPrimitive.Description>,
  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>
>(({ className, ...props }, ref) => (
  <DialogPrimitive.Description
    ref={ref}
    className={cn('text-sm text-muted-foreground', className)}
    {...props}
  />
));
DialogDescription.displayName = DialogPrimitive.Description.displayName;

export {
  Dialog,
  DialogPortal,
  DialogOverlay,
  DialogTrigger,
  DialogClose,
  DialogContent,
  DialogHeader,
  DialogFooter,
  DialogTitle,
  DialogDescription
};
</file>

<file path="src/components/ui/select.tsx">
'use client';

import { cn } from '@/utils';
import * as SelectPrimitive from '@radix-ui/react-select';
import { Check, ChevronDown, ChevronUp } from 'lucide-react';
import * as React from 'react';

const Select = SelectPrimitive.Root;

const SelectGroup = SelectPrimitive.Group;

const SelectValue = SelectPrimitive.Value;

const SelectTrigger = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.Trigger>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger>
>(({ className, children, ...props }, ref) => (
  <SelectPrimitive.Trigger
    ref={ref}
    className={cn(
      'flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1',
      className
    )}
    {...props}
  >
    {children}
    <SelectPrimitive.Icon asChild>
      <ChevronDown className="h-4 w-4 opacity-50" />
    </SelectPrimitive.Icon>
  </SelectPrimitive.Trigger>
));
SelectTrigger.displayName = SelectPrimitive.Trigger.displayName;

const SelectScrollUpButton = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.ScrollUpButton>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollUpButton>
>(({ className, ...props }, ref) => (
  <SelectPrimitive.ScrollUpButton
    ref={ref}
    className={cn('flex cursor-default items-center justify-center py-1', className)}
    {...props}
  >
    <ChevronUp className="h-4 w-4" />
  </SelectPrimitive.ScrollUpButton>
));
SelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName;

const SelectScrollDownButton = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.ScrollDownButton>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollDownButton>
>(({ className, ...props }, ref) => (
  <SelectPrimitive.ScrollDownButton
    ref={ref}
    className={cn('flex cursor-default items-center justify-center py-1', className)}
    {...props}
  >
    <ChevronDown className="h-4 w-4" />
  </SelectPrimitive.ScrollDownButton>
));
SelectScrollDownButton.displayName = SelectPrimitive.ScrollDownButton.displayName;

const SelectContent = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content>
>(({ className, children, position = 'popper', ...props }, ref) => (
  <SelectPrimitive.Portal>
    <SelectPrimitive.Content
      ref={ref}
      className={cn(
        'relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]',
        position === 'popper' &&
          'data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1',
        className
      )}
      position={position}
      {...props}
    >
      <SelectScrollUpButton />
      <SelectPrimitive.Viewport
        className={cn(
          'p-1',
          position === 'popper' &&
            'h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]'
        )}
      >
        {children}
      </SelectPrimitive.Viewport>
      <SelectScrollDownButton />
    </SelectPrimitive.Content>
  </SelectPrimitive.Portal>
));
SelectContent.displayName = SelectPrimitive.Content.displayName;

const SelectLabel = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.Label>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Label>
>(({ className, ...props }, ref) => (
  <SelectPrimitive.Label
    ref={ref}
    className={cn('px-2 py-1.5 text-sm font-semibold', className)}
    {...props}
  />
));
SelectLabel.displayName = SelectPrimitive.Label.displayName;

const SelectItem = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.Item>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item>
>(({ className, children, ...props }, ref) => (
  <SelectPrimitive.Item
    ref={ref}
    className={cn(
      'relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50',
      className
    )}
    {...props}
  >
    <span className="absolute right-2 flex h-3.5 w-3.5 items-center justify-center">
      <SelectPrimitive.ItemIndicator>
        <Check className="h-4 w-4" />
      </SelectPrimitive.ItemIndicator>
    </span>
    <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>
  </SelectPrimitive.Item>
));
SelectItem.displayName = SelectPrimitive.Item.displayName;

const SelectSeparator = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.Separator>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Separator>
>(({ className, ...props }, ref) => (
  <SelectPrimitive.Separator
    ref={ref}
    className={cn('-mx-1 my-1 h-px bg-muted', className)}
    {...props}
  />
));
SelectSeparator.displayName = SelectPrimitive.Separator.displayName;

export {
  Select,
  SelectGroup,
  SelectValue,
  SelectTrigger,
  SelectContent,
  SelectLabel,
  SelectItem,
  SelectSeparator,
  SelectScrollUpButton,
  SelectScrollDownButton
};
</file>

<file path="src/constants/animation.ts">
// Animation durations (ms)
export const ANIMATION_DURATION = {
  fast: 150,
  normal: 300,
  slow: 500,
  verySlow: 800
} as const;

// Easing functions (Framer Motion easing names)
export const ANIMATION_EASING = {
  easeOut: 'easeOut',
  easeInOut: 'easeInOut',
  circOut: 'circOut',
  circInOut: 'circInOut'
} as const;

// Stagger delays for list animations
export const ANIMATION_STAGGER = {
  fast: 0.05,
  normal: 0.1,
  slow: 0.15
} as const;

// Default transition config
export const DEFAULT_TRANSITION = {
  duration: ANIMATION_DURATION.normal / 1000,
  ease: ANIMATION_EASING.easeOut
} as const;

// Stage transition animation config
export const STAGE_TRANSITION = {
  duration: ANIMATION_DURATION.slow / 1000,
  ease: ANIMATION_EASING.circInOut
} as const;
</file>

<file path="src/constants/file-types.ts">
// File type validation constants for pitch deck uploads

export const ALLOWED_PITCH_DECK_TYPES = [
  'application/pdf',
  'application/vnd.ms-powerpoint',
  'application/vnd.openxmlformats-officedocument.presentationml.presentation',
  'application/vnd.ms-word',
  'application/vnd.openxmlformats-officedocument.wordprocessingml.document',
  'text/plain'
] as const;

export const MAX_PITCH_DECK_SIZE = 10 * 1024 * 1024;

export const FILE_TYPE_LABELS: Record<string, string> = {
  'application/pdf': 'PDF',
  'application/vnd.ms-powerpoint': 'PPT',
  'application/vnd.openxmlformats-officedocument.presentationml.presentation': 'PPTX',
  'application/vnd.ms-word': 'DOC',
  'application/vnd.openxmlformats-officedocument.wordprocessingml.document': 'DOCX',
  'text/plain': 'TXT'
};

export const ALLOWED_FILE_EXTENSIONS = ['.pdf', '.ppt', '.pptx', '.doc', '.docx', '.txt'] as const;

export const validatePitchDeckFile = (file: File): { valid: boolean; error?: string } => {
  if (!ALLOWED_PITCH_DECK_TYPES.includes(file.type as never)) {
    const ext = '.' + file.name.split('.').pop()?.toLowerCase();
    if (!ALLOWED_FILE_EXTENSIONS.includes(ext as never)) {
      return {
        valid: false,
        error: 'Invalid file type. Allowed: PDF, PPT, PPTX, DOC, DOCX, TXT'
      };
    }
  }

  if (file.size > MAX_PITCH_DECK_SIZE) {
    return {
      valid: false,
      error: `File too large. Max size: ${MAX_PITCH_DECK_SIZE / 1024 / 1024}MB`
    };
  }

  if (file.size === 0) {
    return {
      valid: false,
      error: 'File is empty'
    };
  }

  return { valid: true };
};

export const formatFileSize = (bytes: number): string => {
  if (bytes === 0) return '0 Bytes';
  const k = 1024;
  const sizes = ['Bytes', 'KB', 'MB', 'GB'];
  const i = Math.floor(Math.log(bytes) / Math.log(k));

  return Math.round((bytes / Math.pow(k, i)) * 100) / 100 + ' ' + sizes[i];
};

export const getFileTypeLabel = (file: File): string => {
  return FILE_TYPE_LABELS[file.type] || file.name.split('.').pop()?.toUpperCase() || 'FILE';
};
</file>

<file path="src/constants/indicators.ts">
import { ImpactLevel, SeverityLevel } from '@/types/response/pitch-deck';

export const IMPACT_CONFIG: Record<
  ImpactLevel,
  {
    label: string;
    color: string;
    bgColor: string;
    icon: string;
  }
> = {
  high: {
    label: 'High Impact',
    color: 'text-green-600 dark:text-green-400',
    bgColor: 'bg-green-100 dark:bg-green-900/30',
    icon: '🚀'
  },
  medium: {
    label: 'Medium Impact',
    color: 'text-blue-600 dark:text-blue-400',
    bgColor: 'bg-blue-100 dark:bg-blue-900/30',
    icon: '⚡'
  },
  low: {
    label: 'Low Impact',
    color: 'text-gray-600 dark:text-gray-400',
    bgColor: 'bg-gray-100 dark:bg-gray-900/30',
    icon: '•'
  }
};

export const SEVERITY_CONFIG: Record<
  SeverityLevel,
  {
    label: string;
    color: string;
    bgColor: string;
    priority: number;
  }
> = {
  high: {
    label: 'High Priority',
    color: 'text-red-600 dark:text-red-400',
    bgColor: 'bg-red-100 dark:bg-red-900/30',
    priority: 1
  },
  medium: {
    label: 'Medium Priority',
    color: 'text-amber-600 dark:text-amber-400',
    bgColor: 'bg-amber-100 dark:bg-amber-900/30',
    priority: 2
  },
  low: {
    label: 'Low Priority',
    color: 'text-gray-600 dark:text-gray-400',
    bgColor: 'bg-gray-100 dark:bg-gray-900/30',
    priority: 3
  }
};
</file>

<file path="src/constants/score-bands.ts">
export type ScoreBand = {
  min: number;
  max: number;
  label: string;
  color: string;
  bgColor: string;
  textColor: string;
  borderColor: string;
};

export const SCORE_BANDS: ScoreBand[] = [
  {
    min: 85,
    max: 100,
    label: 'Exceptional',
    color: 'emerald',
    bgColor: 'bg-emerald-500',
    textColor: 'text-emerald-600 dark:text-emerald-400',
    borderColor: 'border-emerald-200 dark:border-emerald-800'
  },
  {
    min: 70,
    max: 84,
    label: 'Strong',
    color: 'green',
    bgColor: 'bg-green-500',
    textColor: 'text-green-600 dark:text-green-400',
    borderColor: 'border-green-200 dark:border-green-800'
  },
  {
    min: 50,
    max: 69,
    label: 'Moderate',
    color: 'yellow',
    bgColor: 'bg-yellow-500',
    textColor: 'text-yellow-600 dark:text-yellow-400',
    borderColor: 'border-yellow-200 dark:border-yellow-800'
  },
  {
    min: 0,
    max: 49,
    label: 'Weak',
    color: 'red',
    bgColor: 'bg-red-500',
    textColor: 'text-red-600 dark:text-red-400',
    borderColor: 'border-red-200 dark:border-red-800'
  }
];

export const getScoreBand = (score: number): ScoreBand => {
  return SCORE_BANDS.find((band) => score >= band.min && score <= band.max) || SCORE_BANDS[3];
};

export const getScoreColor = (score: number): string => {
  const band = getScoreBand(score);

  return band.textColor;
};

export const getScoreGradient = (score: number): { from: string; to: string } => {
  const band = getScoreBand(score);
  const gradients = {
    emerald: { from: 'from-emerald-400', to: 'to-emerald-600' },
    green: { from: 'from-green-400', to: 'to-green-600' },
    yellow: { from: 'from-yellow-400', to: 'to-yellow-600' },
    red: { from: 'from-red-400', to: 'to-red-600' }
  };

  return gradients[band.color as keyof typeof gradients];
};
</file>

<file path="src/constants/vc-framework.ts">
import type { VCCategory } from '@/types/response/pitch-deck';
import { Users, TrendingUp, Lightbulb, Rocket, DollarSign, Target, BarChart3 } from 'lucide-react';

export type VCCategoryConfig = {
  label: string;
  description: string;
  icon: typeof Users;
  color: string;
  gradientFrom: string;
  gradientTo: string;
};

export const VC_CATEGORY_CONFIG: Record<VCCategory, VCCategoryConfig> = {
  teamAndFounders: {
    label: 'Team & Founders',
    description: 'Experience, expertise, and team composition',
    icon: Users,
    color: 'blue',
    gradientFrom: 'from-blue-500',
    gradientTo: 'to-blue-600'
  },
  marketSize: {
    label: 'Market Size',
    description: 'TAM, SAM, SOM and market opportunity',
    icon: TrendingUp,
    color: 'purple',
    gradientFrom: 'from-purple-500',
    gradientTo: 'to-purple-600'
  },
  productSolution: {
    label: 'Product/Solution',
    description: 'Value proposition and product-market fit',
    icon: Lightbulb,
    color: 'green',
    gradientFrom: 'from-green-500',
    gradientTo: 'to-green-600'
  },
  traction: {
    label: 'Traction',
    description: 'Growth metrics and customer adoption',
    icon: Rocket,
    color: 'orange',
    gradientFrom: 'from-orange-500',
    gradientTo: 'to-orange-600'
  },
  businessModel: {
    label: 'Business Model',
    description: 'Revenue streams and unit economics',
    icon: DollarSign,
    color: 'cyan',
    gradientFrom: 'from-cyan-500',
    gradientTo: 'to-cyan-600'
  },
  competition: {
    label: 'Competition',
    description: 'Competitive landscape and differentiation',
    icon: Target,
    color: 'pink',
    gradientFrom: 'from-pink-500',
    gradientTo: 'to-pink-600'
  },
  financials: {
    label: 'Financials',
    description: 'Projections and funding requirements',
    icon: BarChart3,
    color: 'amber',
    gradientFrom: 'from-amber-500',
    gradientTo: 'to-amber-600'
  }
};

export const VC_CATEGORY_WEIGHTS: Record<VCCategory, number> = {
  teamAndFounders: 0.25,
  marketSize: 0.2,
  productSolution: 0.15,
  traction: 0.15,
  businessModel: 0.15,
  competition: 0.1,
  financials: 0.05
};

export const VC_CATEGORIES: VCCategory[] = [
  'teamAndFounders',
  'marketSize',
  'productSolution',
  'traction',
  'businessModel',
  'competition',
  'financials'
] as const;
</file>

<file path="src/hooks/use-reduced-motion.ts">
'use client';

import { useEffect, useState } from 'react';

export const useReducedMotion = (): boolean => {
  const [prefersReducedMotion, setPrefersReducedMotion] = useState(false);

  useEffect(() => {
    const mediaQuery = window.matchMedia('(prefers-reduced-motion: reduce)');
    setPrefersReducedMotion(mediaQuery.matches);

    const handleChange = () => setPrefersReducedMotion(mediaQuery.matches);
    mediaQuery.addEventListener('change', handleChange);

    return () => mediaQuery.removeEventListener('change', handleChange);
  }, []);

  return prefersReducedMotion;
};
</file>

<file path="src/services/api/pitch-deck-management.service.ts">
// Pitch deck management API service
// CRUD operations for pitch deck management pages

import { httpClient } from '@/services/http/client';
import type {
  ListPitchDecksQuery,
  UploadPitchDeckWithMetadataRequest
} from '@/types/request/pitch-deck';
import type { ListPitchDecksResponse, PitchDeckDetailResponse } from '@/types/response/pitch-deck';
import { withRetry } from '@/utils/retry';

/**
 * Get paginated list of pitch decks with optional status filtering
 * @param query - Query parameters for filtering and pagination
 * @returns Array of pitch deck list items
 */
export const listPitchDecks = async (
  query: ListPitchDecksQuery
): Promise<ListPitchDecksResponse> => {
  const params = new URLSearchParams();

  if (query.status) {
    params.append('status', query.status);
  }
  if (query.limit !== undefined) {
    params.append('limit', query.limit.toString());
  }
  if (query.offset !== undefined) {
    params.append('offset', query.offset.toString());
  }

  return withRetry(async () => {
    const response = await httpClient.get<ListPitchDecksResponse>(
      `/pitchdeck${params.toString() ? `?${params.toString()}` : ''}`
    );

    return response.data;
  });
};

/**
 * Get detailed information for a single pitch deck by UUID
 * @param uuid - Unique identifier of the pitch deck
 * @returns Detailed pitch deck information
 */
export const getPitchDeckDetail = async (uuid: string): Promise<PitchDeckDetailResponse> => {
  return withRetry(async () => {
    const response = await httpClient.get<PitchDeckDetailResponse>(`/pitchdeck/${uuid}`);

    return response.data;
  });
};

/**
 * Upload a pitch deck file with associated metadata (title, description, tags)
 * @param request - Upload request containing file and metadata
 * @param onProgress - Optional callback for upload progress (0-100)
 * @returns Created pitch deck detail response
 */
export const uploadPitchDeckWithMetadata = async (
  request: UploadPitchDeckWithMetadataRequest,
  onProgress?: (progress: number) => void
): Promise<PitchDeckDetailResponse> => {
  const formData = new FormData();
  formData.append('file', request.deck);

  const metadata = {
    title: request.title,
    description: request.description || '',
    tags: request.tags || []
  };
  formData.append('metadata', JSON.stringify(metadata));

  return withRetry(async () => {
    const response = await httpClient.post<PitchDeckDetailResponse>('/pitchdeck/upload', formData, {
      headers: {
        'Content-Type': 'multipart/form-data'
      },
      onUploadProgress: onProgress
        ? (progressEvent) => {
            if (progressEvent.total) {
              const progress = Math.round((progressEvent.loaded * 100) / progressEvent.total);
              onProgress(progress);
            }
          }
        : undefined
    });

    return response.data;
  });
};

/**
 * Delete a pitch deck by UUID
 * @param uuid - Unique identifier of the pitch deck to delete
 */
export const deletePitchDeckByUuid = async (uuid: string): Promise<void> => {
  return withRetry(async () => {
    await httpClient.delete(`/pitchdeck/${uuid}`);
  });
};
</file>

<file path="src/services/api/pitch-deck.service.ts">
import type {
  UploadPitchDeckResponse,
  PitchDeckAnalysisResponse
} from '@/types/response/pitch-deck';
import { generateMockAnalysis } from '@/utils/mock-analysis';

export const uploadPitchDeck = async (file: File): Promise<UploadPitchDeckResponse> => {
  const formData = new FormData();
  formData.append('file', file);

  // TODO: Replace with actual API call when ready
  // const response = await httpClient.post<UploadPitchDeckResponse>(
  //   API_URL.UPLOAD_PITCH_DECK,
  //   formData,
  //   { headers: { 'Content-Type': 'multipart/form-data' } }
  // );
  // return response.data;

  await new Promise((resolve) => setTimeout(resolve, 1500));

  return {
    uploadId: `upload_${Date.now()}_${Math.random().toString(36).substring(2, 11)}`,
    filename: file.name,
    fileSize: file.size,
    fileType: file.type,
    uploadedAt: new Date().toISOString()
  };
};

export const analyzePitchDeck = async (
  uploadId: string,
  filename?: string
): Promise<PitchDeckAnalysisResponse> => {
  // TODO: Replace with actual API call when ready
  // const response = await httpClient.post<PitchDeckAnalysisResponse>(
  //   API_URL.ANALYZE_PITCH_DECK,
  //   { uploadId }
  // );
  // return response.data;

  await new Promise((resolve) => setTimeout(resolve, 3000));

  return generateMockAnalysis(uploadId, filename || 'pitch-deck.pdf');
};

export const deletePitchDeck = async (_uploadId: string): Promise<void> => {
  // TODO: Replace with actual API call when ready
  // await httpClient.delete(`/pitch-deck/${uploadId}`);

  await new Promise((resolve) => setTimeout(resolve, 500));
};
</file>

<file path="src/stores/pitch-deck-management.store.ts">
import type { ListPitchDecksQuery } from '@/types/request/pitch-deck';
import type { PitchDeckListItem, PitchDeckDetailResponse } from '@/types/response/pitch-deck';
import { create } from 'zustand';

/**
 * State for pitch deck collection management
 */
type ManagementState = {
  /** Collection of pitch decks (list view) */
  pitchDecks: PitchDeckListItem[];
  /** Current selected deck (detail view) */
  currentDeck: PitchDeckDetailResponse | null;
  /** Total number of decks */
  total: number;
  /** Items per page */
  limit: number;
  /** Current page offset */
  offset: number;
  /** Active filters */
  filters: {
    status?: 'uploading' | 'processing' | 'ready' | 'error';
  };
  /** Loading state */
  isLoading: boolean;
  /** Error message */
  error: string | null;
};

/**
 * Actions for pitch deck collection management
 */
type ManagementActions = {
  /** Fetch pitch decks with pagination/filter */
  fetchPitchDecks: (query?: ListPitchDecksQuery) => Promise<void>;
  /** Fetch single deck by UUID */
  fetchPitchDeckDetail: (uuid: string) => Promise<void>;
  /** Add deck to collection (optimistic) */
  addPitchDeck: (deck: PitchDeckListItem) => void;
  /** Update deck in collection (optimistic) */
  updatePitchDeck: (uuid: string, updates: Partial<PitchDeckListItem>) => void;
  /** Remove deck from collection (optimistic) */
  removePitchDeck: (uuid: string) => void;
  /** Set current deck */
  setCurrentDeck: (deck: PitchDeckDetailResponse | null) => void;
  /** Update filters */
  setFilters: (filters: Partial<ManagementState['filters']>) => void;
  /** Update pagination offset */
  setPagination: (offset: number) => void;
  /** Set error message */
  setError: (error: string | null) => void;
  /** Reset to initial state */
  reset: () => void;
};

/**
 * Initial state for pitch deck management
 */
const initialState: ManagementState = {
  pitchDecks: [],
  currentDeck: null,
  total: 0,
  limit: 10,
  offset: 0,
  filters: {},
  isLoading: false,
  error: null
};

/**
 * Zustand store for pitch deck collection management
 * No localStorage persistence - session-only state
 *
 * @example
 * ```ts
 * const {
 *   pitchDecks,
 *   total,
 *   isLoading,
 *   fetchPitchDecks,
 *   removePitchDeck
 * } = usePitchDeckManagementStore();
 *
 * useEffect(() => {
 *   fetchPitchDecks();
 * }, []);
 *
 * const handleDelete = async (uuid: string) => {
 *   removePitchDeck(uuid);
 *   try {
 *     await deletePitchDeck(uuid);
 *   } catch {
 *     fetchPitchDecks(); // Re-fetch on error
 *   }
 * };
 * ```
 */
export const usePitchDeckManagementStore = create<ManagementState & ManagementActions>(
  (set, get) => ({
    ...initialState,

    fetchPitchDecks: async (query) => {
      set({ isLoading: true, error: null });
      try {
        // Dynamic import to avoid circular dependency with Phase 02
        const { listPitchDecks } = await import('@/services/api');
        const decks = await listPitchDecks({
          status: query?.status || get().filters.status,
          limit: query?.limit || get().limit,
          offset: query?.offset || get().offset
        });

        set({
          pitchDecks: decks,
          total: decks.length,
          isLoading: false
        });
      } catch (err) {
        set({
          error: err instanceof Error ? err.message : 'Failed to fetch pitch decks',
          isLoading: false
        });
      }
    },

    fetchPitchDeckDetail: async (uuid) => {
      set({ isLoading: true, error: null });
      try {
        // Dynamic import to avoid circular dependency
        const { getPitchDeckDetail } = await import('@/services/api');
        const deck = await getPitchDeckDetail(uuid);
        set({ currentDeck: deck, isLoading: false });
      } catch (err) {
        set({
          error: err instanceof Error ? err.message : 'Failed to fetch pitch deck',
          isLoading: false
        });
      }
    },

    addPitchDeck: (deck) => {
      set((state) => ({
        pitchDecks: [deck, ...state.pitchDecks],
        total: state.total + 1
      }));
    },

    updatePitchDeck: (uuid, updates) => {
      set((state) => ({
        pitchDecks: state.pitchDecks.map((d) => (d.uuid === uuid ? { ...d, ...updates } : d))
      }));
    },

    removePitchDeck: (uuid) => {
      set((state) => ({
        pitchDecks: state.pitchDecks.filter((d) => d.uuid !== uuid),
        total: state.total - 1
      }));
    },

    setCurrentDeck: (deck) => set({ currentDeck: deck }),

    setFilters: (filters) => {
      set({ filters: { ...get().filters, ...filters } });
    },

    setPagination: (offset) => set({ offset }),

    setError: (error) => set({ error }),

    reset: () => set(initialState)
  })
);

/**
 * Selectors for common state patterns
 */
export const selectPitchDecks = (state: ManagementState) => ({
  pitchDecks: state.pitchDecks,
  total: state.total,
  isLoading: state.isLoading,
  error: state.error
});

export const selectCurrentDeck = (state: ManagementState) => state.currentDeck;

export const selectPagination = (state: ManagementState) => ({
  total: state.total,
  limit: state.limit,
  offset: state.offset
});

export const selectFilters = (state: ManagementState) => state.filters;
</file>

<file path="src/stores/pitch-deck.store.ts">
import type {
  UploadPitchDeckResponse,
  PitchDeckAnalysisResponse
} from '@/types/response/pitch-deck';
import { create } from 'zustand';
import { persist } from 'zustand/middleware';

export type AnalysisStage = 'idle' | 'uploading' | 'analyzing' | 'insights' | 'completed' | 'error';

type UploadState = AnalysisStage;

type State = {
  uploadState: UploadState;
  currentStage: AnalysisStage;
  currentUpload: UploadPitchDeckResponse | null;
  currentAnalysis: PitchDeckAnalysisResponse | null;
  error: string | null;
  history: PitchDeckAnalysisResponse[];
};

type Actions = {
  setUploadState: (state: UploadState) => void;
  setCurrentStage: (stage: AnalysisStage) => void;
  setCurrentUpload: (upload: UploadPitchDeckResponse | null) => void;
  setCurrentAnalysis: (analysis: PitchDeckAnalysisResponse | null) => void;
  setError: (error: string | null) => void;
  addToHistory: (analysis: PitchDeckAnalysisResponse) => void;
  clearHistory: () => void;
  removeFromHistory: (uploadId: string) => void;
  reset: () => void;
};

const defaultState: State = {
  uploadState: 'idle',
  currentStage: 'idle',
  currentUpload: null,
  currentAnalysis: null,
  error: null,
  history: []
};

export const usePitchDeckStore = create<State & Actions>()(
  persist(
    (set, get) => ({
      ...defaultState,

      setUploadState: (uploadState) => set({ uploadState }),

      setCurrentStage: (currentStage) => set({ currentStage }),

      setCurrentUpload: (currentUpload) => set({ currentUpload }),

      setCurrentAnalysis: (currentAnalysis) => {
        set({ currentAnalysis, uploadState: 'completed', currentStage: 'completed' });
        if (currentAnalysis) {
          get().addToHistory(currentAnalysis);
        }
      },

      setError: (error) => set({ error, uploadState: 'error', currentStage: 'error' }),

      addToHistory: (analysis) => {
        const history = get().history;
        const filtered = history.filter((a) => a.uploadId !== analysis.uploadId);
        set({ history: [analysis, ...filtered].slice(0, 10) });
      },

      clearHistory: () => set({ history: [] }),

      removeFromHistory: (uploadId) => {
        const history = get().history.filter((a) => a.uploadId !== uploadId);
        set({ history });
      },

      reset: () => set(defaultState)
    }),
    {
      name: 'pitch-deck-storage',
      partialize: (state) => ({
        history: state.history
      })
    }
  )
);

export const selectUploadState = (state: State) => ({
  uploadState: state.uploadState,
  currentStage: state.currentStage,
  currentUpload: state.currentUpload,
  error: state.error
});

export const selectAnalysis = (state: State) => state.currentAnalysis;
export const selectHistory = (state: State) => state.history;
export const selectCurrentStage = (state: State) => state.currentStage;
</file>

<file path="src/utils/mock-analysis.ts">
import { VC_CATEGORIES } from '@/constants/vc-framework';
import type {
  PitchDeckAnalysisResponse,
  VCCategory,
  VCCategoryScore,
  StrengthItem,
  ImprovementItem,
  CompetitiveAnalysis,
  EvidenceQuote
} from '@/types/response/pitch-deck';
import { calculateWeightedScore } from '@/utils/score-calculator';

const STRENGTH_TEMPLATES: Record<VCCategory, string[]> = {
  teamAndFounders: [
    'Founders have previous successful exits in this space',
    'Strong technical background with relevant domain expertise',
    'Advisory board includes industry veterans',
    'Well-rounded team with complementary skill sets',
    'Clear leadership structure with defined roles'
  ],
  marketSize: [
    'Addressing a multi-billion dollar market opportunity',
    'Clear TAM/SAM/SOM breakdown with supporting data',
    'Market growing at 20%+ CAGR with favorable trends',
    'Underserved segment with clear whitespace opportunity',
    'Regulatory tailwinds supporting market expansion'
  ],
  productSolution: [
    'Clear value proposition with demonstrated product-market fit',
    'Unique technology with defensible IP positioning',
    'Solves urgent pain point for target customers',
    'Scalable solution with network effects potential',
    'Strong user feedback and validation data'
  ],
  traction: [
    'Impressive revenue growth with strong unit economics',
    'Significant user base with high engagement metrics',
    'Strategic partnerships with major industry players',
    'Strong customer retention with low churn rates',
    'Clear path to profitability demonstrated'
  ],
  businessModel: [
    'Clear revenue streams with diversified monetization',
    'Strong unit economics with positive LTV/CAC ratio',
    'Scalable model with low marginal costs',
    'Recurring revenue providing predictable cash flow',
    'Clear path to improving margins at scale'
  ],
  competition: [
    'Clear differentiation from existing market solutions',
    'Defensible moat through technology or network effects',
    'First-mover advantage in emerging category',
    'Strong brand positioning with customer loyalty',
    'Unique distribution channel advantage'
  ],
  financials: [
    'Realistic projections with sound underlying assumptions',
    'Clear path to profitability within 24 months',
    'Appropriate use of proceeds with defined milestones',
    'Conservative estimates with upside scenarios',
    'Strong cash flow management strategy'
  ]
};

const IMPROVEMENT_TEMPLATES: Record<VCCategory, string[]> = {
  teamAndFounders: [
    'Add more detail on key hires and recruiting plans',
    'Include relevant advisors and their contributions',
    'Clarify founder equity split and vesting schedule',
    'Add more detail on team structure and org chart',
    'Include team photos to build investor connection'
  ],
  marketSize: [
    'Strengthen market sizing with primary research data',
    'Include sources for market size claims',
    'Add more detail on target customer segments',
    'Break down go-to-market approach for each segment',
    'Include competitive positioning map'
  ],
  productSolution: [
    'Add more customer testimonials or case studies',
    'Include product screenshots or demo video',
    'Clarify technology differentiation with IP details',
    'Add roadmap with development timeline',
    'Include user metrics showing engagement'
  ],
  traction: [
    'Add growth charts showing key metrics over time',
    'Include customer logos and testimonials',
    'Add cohort analysis showing retention',
    'Include revenue run rate and growth trajectory',
    'Add more detail on customer acquisition channels'
  ],
  businessModel: [
    'Clarify unit economics with CAC/LTV breakdown',
    'Add more detail on revenue streams and pricing',
    'Include customer lifetime value calculation',
    'Add contribution margin analysis',
    'Include churn analysis and improvement strategies'
  ],
  competition: [
    'Include competitive matrix with feature comparison',
    'Add positioning map showing market differentiation',
    'Clarify competitive moat and sustainability',
    'Include response to competitive threats',
    'Add market share analysis'
  ],
  financials: [
    'Add sensitivity analysis for key assumptions',
    'Include monthly cash flow for first 18 months',
    'Add more detail on burn rate and runway',
    'Include scenario analysis (base/bear/bull)',
    'Clarify funding needs and use of proceeds'
  ]
};

const randomScore = (): number => Math.floor(Math.random() * 40) + 60;

const randomItem = <T>(items: T[]): T => items[Math.floor(Math.random() * items.length)];

const randomItems = <T>(items: T[], count: number): T[] => {
  const shuffled = [...items].sort(() => Math.random() - 0.5);

  return shuffled.slice(0, count);
};

const generateId = (): string => `id-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;

const generateCategoryScores = (): VCCategoryScore => {
  return {
    teamAndFounders: { score: randomScore(), weight: 0.25 },
    marketSize: { score: randomScore(), weight: 0.2 },
    productSolution: { score: randomScore(), weight: 0.15 },
    traction: { score: randomScore(), weight: 0.15 },
    businessModel: { score: randomScore(), weight: 0.15 },
    competition: { score: randomScore(), weight: 0.1 },
    financials: { score: randomScore(), weight: 0.05 }
  };
};

const generateStrengths = (categories: VCCategory[]): StrengthItem[] => {
  const items: StrengthItem[] = [];
  const impactLevels: Array<'high' | 'medium' | 'low'> = ['high', 'medium', 'low'];

  categories.forEach((category) => {
    const count = Math.floor(Math.random() * 2) + 1;
    const templates = randomItems(STRENGTH_TEMPLATES[category], count);

    templates.forEach((template) => {
      const evidence: EvidenceQuote[] = [
        {
          text: `${template} (Slide ${Math.floor(Math.random() * 12) + 1})`,
          slide: Math.floor(Math.random() * 12) + 1,
          category
        }
      ];

      items.push({
        id: generateId(),
        title: template.split(' ').slice(0, 5).join(' ') + '...',
        description: template,
        evidence,
        impact: randomItem(impactLevels),
        category
      });
    });
  });

  return items.sort((a, b) => {
    const impactOrder = { high: 0, medium: 1, low: 2 };

    return impactOrder[a.impact] - impactOrder[b.impact];
  });
};

const generateImprovements = (categories: VCCategory[]): ImprovementItem[] => {
  const items: ImprovementItem[] = [];
  const severityLevels: Array<'high' | 'medium' | 'low'> = ['high', 'medium', 'low'];

  categories.forEach((category) => {
    const count = Math.floor(Math.random() * 2) + 1;
    const templates = randomItems(IMPROVEMENT_TEMPLATES[category], count);

    templates.forEach((template) => {
      items.push({
        id: generateId(),
        title: template.split(' ').slice(0, 5).join(' ') + '...',
        description: template,
        recommendation: `Consider ${template.toLowerCase()}`,
        severity: randomItem(severityLevels),
        priority: Math.floor(Math.random() * 10) + 1,
        category
      });
    });
  });

  return items.sort((a, b) => a.priority - b.priority);
};

const generateCompetitiveAnalysis = (): CompetitiveAnalysis => {
  return {
    positioning: [
      { id: generateId(), name: 'Your Startup', x: 75, y: 80, isUser: true },
      { id: generateId(), name: 'Competitor A', x: 60, y: 65, isUser: false },
      { id: generateId(), name: 'Competitor B', x: 80, y: 55, isUser: false },
      { id: generateId(), name: 'Competitor C', x: 50, y: 70, isUser: false },
      { id: generateId(), name: 'Competitor D', x: 70, y: 45, isUser: false }
    ],
    differentiators: [
      {
        id: generateId(),
        aspect: 'Technology',
        userScore: 85,
        competitorAvg: 65,
        description: 'Superior technology stack with unique IP'
      },
      {
        id: generateId(),
        aspect: 'Customer Experience',
        userScore: 78,
        competitorAvg: 70,
        description: 'Best-in-class user experience'
      },
      {
        id: generateId(),
        aspect: 'Pricing',
        userScore: 72,
        competitorAvg: 68,
        description: 'Competitive pricing with better value'
      },
      {
        id: generateId(),
        aspect: 'Speed to Market',
        userScore: 80,
        competitorAvg: 60,
        description: 'Faster deployment and onboarding'
      }
    ],
    marketOpportunity: {
      size: '$4.2B TAM / $850M SAM / $120M SOM',
      growth: '22% CAGR',
      trend: 'rising'
    }
  };
};

export const generateMockAnalysis = (
  uploadId: string,
  filename: string
): PitchDeckAnalysisResponse => {
  const categoryScores = generateCategoryScores();
  const overallScore = calculateWeightedScore(categoryScores);
  const categories = VC_CATEGORIES as VCCategory[];

  return {
    uploadId,
    filename,
    overallScore,
    categoryScores,
    strengths: generateStrengths(categories),
    improvements: generateImprovements(categories),
    competitiveAnalysis: generateCompetitiveAnalysis(),
    analyzedAt: new Date().toISOString()
  };
};

// Letter grade conversion (A-F scale)
export const getScoreGrade = (score: number): string => {
  if (score >= 90) return 'A';
  if (score >= 80) return 'B';
  if (score >= 70) return 'C';
  if (score >= 60) return 'D';

  return 'F';
};
</file>

<file path="src/utils/score-calculator.ts">
import { VC_CATEGORY_WEIGHTS } from '@/constants/vc-framework';
import type { VCCategory, VCCategoryScore } from '@/types/response/pitch-deck';

export const calculateWeightedScore = (categoryScores: VCCategoryScore): number => {
  let totalWeightedScore = 0;

  Object.entries(VC_CATEGORY_WEIGHTS).forEach(([category, weight]) => {
    const score = categoryScores[category as VCCategory]?.score || 0;
    totalWeightedScore += score * weight;
  });

  return Math.round(totalWeightedScore);
};

export const normalizeScore = (value: number, _min = 0, _max = 100): number => {
  return Math.max(0, Math.min(100, value));
};

export const calculatePercentage = (score: number): number => {
  return normalizeScore(score);
};
</file>

<file path="researcher-260203-pitch-deck-scoring.md">
# Research Report: VC Pitch Deck Evaluation Scoring Frameworks

## Executive Summary

Based on analysis of Sequoia, YC, and Andreessen Horowitz frameworks, VCs use structured scoring rubrics to evaluate pitch decks across 10-12 key criteria. The most common 0-100 scales focus on team (15-25%), market size (15-20%), product solution (15-20%), traction (10-15%), and business model (10-15%).

## Key Evaluation Criteria & Weightings

### 1. **Team & Founders (20-25%)**

- **Founder experience**: Relevant domain expertise, successful track record
- **Complementarity**: Skills coverage across technical, business, product
- **Execution capability**: Evidence of ability to deliver on milestones
- **Advisors/board**: Industry experts and strategic relationships

### 2. **Market Size & Opportunity (15-20%)**

- **TAM/SAM/SOM**: Clear definition and realistic market sizing
- **Growth trajectory**: Historical growth rates and future projections
- **Market timing**: Is this market entering growth phase?
- **Pain point severity**: How urgent/valuable is the problem?

### 3. **Product/Solution (15-20%)**

- **Innovation level**: Truly novel vs incremental improvement
- **Technology moat**: Patents, IP, technical barriers to entry
- **Product-market fit**: Evidence of strong user adoption
- **Scalability**: Can this solution grow efficiently?

### 4. **Traction & Progress (10-15%)**

- **Milestones achieved**: Product development, user acquisition
- **Revenue growth**: Monthly/quarterly revenue progression
- **Key metrics**: CAC, LTV, churn rate, retention
- **Partnerships**: Strategic relationships formed

### 5. **Business Model (10-15%)**

- **Revenue clarity**: How will you make money?
- **Unit economics**: Gross margins, LTV/CAC ratio
- **Scalability**: Can margins improve with scale?
- **Path to profitability**: Clear timeline and requirements

### 6. **Competitive Position (8-12%)**

- **Competitor landscape**: Number and quality of alternatives
- **Differentiation**: Unique advantages (technology, network, brand)
- **Sustainability**: How long can advantages be maintained?
- **Market position**: Early leader vs follower status

### 7. **Financial Projections (5-10%)**

- **Revenue assumptions**: Conservative vs aggressive growth
- **Unit economics**: Margins, break-even points
- **Cash flow**: Runway, burn rate efficiency
- **Exit potential**: Acquirers, IPO timeline

## VC Scoring Frameworks

### **Sequoia Capital (1-5 Scale)**

- **5 Exceptional**: Market leader with unfair advantage
- **4 Strong**: Clear path to leadership position
- **3 Good**: Viable but execution-dependent
- **2 Weak**: Significant challenges to overcome
- **1 Poor**: Unlikely to achieve goals

### **Y Combinator (0-100 Scale)**

- **Team Quality**: 20 points
- **Market Size**: 20 points
- **Product Solution**: 20 points
- **Traction**: 20 points
- **Business Model**: 20 points
- **50+ = Strong candidate, 30-50 = Borderline, <30 = Reject**

### **Andreessen Horowitz (65-point scale)**

- **45+ = Favorable score**
- Evaluates 13 key criteria:
  - Problem clarity
  - Solution innovation
  - Team expertise
  - Market understanding
  - Business model viability
  - Traction evidence
  - Competitive landscape
  - Financial projections
  - Investment terms
  - Strategic fit

## Strength/Weakness Identification Patterns

### **Red Flags (Immediate Reject)**

- No clear understanding of target customer
- Founders lack relevant domain expertise
- Unfavorable unit economics (CAC > LTV)
- No defensibility (easy to copy)
- Unrealistic financial projections

### **Strong Signals (Fast Track)**

- Founders with successful prior exits
- Traction showing product-market fit
- Unfair competitive advantage
- Large, rapidly growing market
- High-margin business model

## Competitive Analysis Methodologies

### **VC Framework Questions**

1. **Market Analysis**: Who wins and why?
2. **Defensibility**: What protects you from competition?
3. **Scalability**: Can this grow without proportional cost increases?
4. **Timing**: Is this the right market at the right time?

### **Key Metrics Investors Track**

- **Growth Rate**: >20% monthly user growth
- **Unit Economics**: LTV/CAC > 3x
- **Churn Rate**: <5% monthly for SaaS
- **Gross Margin**: >70% for software
- **Burn Rate**: <6-12 months runway

## Final Scoring Matrix (0-100)

| Criteria       | Min (0) | Max (100) | Weight   | Target Score |
| -------------- | ------- | --------- | -------- | ------------ |
| Team           | 0       | 25        | 20%      | 18+          |
| Market         | 0       | 20        | 20%      | 14+          |
| Product        | 0       | 20        | 15%      | 12+          |
| Traction       | 0       | 15        | 15%      | 10+          |
| Business Model | 0       | 15        | 15%      | 10+          |
| Competition    | 0       | 10        | 10%      | 7+           |
| Financials     | 0       | 15        | 5%       | 8+           |
| **Total**      | **0**   | **120**   | **100%** | **79+**      |

**Pass Threshold**: 70/85 (58%+)
**Strong Investment**: 85/100+ (70%+)

Sources:

- [PitchBob VC Scoring Framework](https://pitchbob.io/blog/how-vcs-score-and-evaluate-your-pitch-deck)
- [FundingBlueprint VC Rubric](https://fundingblueprint.io/vc-pitch-deck-scoring-rubric-120-second-audit)
- [Hatcher AI Assessment](https://hq.hatcher.com/blog/The_AI_Pitch_Deck_Assessment_Explained)
</file>

<file path=".github/workflows/dependency-review.yml">
# Dependency Review Action
#
# This Action will scan dependency manifest files that change as part of a Pull Request, surfacing known-vulnerable versions of the packages declared or updated in the PR. Once installed, if the workflow run is marked as required, PRs introducing known-vulnerable packages will be blocked from merging.
#
# Source repository: https://github.com/actions/dependency-review-action
# Public documentation: https://docs.github.com/en/code-security/supply-chain-security/understanding-your-software-supply-chain/about-dependency-review#dependency-review-enforcement
name: 'Dependency Review'
on: [pull_request]

permissions:
  contents: read

jobs:
  dependency-review:
    runs-on: ubuntu-latest
    steps:
      - name: 'Checkout Repository'
        uses: actions/checkout@v3
      - name: 'Dependency Review'
        uses: actions/dependency-review-action@v1
</file>

<file path=".github/workflows/main.yml">
name: Test application generation

on:
  push:
    branches:
      - main

  pull_request:
    types: [opened, synchronize, reopened]

jobs:
  prettier-check:
    name: Prettier check
    runs-on: ubuntu-latest
    env:
      SKIP_ENV_VALIDATION: ${{ secrets.SKIP_ENV_VALIDATION }}
    steps:
      - name: Checkout repository
        uses: actions/checkout@v3
      - name: Setup pnpm
        uses: pnpm/action-setup@v2
        with:
          version: 8.10.2
      - name: Setup node
        uses: actions/setup-node@v3
        with:
          node-version: 18
      - name: Install dependencies
        run: pnpm install
      - name: Run prettier check
        run: pnpm prettier:check

  eslint-check:
    name: Eslint check
    runs-on: ubuntu-latest
    env:
      SKIP_ENV_VALIDATION: ${{ secrets.SKIP_ENV_VALIDATION }}
    steps:
      - name: Checkout repository
        uses: actions/checkout@v3
      - name: Setup pnpm
        uses: pnpm/action-setup@v2
        with:
          version: 8.10.2
      - name: Setup node
        uses: actions/setup-node@v3
        with:
          node-version: 18
      - name: Install dependencies
        run: pnpm install
      - name: Run eslint check
        run: pnpm eslint:format

  jest-check:
    name: Tests - jest
    needs: [prettier-check, eslint-check]
    runs-on: ubuntu-latest
    env:
      SKIP_ENV_VALIDATION: ${{ secrets.SKIP_ENV_VALIDATION }}
    steps:
      - name: Checkout repository
        uses: actions/checkout@v3
      - name: Setup pnpm
        uses: pnpm/action-setup@v2
        with:
          version: 8.10.2
      - name: Setup node
        uses: actions/setup-node@v3
        with:
          node-version: 18
      - name: Install dependencies
        run: pnpm install
      - name: Run tests
        run: pnpm test:ci --passWithNoTests
        env:
          CI: true

  nextjs-build-check:
    name: Build nextjs application
    needs: [jest-check]
    runs-on: ubuntu-latest
    env:
      SKIP_ENV_VALIDATION: ${{ secrets.SKIP_ENV_VALIDATION }}
    steps:
      - name: Checkout repository
        uses: actions/checkout@v3
      - name: Setup pnpm
        uses: pnpm/action-setup@v2
        with:
          version: 8.10.2
      - name: Setup node
        uses: actions/setup-node@v3
        with:
          node-version: 18
      - name: Install dependencies
        run: pnpm install
      - name: Build nextjs
        run: pnpm build
        env:
          CI: true
</file>

<file path=".github/dependabot.yml">
version: 2
updates:
  - package-ecosystem: 'npm'
    directory: '/'
    open-pull-requests-limit: 10
    schedule:
      interval: daily
      time: '12:00'
</file>

<file path=".husky/commit-msg">
#!/bin/sh
if ! head -1 "$1" | grep -qE "^(feat|fix|chore|docs|test|style|refactor|perf|build|ci|revert)(\(.+?\))?: .{1,}$"; then
    echo "Aborting commit. Your commit message is invalid." >&2
    exit 1
fi
if ! head -1 "$1" | grep -qE "^.{1,88}$"; then
    echo "Aborting commit. Your commit message is too long." >&2
    exit 1
fi
</file>

<file path=".husky/pre-commit">
npx lint-staged
</file>

<file path=".husky/pre-push">
pnpm test:ci
</file>

<file path="public/images/.gitkeep">

</file>

<file path="public/svgs/.gitkeep">

</file>

<file path="public/vercel.svg">
<svg width="283" height="64" viewBox="0 0 283 64" fill="none" 
    xmlns="http://www.w3.org/2000/svg">
    <path d="M141.04 16c-11.04 0-19 7.2-19 18s8.96 18 20 18c6.67 0 12.55-2.64 16.19-7.09l-7.65-4.42c-2.02 2.21-5.09 3.5-8.54 3.5-4.79 0-8.86-2.5-10.37-6.5h28.02c.22-1.12.35-2.28.35-3.5 0-10.79-7.96-17.99-19-17.99zm-9.46 14.5c1.25-3.99 4.67-6.5 9.45-6.5 4.79 0 8.21 2.51 9.45 6.5h-18.9zM248.72 16c-11.04 0-19 7.2-19 18s8.96 18 20 18c6.67 0 12.55-2.64 16.19-7.09l-7.65-4.42c-2.02 2.21-5.09 3.5-8.54 3.5-4.79 0-8.86-2.5-10.37-6.5h28.02c.22-1.12.35-2.28.35-3.5 0-10.79-7.96-17.99-19-17.99zm-9.45 14.5c1.25-3.99 4.67-6.5 9.45-6.5 4.79 0 8.21 2.51 9.45 6.5h-18.9zM200.24 34c0 6 3.92 10 10 10 4.12 0 7.21-1.87 8.8-4.92l7.68 4.43c-3.18 5.3-9.14 8.49-16.48 8.49-11.05 0-19-7.2-19-18s7.96-18 19-18c7.34 0 13.29 3.19 16.48 8.49l-7.68 4.43c-1.59-3.05-4.68-4.92-8.8-4.92-6.07 0-10 4-10 10zm82.48-29v46h-9V5h9zM36.95 0L73.9 64H0L36.95 0zm92.38 5l-27.71 48L73.91 5H84.3l17.32 30 17.32-30h10.39zm58.91 12v9.69c-1-.29-2.06-.49-3.2-.49-5.81 0-10 4-10 10V51h-9V17h9v9.2c0-5.08 5.91-9.2 13.2-9.2z" fill="#000"/>
</svg>
</file>

<file path="src/app/layout.tsx">
import { Metadata } from 'next';

import '@/styles/globals.css';
import { Toaster } from '@/components/ui/sonner';

export const metadata: Metadata = {
  title: 'Create Next App',
  description: 'Generated by create next app'
};

export default function RootLayout({
  children
}: Readonly<{
  children: React.ReactNode;
}>) {
  return (
    <html lang="en">
      <body className={`antialiased`}>
        {children}
        <Toaster />
      </body>
    </html>
  );
}
</file>

<file path="src/app/page.tsx">
import { Button } from '@/components/ui/button';

export default function HomePage() {
  return (
    <div className="container mx-auto p-8">
      <h1 className="text-4xl font-bold mb-6">Next.js Template</h1>
      <p className="text-lg mb-6">
        This template demonstrates the new architecture with barrel exports and services layer.
      </p>

      <div className="space-y-4">
        <h2 className="text-2xl font-semibold">Components</h2>
        <div className="flex gap-4">
          <Button variant="default">Default Button</Button>
          <Button variant="secondary">Secondary Button</Button>
          <Button variant="outline">Outline Button</Button>
        </div>
      </div>
    </div>
  );
}
</file>

<file path="src/components/common/button.tsx">
export const Button = () => {
  return <div>button</div>;
};
</file>

<file path="src/components/layout/header.tsx">
export const HHeader = () => {
  return (
    <header>
      <h1>Header</h1>
    </header>
  );
};
</file>

<file path="src/components/ui/button.tsx">
import { cn } from '@/utils';
import { Slot } from '@radix-ui/react-slot';
import { cva, type VariantProps } from 'class-variance-authority';
import * as React from 'react';

const buttonVariants = cva(
  'inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0',
  {
    variants: {
      variant: {
        default: 'bg-primary text-primary-foreground shadow hover:bg-primary/90',
        destructive: 'bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90',
        outline:
          'border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground',
        secondary: 'bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80',
        ghost: 'hover:bg-accent hover:text-accent-foreground',
        link: 'text-primary underline-offset-4 hover:underline'
      },
      size: {
        default: 'h-9 px-4 py-2',
        sm: 'h-8 rounded-md px-3 text-xs',
        lg: 'h-10 rounded-md px-8',
        icon: 'h-9 w-9'
      }
    },
    defaultVariants: {
      variant: 'default',
      size: 'default'
    }
  }
);

export interface ButtonProps
  extends React.ButtonHTMLAttributes<HTMLButtonElement>,
    VariantProps<typeof buttonVariants> {
  asChild?: boolean;
}

const Button = React.forwardRef<HTMLButtonElement, ButtonProps>(
  ({ className, variant, size, asChild = false, ...props }, ref) => {
    const Comp = asChild ? Slot : 'button';

    return (
      <Comp className={cn(buttonVariants({ variant, size, className }))} ref={ref} {...props} />
    );
  }
);
Button.displayName = 'Button';

export { Button, buttonVariants };
</file>

<file path="src/components/ui/input.tsx">
import { cn } from '@/utils';
import * as React from 'react';

const Input = React.forwardRef<HTMLInputElement, React.ComponentProps<'input'>>(
  ({ className, type, ...props }, ref) => {
    return (
      <input
        type={type}
        className={cn(
          'flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm',
          className
        )}
        ref={ref}
        {...props}
      />
    );
  }
);
Input.displayName = 'Input';

export { Input };
</file>

<file path="src/components/ui/sonner.tsx">
'use client';

import { useTheme } from 'next-themes';
import { Toaster as Sonner } from 'sonner';

type ToasterProps = React.ComponentProps<typeof Sonner>;

const Toaster = ({ ...props }: ToasterProps) => {
  const { theme = 'system' } = useTheme();

  return (
    <Sonner
      theme={theme as ToasterProps['theme']}
      className="toaster group"
      toastOptions={{
        classNames: {
          toast:
            'group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg',
          description: 'group-[.toast]:text-muted-foreground',
          actionButton: 'group-[.toast]:bg-primary group-[.toast]:text-primary-foreground',
          cancelButton: 'group-[.toast]:bg-muted group-[.toast]:text-muted-foreground'
        }
      }}
      {...props}
    />
  );
};

export { Toaster };
</file>

<file path="src/config/env.ts">
import { createEnv } from '@t3-oss/env-nextjs';
import { z } from 'zod';

export const env = createEnv({
  client: {
    NEXT_PUBLIC_API_BASE: z.string().url()
  },
  runtimeEnv: {
    NEXT_PUBLIC_API_BASE: process.env.NEXT_PUBLIC_API_BASE
  }
});
</file>

<file path="src/config/fonts.ts">
import { Fira_Code as FontMono, Inter as FontSans } from 'next/font/google';

export const fontSans = FontSans({
  subsets: ['latin'],
  variable: '--font-sans'
});

export const fontMono = FontMono({
  subsets: ['latin'],
  variable: '--font-mono'
});
</file>

<file path="src/config/site.ts">
export type SiteConfig = typeof siteConfig;

export const siteConfig = {
  name: 'Next.js Template',
  description: 'Very simple Next.js template.',
  navItems: [
    {
      label: 'Home',
      href: '/'
    },
    {
      label: 'Posts',
      href: '/posts'
    }
  ]
};
</file>

<file path="src/constants/api.ts">
export const API_URL = {
  GET_ME: '/users/me',
  LOGIN: '/auth/login',
  LOGOUT: '/auth/logout',
  REFRESH_TOKEN: '/auth/refresh'
};
</file>

<file path="src/constants/defaults.ts">
export const DEFAULT_PAGE = 1;
export const DEFAULT_PAGE_SIZE = 10;
</file>

<file path="src/constants/image.ts">
export const IMAGE_PATHS = {
  LOGOS: {
    MAIN: '/images/logos/logo.png'
  }
} as const;

export const SVG_PATHS = {
  LOGOS: {
    MAIN: '/images/logos/logo.svg'
  }
} as const;
</file>

<file path="src/constants/pitch-deck-status.ts">
// Pitch deck status constants matching API spec
// Status values: uploading | processing | ready | error

export type PitchDeckStatus = 'uploading' | 'processing' | 'ready' | 'error';

export const PITCH_DECK_STATUS: Record<PitchDeckStatus, { label: string; color: string }> = {
  uploading: {
    label: 'Uploading',
    color: 'bg-blue-100 text-blue-700 dark:bg-blue-900 dark:text-blue-300'
  },
  processing: {
    label: 'Processing',
    color: 'bg-yellow-100 text-yellow-700 dark:bg-yellow-900 dark:text-yellow-300'
  },
  ready: {
    label: 'Ready',
    color: 'bg-green-100 text-green-700 dark:bg-green-900 dark:text-green-300'
  },
  error: {
    label: 'Error',
    color: 'bg-red-100 text-red-700 dark:bg-red-900 dark:text-red-300'
  }
};

export const getStatusLabel = (status: PitchDeckStatus): string => PITCH_DECK_STATUS[status].label;

export const getStatusColor = (status: PitchDeckStatus): string => PITCH_DECK_STATUS[status].color;
</file>

<file path="src/constants/routes.ts">
export const APP_URL = {
  HOME: '/',
  LOGIN: '/auth/login',
  DASHBOARD: '/dashboard',
  PITCH_DECK: '/dashboard/pitch-deck',
  PITCH_DECKS: '/dashboard/pitch-decks'
};
</file>

<file path="src/hooks/.gitkeep">

</file>

<file path="src/hooks/index.ts">
// Custom Hooks exports
// Add custom hooks exports here when available
</file>

<file path="src/lib/.gitkeep">

</file>

<file path="src/providers/auth-provider.tsx">
import { ReactNode } from 'react';

export const AuthProvider = ({ children }: { children: ReactNode }) => {
  return <div>{children}</div>;
};
</file>

<file path="src/providers/index.ts">
// Providers exports
export { ThemeProvider } from './theme-provider';
</file>

<file path="src/providers/theme-provider.tsx">
'use client';

import { ThemeProvider as NextThemesProvider, ThemeProviderProps } from 'next-themes';

export function ThemeProvider({ children, ...props }: ThemeProviderProps) {
  return <NextThemesProvider {...props}>{children}</NextThemesProvider>;
}
</file>

<file path="src/services/api/auth.service.ts">
import { API_URL } from '@/constants/api';
import { httpClient } from '@/services/http';
import type { LoginRequest, LoginResponse } from '@/types/request/auth';
import type { User } from '@/types/user';

/**
 * Get current user information
 */
export const getMe = async (): Promise<User> => {
  const response = await httpClient.get(`${API_URL.GET_ME}`);

  return response.data;
};

/**
 * Login user with username and password
 */
export const login = async (credentials: LoginRequest): Promise<LoginResponse> => {
  const response = await httpClient.post(`${API_URL.LOGIN || '/auth/login'}`, {
    ...credentials,
    type: 'local'
  });

  return response.data;
};

/**
 * Logout user
 */
export const logout = async (): Promise<void> => {
  const response = await httpClient.post(`${API_URL.LOGOUT || '/auth/logout'}`);

  return response.data;
};

/**
 * Refresh access token
 */
export const refreshToken = async (): Promise<{ token: string }> => {
  const response = await httpClient.post(`${API_URL.REFRESH_TOKEN || '/auth/refresh'}`);

  return response.data;
};
</file>

<file path="src/services/api/index.ts">
// API Services exports
export * from './auth.service';
export * from './pitch-deck.service';
export * from './pitch-deck-management.service';

export type {
  UploadPitchDeckResponse,
  PitchDeckAnalysisResponse,
  CategoryScores,
  ListPitchDecksResponse,
  PitchDeckDetailResponse,
  PitchDeckListItem
} from '@/types/response/pitch-deck';
</file>

<file path="src/services/http/client.ts">
import { env } from '@/config/env';
import { useUserStore } from '@/stores';
import Axios, { AxiosError, AxiosResponse, InternalAxiosRequestConfig } from 'axios';

const baseUrl = env.NEXT_PUBLIC_API_BASE || 'http://localhost:3001/api/v1/';

const axiosOptions = {
  baseURL: baseUrl,
  timeout: 60000 * 5, // 5 minutes
  headers: {
    'Content-Type': 'application/json'
  },
  maxContentLength: 1024 * 1024 * 1024, // 1GB limit
  maxBodyLength: 1024 * 1024 * 1024 // 1GB limit
};

const getCurrentAccessToken = async () => {
  const token = useUserStore.getState().jwt;
  if (!token) {
    return null;
  }

  return token;
};

export const httpClient = Axios.create(axiosOptions);

// Request interceptor to add token to request headers
httpClient.interceptors.request.use(
  async (config: InternalAxiosRequestConfig) => {
    const token = await getCurrentAccessToken();
    if (token) {
      config.headers.Authorization = `Bearer ${token}`;
    }

    return config;
  },
  (error: AxiosError) => {
    return Promise.reject(error);
  }
);

// Response interceptor for global error handling
httpClient.interceptors.response.use(
  (response: AxiosResponse) => {
    return response;
  },
  async (error: AxiosError) => {
    if (error.response?.status === 401) {
      // Handle unauthorized access
      useUserStore.getState().clear();
    }

    return Promise.reject(error);
  }
);
</file>

<file path="src/services/http/index.ts">
// HTTP Client exports
export { httpClient } from './client';
</file>

<file path="src/services/index.ts">
// Services barrel exports
export * from './api';
export * from './http';
</file>

<file path="src/stores/index.ts">
// Zustand Stores exports
export { useUserStore } from './user.store';
export { usePitchDeckStore } from './pitch-deck.store';
export { usePitchDeckManagementStore } from './pitch-deck-management.store';
export type { AnalysisStage } from './pitch-deck.store';
export type { PitchDeckAnalysisResponse } from '@/types/response/pitch-deck';
</file>

<file path="src/stores/user.store.ts">
import { getMe } from '@/services/api';
import { User } from '@/types/user';
import { create } from 'zustand';
import { persist } from 'zustand/middleware';
// State và Actions
type State = {
  jwt: string | null;
  user: User | null;
};

type Actions = {
  clear: () => void;
  isAuthenticated: () => boolean;
  setUserInfo: (user: User) => void;
  setAuth: (user: User, jwt: string) => void;
  reload: () => void;
};

// Default value for state
const defaultStates: State = {
  jwt: null,
  user: null
};

// create store using zustands
export const useUserStore = create<State & Actions>()(
  persist(
    (set, getItem) => ({
      ...defaultStates,
      clear: () => {
        set(defaultStates);
      },
      setUserInfo: (user: User) => {
        set({ user });
      },
      setAuth: (user: User, jwt: string) => {
        set({ user, jwt });
      },
      isAuthenticated: () => {
        return !!getItem().jwt;
      },
      reload: async () => {
        const user = await getMe();
        set({ user });
      }
    }),
    { name: 'user-storage' }
  )
);
</file>

<file path="src/styles/globals.css">
@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    --background: 0 0% 100%;
    --foreground: 0 0% 3.9%;
    --card: 0 0% 100%;
    --card-foreground: 0 0% 3.9%;
    --popover: 0 0% 100%;
    --popover-foreground: 0 0% 3.9%;
    --primary: 0 0% 9%;
    --primary-foreground: 0 0% 98%;
    --secondary: 0 0% 96.1%;
    --secondary-foreground: 0 0% 9%;
    --muted: 0 0% 96.1%;
    --muted-foreground: 0 0% 45.1%;
    --accent: 0 0% 96.1%;
    --accent-foreground: 0 0% 9%;
    --destructive: 0 84.2% 60.2%;
    --destructive-foreground: 0 0% 98%;
    --border: 0 0% 89.8%;
    --input: 0 0% 89.8%;
    --ring: 0 0% 3.9%;
    --chart-1: 12 76% 61%;
    --chart-2: 173 58% 39%;
    --chart-3: 197 37% 24%;
    --chart-4: 43 74% 66%;
    --chart-5: 27 87% 67%;
    --radius: 0.5rem;
  }
  .dark {
    --background: 0 0% 3.9%;
    --foreground: 0 0% 98%;
    --card: 0 0% 3.9%;
    --card-foreground: 0 0% 98%;
    --popover: 0 0% 3.9%;
    --popover-foreground: 0 0% 98%;
    --primary: 0 0% 98%;
    --primary-foreground: 0 0% 9%;
    --secondary: 0 0% 14.9%;
    --secondary-foreground: 0 0% 98%;
    --muted: 0 0% 14.9%;
    --muted-foreground: 0 0% 63.9%;
    --accent: 0 0% 14.9%;
    --accent-foreground: 0 0% 98%;
    --destructive: 0 62.8% 30.6%;
    --destructive-foreground: 0 0% 98%;
    --border: 0 0% 14.9%;
    --input: 0 0% 14.9%;
    --ring: 0 0% 83.1%;
    --chart-1: 220 70% 50%;
    --chart-2: 160 60% 45%;
    --chart-3: 30 80% 55%;
    --chart-4: 280 65% 60%;
    --chart-5: 340 75% 55%;
  }
}

@layer base {
  * {
    @apply border-border;
  }
  body {
    @apply bg-background text-foreground;
  }
}
</file>

<file path="src/types/request/auth.ts">
import type { User } from '@/types/user';

export type LoginRequest = {
  username: string;
  password: string;
};

export type LoginResponse = {
  user: User;
  token: string;
};

export type RegisterRequest = {
  email: string;
  password: string;
  username: string;
};
</file>

<file path="src/types/request/index.ts">
// Request Types barrel export
export * from './auth';
export * from './pitch-deck';
</file>

<file path="src/types/request/pitch-deck.ts">
// Request types for pitch deck API endpoints

export type UploadPitchDeckRequest = {
  file: File;
};

export type AnalyzePitchDeckRequest = {
  uploadId: string;
};

// Pitch deck management request types
export type ListPitchDecksQuery = {
  status?: 'uploading' | 'processing' | 'ready' | 'error';
  limit?: number;
  offset?: number;
};

export type UploadPitchDeckWithMetadataRequest = {
  deck: File;
  title: string;
  description?: string;
  tags?: string[];
};
</file>

<file path="src/types/response/common.ts">
export type ApiResponse<T> = {
  data: T;
  error?: string;
  metadata?: MetaData;
};

export type MetaData = {
  total: number;
  page: number;
  pageSize: number;
};
</file>

<file path="src/types/response/index.ts">
// Response Types barrel export
export * from './common';
export * from './pitch-deck';
</file>

<file path="src/types/response/pitch-deck.ts">
// Response types for pitch deck API endpoints

import type { PitchDeckStatus } from '@/constants/pitch-deck-status';

export type UploadPitchDeckResponse = {
  uploadId: string;
  filename: string;
  fileSize: number;
  fileType: string;
  uploadedAt: string;
};

// Legacy 4-category structure (deprecated, kept for transition)
export type CategoryScores = {
  narrative: number;
  design: number;
  business: number;
  market: number;
};

// ==================== VC Framework Types ====================

export type VCCategory =
  | 'teamAndFounders'
  | 'marketSize'
  | 'productSolution'
  | 'traction'
  | 'businessModel'
  | 'competition'
  | 'financials';

export type VCCategoryScore = {
  [K in VCCategory]: {
    score: number;
    weight: number;
    details?: string;
  };
};

export type EvidenceQuote = {
  text: string;
  slide?: number;
  category: VCCategory;
};

export type ImpactLevel = 'high' | 'medium' | 'low';

export type StrengthItem = {
  id: string;
  title: string;
  description: string;
  evidence: EvidenceQuote[];
  impact: ImpactLevel;
  category: VCCategory;
};

export type SeverityLevel = 'high' | 'medium' | 'low';

export type ImprovementItem = {
  id: string;
  title: string;
  description: string;
  recommendation: string;
  severity: SeverityLevel;
  priority: number;
  category: VCCategory;
};

export type CompetitivePosition = {
  id: string;
  name: string;
  x: number;
  y: number;
  isUser: boolean;
};

export type Differentiator = {
  id: string;
  aspect: string;
  userScore: number;
  competitorAvg: number;
  description: string;
};

export type CompetitiveAnalysis = {
  positioning: CompetitivePosition[];
  differentiators: Differentiator[];
  marketOpportunity: {
    size: string;
    growth: string;
    trend: 'rising' | 'stable' | 'declining';
  };
};

// New VC framework response structure
export type PitchDeckAnalysisResponse = {
  uploadId: string;
  filename: string;
  overallScore: number;
  categoryScores: VCCategoryScore;
  strengths: StrengthItem[];
  improvements: ImprovementItem[];
  competitiveAnalysis?: CompetitiveAnalysis;
  analyzedAt: string;
};

// ==================== Pitch Deck Management Response Types ====================

export type PitchDeckListItem = {
  id: string;
  uuid: string;
  title: string;
  description: string | null;
  originalFileName: string;
  mimeType: string;
  fileSize: number;
  status: PitchDeckStatus;
  chunkCount: number;
  errorMessage: string | null;
  tags: string[] | null;
  createdAt: string;
  updatedAt: string;
  lastAccessedAt: string;
};

export type ListPitchDecksResponse = PitchDeckListItem[];

export type PitchDeckDetailResponse = PitchDeckListItem;
</file>

<file path="src/types/index.ts">
// User Types
export * from './user';

// Request Types
export * from './request/auth';

// Response Types
export * from './response/common';
</file>

<file path="src/types/user.ts">
export type User = {
  _id: string;
  username: string;
};
</file>

<file path="src/utils/cn/cn.ts">
import { clsx, type ClassValue } from 'clsx';
import { twMerge } from 'tailwind-merge';

/**
 * The function `cn` is a TypeScript function that merges multiple class lists into a single class
 * list.
 * @param {ClassValue[]} classLists - classLists is a rest parameter that allows you to pass in
 * multiple class lists as arguments. Each class list is represented by the ClassValue type.
 */
export const cn = (...classLists: ClassValue[]) => twMerge(clsx(classLists));
</file>

<file path="src/utils/cn/index.ts">
export * from './cn';
</file>

<file path="src/utils/retry.ts">
// Retry utility with exponential backoff and jitter
// Prevents retry storms and handles transient failures

export type RetryOptions = {
  maxRetries?: number;
  baseDelay?: number;
  maxDelay?: number;
};

const DEFAULT_RETRY_OPTIONS: Required<RetryOptions> = {
  maxRetries: 3,
  baseDelay: 1000,
  maxDelay: 30000
};

// Exponential backoff with jitter (random delay to prevent retry storms)
export const withRetry = async <T>(
  fn: () => Promise<T>,
  options: RetryOptions = {}
): Promise<T> => {
  const opts = { ...DEFAULT_RETRY_OPTIONS, ...options };

  for (let attempt = 0; attempt <= opts.maxRetries; attempt++) {
    try {
      return await fn();
    } catch (error) {
      if (attempt === opts.maxRetries) {
        throw error;
      }

      // Exponential backoff: baseDelay * 2^attempt + random jitter (0-1000ms)
      const exponentialDelay = opts.baseDelay * Math.pow(2, attempt);
      const jitter = Math.random() * 1000;
      const delay = Math.min(exponentialDelay + jitter, opts.maxDelay);

      await new Promise((resolve) => setTimeout(resolve, delay));
    }
  }

  throw new Error('Max retries exceeded');
};
</file>

<file path=".env.example">
NEXT_PUBLIC_API_BASE=
</file>

<file path=".gitignore">
# See https://help.github.com/articles/ignoring-files/ for more about ignoring files.

# dependencies
/node_modules
/.pnp
.pnp.js

# testing
/coverage

# next.js
/.next/
/out/

# production
/build

# misc
.DS_Store
*.pem

# debug
npm-debug.log*
yarn-debug.log*
yarn-error.log*
.pnpm-debug.log*

# local env files
.env*.local
.env

# vercel
.vercel

# typescript
*.tsbuildinfo

# storybook
storybook-static
.claude
CLAUDE.md
plans
</file>

<file path=".prettierignore">
node_modules
.next
yarn.lock
public 
coverage
.gitkeep
*.hbs
</file>

<file path=".prettierrc">
{
  "semi": true,
  "tabWidth": 2,
  "printWidth": 100,
  "singleQuote": true,
  "trailingComma": "none"
}
</file>

<file path="components.json">
{
  "$schema": "https://ui.shadcn.com/schema.json",
  "style": "new-york",
  "rsc": true,
  "tsx": true,
  "tailwind": {
    "config": "tailwind.config.js",
    "css": "src/styles/globals.css",
    "baseColor": "neutral",
    "cssVariables": true,
    "prefix": ""
  },
  "iconLibrary": "lucide",
  "aliases": {
    "components": "@/components/components",
    "utils": "@/lib/utils",
    "ui": "@/components/components/ui",
    "lib": "@/lib",
    "hooks": "@/hooks"
  }
}
</file>

<file path="eslint.config.mjs">
import react from 'eslint-plugin-react';
import typescriptEslint from '@typescript-eslint/eslint-plugin';
import importHelpers from 'eslint-plugin-import-helpers';
import testingLibrary from 'eslint-plugin-testing-library';
import globals from 'globals';
import tsParser from '@typescript-eslint/parser';
import path from 'node:path';
import { fileURLToPath } from 'node:url';
import js from '@eslint/js';
import { FlatCompat } from '@eslint/eslintrc';

const __filename = fileURLToPath(import.meta.url);
const __dirname = path.dirname(__filename);
const compat = new FlatCompat({
  baseDirectory: __dirname,
  recommendedConfig: js.configs.recommended,
  allConfig: js.configs.all
});

export default [
  {
    ignores: [
      '**/node_modules/*',
      '**/out/*',
      '**/.next/*',
      '**/coverage',
      'src/styles/globals.css'
    ]
  },
  ...compat.extends(
    'next/core-web-vitals',
    'eslint:recommended',
    'plugin:react/recommended',
    'plugin:@typescript-eslint/recommended',
    'plugin:prettier/recommended',
    'plugin:storybook/recommended',
    'prettier'
  ),
  {
    plugins: {
      react,
      '@typescript-eslint': typescriptEslint,
      'import-helpers': importHelpers,
      'testing-library': testingLibrary
    },

    languageOptions: {
      globals: {
        ...globals.browser,
        ...globals.jest,
        ...globals.node
      },

      parser: tsParser,
      ecmaVersion: 11,
      sourceType: 'module',

      parserOptions: {
        ecmaFeatures: {
          jsx: true
        }
      }
    },

    settings: {
      react: {
        version: 'detect'
      }
    },

    rules: {
      'newline-before-return': 2,
      'react/prop-types': 0,
      'react/react-in-jsx-scope': 0,
      'import-helpers/order-imports': [
        2,
        {
          newlinesBetween: 'always',

          groups: [
            ['/^next/', 'module'],
            '/^@/styles/',
            '/^@/components/',
            '/^@/lib/',
            ['parent', 'sibling', 'index']
          ],

          alphabetize: {
            order: 'asc',
            ignoreCase: true
          }
        }
      ],

      '@typescript-eslint/no-unused-vars': [
        2,
        {
          argsIgnorePattern: '^_'
        }
      ],

      'no-console': [
        2,
        {
          allow: ['warn', 'error']
        }
      ]
    }
  },
  ...compat.extends('plugin:testing-library/react').map((config) => ({
    ...config,
    files: ['**/__tests__/**/*.[jt]s?(x)', '**/?(*.)+(spec|test).[jt]s?(x)']
  }))
];
</file>

<file path="jest.config.js">
// You can learn more about each option below in the Jest docs: https://jestjs.io/docs/configuration.

module.exports = {
  roots: ['<rootDir>'],
  testEnvironment: 'jest-environment-jsdom',
  testRegex: '(/__tests__/.*|(\\.|/)(test))\\.[jt]sx?$',
  moduleFileExtensions: ['ts', 'tsx', 'js', 'json', 'jsx'],
  testPathIgnorePatterns: [
    '<rootDir>/.next/',
    '<rootDir>[/\\\\](node_modules|.next)[/\\\\]',
    '<rootDir>/.jest/test-utils.tsx',
    '<rootDir>/__mocks__/*'
  ],
  transformIgnorePatterns: [
    '/node_modules/',
    '^.+\\.module\\.(css|sass|scss)$',
    '/node_modules/(?!(zustand|@t3-oss/env-nextjs|@t3-oss/env-core)/)'
  ],

  transform: {
    // Use babel-jest to transpile tests with the next/babel preset
    // https://jestjs.io/docs/configuration#transform-objectstring-pathtotransformer--pathtotransformer-object
    '^.+\\.(js|jsx|ts|tsx)$': ['babel-jest', { presets: ['next/babel'] }]
  },
  watchPlugins: ['jest-watch-typeahead/filename'],
  collectCoverage: false,
  coverageThreshold: {
    global: {
      branches: 70,
      functions: 70,
      lines: 70,
      statements: 70
    }
  },
  coverageReporters: ['json', 'html'],
  collectCoverageFrom: [
    '<rootDir>/src/**/*.*',
    '!**/*.d.ts',
    '!**/node_modules/**',
    '!<rootDir>/src/components/**/*.stories.*',
    '!<rootDir>/src/pages/_app.tsx'
  ],
  setupFilesAfterEnv: ['<rootDir>/jest.setup.js'],
  moduleNameMapper: {
    // Handle CSS imports (with CSS modules)
    // https://jestjs.io/docs/webpack#mocking-css-modules
    '^.+\\.module\\.(css|sass|scss)$': 'identity-obj-proxy',

    // Handle CSS imports (without CSS modules)
    '^.+\\.(css|sass|scss)$': '<rootDir>/__mocks__/styleMock.js',

    // Handle image imports
    // https://jestjs.io/docs/webpack#handling-static-assets
    '^.+\\.(png|jpg|jpeg|gif|webp|avif|ico|bmp|svg)$': `<rootDir>/__mocks__/fileMock.js`,

    // Handle module aliases
    '^@/(.*)$': '<rootDir>/src/$1',
    '^@/components/(.*)$': '<rootDir>/src/components/$1',
    '^@/pages/(.*)$': '<rootDir>/src/pages/$1',
    '^@/lib(.*)$': '<rootDir>/src/lib$1',
    '^@/hooks(.*)$': '<rootDir>/src/hooks$1',
    '^@/mocks(.*)$': '<rootDir>/__mocks__$1',
    '^@/tests(.*)$': '<rootDir>/.jest$1'
  }
};
</file>

<file path="jest.setup.js">
// Optional: configure or set up a testing framework before each test.
// If you delete this file, remove `setupFilesAfterEnv` from `jest.config.js`

// Used for __tests__/testing-library.js
// Learn more: https://github.com/testing-library/jest-dom
import '@testing-library/jest-dom';
</file>

<file path="next-env.d.ts">
/// <reference types="next" />
/// <reference types="next/image-types/global" />
/// <reference path="./.next/types/routes.d.ts" />

// NOTE: This file should not be edited
// see https://nextjs.org/docs/app/api-reference/config/typescript for more information.
</file>

<file path="next.config.mjs">
/** @type {import('next').NextConfig} */
const nextConfig = {
  reactStrictMode: true
};

export default nextConfig;
</file>

<file path="package.json">
{
  "name": "nextjs-boilerplate",
  "version": "0.1.0",
  "description": "Next.js boilerplate with husky, lint-staged, eslint + prettier, jest, react-testing-library, storybook, ghaction and plop.",
  "private": true,
  "scripts": {
    "dev": "next dev --turbo",
    "build": "next build",
    "start": "next start",
    "prettier:format": "prettier --write .",
    "prettier:check": "prettier --check \"**/*.{ts,tsx,json}\"",
    "lint": "next lint",
    "eslint:format": "eslint src --fix",
    "test": "jest test",
    "test:coverage": "jest --coverage",
    "test:watch": "jest --watch",
    "test:ci": "jest --ci --passWithNoTests",
    "postinstall": "husky"
  },
  "engines": {
    "node": ">=18.20.2"
  },
  "packageManager": "pnpm@9.1.1+sha256.9551e803dcb7a1839fdf5416153a844060c7bce013218ce823410532504ac10b",
  "dependencies": {
    "@radix-ui/react-dialog": "^1.1.15",
    "@radix-ui/react-select": "^2.2.6",
    "@radix-ui/react-slot": "^1.2.3",
    "@t3-oss/env-nextjs": "0.12.0",
    "axios": "^1.11.0",
    "class-variance-authority": "^0.7.1",
    "clsx": "2.1.1",
    "date-fns": "^4.1.0",
    "framer-motion": "^12.30.0",
    "lucide-react": "^0.542.0",
    "next": "15.5.3",
    "next-themes": "^0.4.6",
    "react": "19.0.0-rc-65a56d0e-20241020",
    "react-dom": "19.0.0-rc-65a56d0e-20241020",
    "sonner": "^2.0.7",
    "tailwind-merge": "3.0.1",
    "tailwindcss-animate": "^1.0.7",
    "zod": "3.24.1",
    "zustand": "^5.0.8"
  },
  "devDependencies": {
    "@eslint/compat": "^1.2.5",
    "@eslint/eslintrc": "^3.2.0",
    "@eslint/js": "^9.19.0",
    "@testing-library/jest-dom": "6.6.3",
    "@testing-library/react": "16.0.1",
    "@testing-library/user-event": "14.6.1",
    "@types/jest": "29.5.14",
    "@types/node": "22.10.7",
    "@types/react": "npm:types-react@19.0.0-rc.1",
    "@types/react-dom": "npm:types-react-dom@19.0.0-rc.1",
    "@typescript-eslint/eslint-plugin": "8.22.0",
    "@typescript-eslint/parser": "8.24.0",
    "autoprefixer": "10.4.20",
    "babel-jest": "29.7.0",
    "eslint": "9.19.0",
    "eslint-config-next": "15.1.6",
    "eslint-config-prettier": "10.0.1",
    "eslint-plugin-import-helpers": "2.0.1",
    "eslint-plugin-prettier": "5.2.3",
    "eslint-plugin-react": "7.37.4",
    "eslint-plugin-react-hooks": "^5.1.0",
    "eslint-plugin-storybook": "0.11.2",
    "eslint-plugin-testing-library": "7.1.1",
    "globals": "^15.14.0",
    "husky": "9.1.7",
    "identity-obj-proxy": "3.0.0",
    "jest": "29.7.0",
    "jest-environment-jsdom": "29.7.0",
    "jest-watch-typeahead": "2.2.2",
    "lint-staged": "15.4.3",
    "pinst": "3.0.0",
    "postcss": "8.5.1",
    "prettier": "3.4.2",
    "prettier-plugin-tailwindcss": "0.6.11",
    "storybook": "^8.5.3",
    "tailwind-scrollbar": "3.1.0",
    "tailwindcss": "3.4.17",
    "typescript": "5.7.3"
  },
  "lint-staged": {
    "src/**/*": [
      "pnpm prettier:format",
      "pnpm eslint:format"
    ]
  },
  "pnpm": {
    "overrides": {
      "@types/react": "npm:types-react@19.0.0-rc.1",
      "@types/react-dom": "npm:types-react-dom@19.0.0-rc.1"
    }
  }
}
</file>

<file path="postcss.config.js">
module.exports = {
  plugins: {
    tailwindcss: {},
    autoprefixer: {}
  }
};
</file>

<file path="prettier.config.js">
// prettier.config.js
module.exports = {
  plugins: ['prettier-plugin-tailwindcss'],
  tailwindFunctions: ['clsx', 'cn', 'twMerge']
};
</file>

<file path="README.md">
# Next.js Boilerplate Template

A modern, production-ready Next.js boilerplate with comprehensive development tooling, authentication setup, and services architecture. Built with best practices for scalable enterprise applications.

## 🚀 Quick Start

### Prerequisites

- Node.js 18.20.2 or higher
- pnpm 9.1.1 or higher

### Installation

```bash
# Clone the repository
git clone <repository-url>
cd nextjs-boilerplate

# Install dependencies
pnpm install

# Copy environment variables
cp .env.example .env.local

# Run the development server
pnpm dev
```

Open [http://localhost:3000](http://localhost:3000) in your browser.

## 📚 Documentation

Comprehensive documentation is available in the `docs/` directory:

- [Project Overview & PDR](./docs/project-overview-pdr.md) - Product requirements and project details
- [Codebase Summary](./docs/codebase-summary.md) - Architecture and implementation overview
- [Code Standards](./docs/code-standards.md) - Coding standards and best practices
- [System Architecture](./docs/system-architecture.md) - Detailed architecture documentation

## 🛠️ Technology Stack

### Core Framework

- **Next.js 15.5** - React framework with App Router and Turbo mode
- **React 19 RC** - Latest React features
- **TypeScript 5.7** - Type safety and developer experience

### Styling & UI

- **Tailwind CSS 3.4** - Utility-first CSS framework
- **Shadcn/ui** - Pre-built accessible components
- **Lucide React** - Icon library
- **Next Themes** - Dark/light mode support

### State Management & HTTP

- **Zustand 5.0** - Lightweight state management with persistence
- **Axios 1.11** - HTTP client with request/response interceptors
- **Zod 3.24** - Schema validation

### Development Tools

- **ESLint 9.19** - Code linting with flat config
- **Prettier 3.4** - Code formatting
- **Husky & lint-staged** - Git hooks for quality enforcement
- **Jest & Testing Library** - Testing framework

## 📁 Project Structure

```
src/
├── app/                    # Next.js App Router
│   ├── layout.tsx          # Root layout with providers
│   └── page.tsx            # Home page
├── components/             # React components
│   ├── ui/                 # Shadcn/ui components
│   ├── layout/             # Layout components
│   └── common/             # Common components
├── config/                 # Configuration files
│   ├── env.ts              # Environment variables
│   ├── fonts.ts            # Font configuration
│   └── site.ts             # Site metadata
├── constants/              # Application constants
│   ├── api.ts              # API endpoints
│   ├── routes.ts           # Application routes
│   └── index.ts            # Constants index
├── providers/              # React Context providers
│   ├── auth-provider.tsx   # Authentication context
│   ├── theme-provider.tsx  # Theme context
│   └── index.ts            # Providers index
├── services/               # API and service layers
│   ├── http/               # HTTP client configuration
│   ├── api/                # API service layer
│   └── index.ts            # Services index
├── stores/                 # State management
│   ├── user.store.ts       # User authentication state
│   └── index.ts            # Stores index
├── types/                  # TypeScript type definitions
│   ├── request/            # Request types
│   ├── response/           # Response types
│   └── index.ts            # Type exports
├── utils/                  # Utility functions
│   ├── cn/                 # Class name utilities
│   └── index.ts            # Utility exports
└── styles/                 # Global styles
    └── globals.css         # Global CSS imports
```

## 🔧 Available Scripts

```bash
# Development
pnpm dev          # Start development server with Turbo mode
pnpm build        # Build for production
pnpm start        # Start production server

# Code Quality
pnpm lint         # Run ESLint
pnpm eslint:format  # Fix ESLint issues
pnpm prettier:format # Format code with Prettier
pnpm prettier:check  # Check formatting

# Testing
pnpm test         # Run tests
pnpm test:watch   # Run tests in watch mode
pnpm test:coverage # Run tests with coverage
pnpm test:ci      # Run tests in CI mode
```

## 🎯 Key Features

### Authentication System

- JWT-based authentication with state persistence
- Protected routes and guards
- Automatic token handling via interceptors
- User session management with Zustand

### State Management

- Zustand stores with persistence
- Centralized user authentication state
- Type-safe state management
- Derived state selectors

### API Integration

- Axios with custom configuration
- Request/response interceptors
- Automatic JWT injection
- Global error handling

### Development Experience

- ESLint + Prettier for consistent code style
- Husky pre-commit hooks
- lint-staged for staged file formatting
- TypeScript strict mode enabled
- Jest + Testing Library for testing

### Theming

- Dark/light mode support
- System preference detection
- Theme persistence
- Next Themes integration

## 🔐 Environment Variables

Create `.env.local` from `.env.example` and configure:

```env
NEXT_PUBLIC_API_BASE=http://localhost:3001/api/v1/
```

## 🚀 Deployment

### Vercel (Recommended)

1. Connect your repository to Vercel
2. Configure environment variables
3. Deploy automatically on push

### Other Platforms

The project is compatible with any platform that supports Next.js:

- Netlify
- AWS Amplify
- Digital Ocean App Platform
- Railway

## 🧪 Testing

```bash
# Run tests
pnpm test

# Run tests in watch mode
pnpm test:watch

# Run tests with coverage
pnpm test:coverage

# Run tests in CI mode
pnpm test:ci
```

## 📦 Dependencies

### Core Dependencies

- Next.js 15.5
- React 19 RC
- TypeScript 5.7
- Tailwind CSS 3.4
- Axios 1.11
- Zustand 5.0

### Development Dependencies

- ESLint 9.19
- Prettier 3.4
- Jest 29.7
- Testing Library 16.0
- Husky 9.1
- lint-staged 15.4

## 🤝 Contributing

1. Fork the repository
2. Create a feature branch
3. Make your changes
4. Run tests and linting
5. Submit a pull request

## 📄 License

This project is licensed under the MIT License.

## 🔗 Links

- [Next.js Documentation](https://nextjs.org/docs)
- [React Documentation](https://reactjs.org/docs)
- [TypeScript Documentation](https://www.typescriptlang.org/docs)
- [Tailwind CSS Documentation](https://tailwindcss.com/docs)
- [Zustand Documentation](https://docs.pmnd.rs/zustand/getting-started/introduction)

---

_Built with ❤️ by TBX/Capylabs_
</file>

<file path="tailwind.config.js">
/** @type {import('tailwindcss').Config} */
module.exports = {
  darkMode: ['class'],
  mode: 'jit',
  content: ['./src/app/**/*.{js,ts,jsx,tsx}', './src/components/**/*.{js,ts,jsx,tsx}'],
  theme: {
    extend: {
      fontFamily: {
        primary: ['var(--font-primary)']
      },
      borderRadius: {
        lg: 'var(--radius)',
        md: 'calc(var(--radius) - 2px)',
        sm: 'calc(var(--radius) - 4px)'
      },
      colors: {
        background: 'hsl(var(--background))',
        foreground: 'hsl(var(--foreground))',
        card: {
          DEFAULT: 'hsl(var(--card))',
          foreground: 'hsl(var(--card-foreground))'
        },
        popover: {
          DEFAULT: 'hsl(var(--popover))',
          foreground: 'hsl(var(--popover-foreground))'
        },
        primary: {
          DEFAULT: 'hsl(var(--primary))',
          foreground: 'hsl(var(--primary-foreground))'
        },
        secondary: {
          DEFAULT: 'hsl(var(--secondary))',
          foreground: 'hsl(var(--secondary-foreground))'
        },
        muted: {
          DEFAULT: 'hsl(var(--muted))',
          foreground: 'hsl(var(--muted-foreground))'
        },
        accent: {
          DEFAULT: 'hsl(var(--accent))',
          foreground: 'hsl(var(--accent-foreground))'
        },
        destructive: {
          DEFAULT: 'hsl(var(--destructive))',
          foreground: 'hsl(var(--destructive-foreground))'
        },
        border: 'hsl(var(--border))',
        input: 'hsl(var(--input))',
        ring: 'hsl(var(--ring))',
        chart: {
          1: 'hsl(var(--chart-1))',
          2: 'hsl(var(--chart-2))',
          3: 'hsl(var(--chart-3))',
          4: 'hsl(var(--chart-4))',
          5: 'hsl(var(--chart-5))'
        }
      }
    }
  },
  variants: {
    extend: {}
  },
  plugins: [require('tailwind-scrollbar'), require('tailwindcss-animate')]
};
</file>

<file path="tsconfig.json">
{
  "compilerOptions": {
    "target": "ES2017",
    "lib": ["dom", "dom.iterable", "esnext"],
    "allowJs": true,
    "skipLibCheck": true,
    "strict": true,
    "noEmit": true,
    "esModuleInterop": true,
    "module": "esnext",
    "moduleResolution": "bundler",
    "resolveJsonModule": true,
    "isolatedModules": true,
    "jsx": "preserve",
    "incremental": true,
    "plugins": [
      {
        "name": "next"
      }
    ],
    "paths": {
      "@/*": ["./src/*"]
    }
  },
  "include": ["next-env.d.ts", "**/*.ts", "**/*.tsx", ".next/types/**/*.ts"],
  "exclude": ["node_modules"]
}
</file>

<file path="src/constants/index.ts">
// API Constants
export * from './api';

// Route Constants
export * from './routes';

// Default Values
export * from './defaults';

export * from './image';

// VC Framework Constants
export * from './vc-framework';

// Score Bands Constants
export * from './score-bands';

// Pitch Deck Status Constants
export * from './pitch-deck-status';
</file>

<file path="src/utils/index.ts">
export * from './cn';
export * from './mock-analysis';
export * from './score-calculator';
export * from './retry';
</file>

</files>
